import{_ as Ka,i as Ya,o as d,c as f,a as t,w as l,p as L,E as k,aC as G,f as y,r as z,g as He,D as Ja,e as n,b as Pe,F as E,y as H,z as S,d as p,C as De,t as v,M as Wa,m as M,k as K,O as mt,J as ct,s as Ga,W as Xa,aD as Za,aE as el,aF as tl,n as al,x as ll,A as sl,G as Ce,a0 as ol,q as nl}from"./index-1rGkZLYp.js";import{R as pe}from"./RichEditor-DCYX-Nb-.js";import{k as Et}from"./katex.min-DPBfLjbn.js";import{u as rl,i as il,a as ul,b as dl,c as pl,d as ml,e as cl,f as _l,g as vl,h as Re}from"./install-D-TER6JM.js";import"./style-BS9iE4ZN.js";const fl={class:"computer-paper-manage"},gl={class:"filter-bar mb-20"},yl={class:"pagination-container mt-20"},hl={class:"dialog-header"},bl={key:0,class:"paper-detail"},wl={class:"mt-10 flex-end"},xl={class:"mt-20 flex-between"},Vl={class:"questions-list mt-10"},kl={class:"question-header"},Cl={class:"question-index"},Tl={class:"question-type"},Sl={class:"question-score"},zl=["innerHTML"],Ul={key:0,class:"question-options"},jl={class:"option-label"},$l=["innerHTML"],Ml={key:1,class:"question-subs"},Ll={class:"sub-header"},ql=["innerHTML"],Il={key:0,class:"sub-answer"},El=["innerHTML"],Hl={class:"question-answer"},Pl=["innerHTML"],Dl={key:2,class:"question-analysis"},Rl=["innerHTML"],Fl={style:{display:"flex",gap:"8px"}},Nl={class:"tags-list"},Ql={class:"editor-wrapper"},Al={class:"options-list"},Ol={class:"option-editor-wrapper"},Bl={class:"subs-list"},Kl={class:"sub-header"},Yl={class:"sub-index"},Jl={class:"sub-content"},Wl={class:"editor-wrapper"},Gl={class:"editor-wrapper"},Xl={class:"question-select-header"},Zl={class:"ml-10"},es={key:0,class:"selected-questions-preview"},ts=["innerHTML"],as={class:"total-score"},ls={class:"question-selector"},ss={class:"filter-bar mb-20"},os=["innerHTML"],ns={class:"pagination-container mt-20"},rs={class:"filter-bar mb-20"},is={class:"pagination-container mt-20"},us={key:0,class:"exam-basic-info mb-20"},ds={key:1,class:"exam-statistics"},ps={class:"stat-card primary"},ms={class:"stat-icon"},cs={class:"stat-content"},_s={class:"stat-value"},vs={class:"stat-card success"},fs={class:"stat-icon"},gs={class:"stat-content"},ys={class:"stat-value"},hs={class:"stat-card warning"},bs={class:"stat-icon"},ws={class:"stat-content"},xs={class:"stat-value"},Vs={class:"stat-card danger"},ks={class:"stat-icon"},Cs={class:"stat-content"},Ts={class:"stat-value"},Ss={class:"stat-card info"},zs={class:"stat-icon"},Us={class:"stat-content"},js={class:"stat-value"},$s={class:"stat-icon"},Ms={class:"stat-content"},Ls={class:"stat-value"},qs={class:"card-header"},Is={class:"card-header",style:{display:"flex","justify-content":"space-between","align-items":"center"}},Es={style:{display:"flex","align-items":"center",gap:"10px"}},Hs={key:0,style:{color:"#409eff"}},Ps={key:1,style:{color:"#67c23a"}},Ds={key:2,style:{color:"#e6a23c"}},Rs={key:3,style:{color:"#f56c6c"}},Fs={key:4},Ns=["innerHTML"],Qs={key:0},As={key:1},Os={key:0,style:{color:"#409eff"}},Bs={key:1,style:{color:"#67c23a"}},Ks={key:2,style:{color:"#e6a23c"}},Ys={key:3,style:{color:"#f56c6c"}},Js={key:4},Ws=["innerHTML"],Gs={key:0},Xs={key:1},Zs={class:"records-filter-bar mb-20"},eo={class:"pagination-container mt-20"},to={key:0},ao={class:"grading-header"},lo={class:"question-content mb-20"},so=["innerHTML"],oo={class:"user-answer mb-20"},no=["innerHTML"],ro={key:0,class:"correct-answer mb-20"},io=["innerHTML"],uo={class:"grading-form"},po={key:0,class:"question-detail-analysis"},mo={class:"exam-info-section",style:{"margin-bottom":"12px"}},co={key:0,style:{color:"#409eff"}},_o={key:1,style:{color:"#67c23a"}},vo={key:2,style:{color:"#e6a23c"}},fo={key:3,style:{color:"#f56c6c"}},go={key:4},yo={key:3},ho={class:"question-content-section",style:{"margin-bottom":"8px"}},bo=["innerHTML"],wo={key:0,class:"options-list",style:{"margin-top":"10px"}},xo={style:{"font-weight":"bold","margin-right":"6px"}},Vo=["innerHTML"],ko={class:"knowledge-stats-section",style:{"margin-bottom":"12px"}},Co={key:0,class:"knowledge-tags"},To={key:1},So={style:{"margin-left":"10px",color:"#909399","font-size":"12px"}},zo={class:"statistics-section",style:{"margin-bottom":"12px"}},Uo={key:0,class:"option-distribution-section",style:{"margin-bottom":"12px"}},jo={key:1,class:"wrong-answers-section",style:{"margin-bottom":"12px"}},$o={key:2,class:"correct-answer-section",style:{"margin-bottom":"12px"}},Mo=["innerHTML"],Lo={key:3,class:"sub-questions-section",style:{"margin-bottom":"12px"}},qo={style:{"font-weight":"bold","margin-bottom":"4px",color:"#606266"}},Io=["innerHTML"],Eo={key:0,style:{"margin-top":"6px",padding:"6px",background:"#e6f7ff","border-radius":"3px",color:"#1890ff"}},Ho=["innerHTML"],Po={key:1,style:{"margin-top":"6px",padding:"6px",background:"#f0f9ff","border-radius":"3px",color:"#409eff"}},Do=["innerHTML"],Ro={key:4,class:"analysis-section"},Fo=["innerHTML"],No={__name:"ComputerPaperManage",setup(Qo){rl([il,ul,dl,pl,ml,cl,_l,vl]);const _t=y("papers"),Te=y(""),Se=y(""),ze=y(""),vt=y([]),Fe=y(!1),me=y(1),Ue=y(20),ft=y(0),gt=y([]),Ne=y(!1),yt=y(0),X=He({status:"",page:1,pageSize:10}),Qe=y([]),Ae=y(!1),ce=y(!1),je=y(!1),Oe=y(!1),Be=y(null),_=He({id:null,title:"",description:"",majorId:"",paperType:1,sourcePaperId:"",sourcePaperName:"",startTime:"",endTime:"",duration:120,passScore:60,totalScore:100,isLimitedTime:1,showResultImmediately:1,allowReview:1,questionIds:[],questions:[]}),Ht={title:[{required:!0,message:"请输入考试名称",trigger:"blur"}],paperType:[{required:!0,message:"请选择试卷类型",trigger:"change"}],sourcePaperId:[{required:!0,message:"请选择来源试卷",trigger:"change",validator:(s,e,o)=>{(_.paperType===1||_.paperType===2)&&!e?o(new Error("请选择来源试卷")):o()}}],startTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],endTime:[{required:!0,message:"请选择结束时间",trigger:"change"}],duration:[{required:!0,message:"请输入考试时长",trigger:"blur"}],passScore:[{required:!0,message:"请输入及格分数",trigger:"blur"}],totalScore:[{required:!0,message:"请输入总分",trigger:"blur"}]},$e=y(!1),ht=y([]),Ke=y(!1),bt=y(0),I=He({keyword:"",type:"",chapterId:"",majorId:"",page:1,pageSize:10}),wt=y([]),ae=y([]),xt=y(""),Ye=y(!1),q=y(null),Je=y("statistics"),U=y(null),Me=y([]),We=y(3),Vt=y([]),Ge=y(!1),Z=y({page:1,pageSize:10}),kt=y(0),ee=y([]),le=He({}),Xe=y(null),Ze=y(null),et=y(null),tt=y(null),at=y(!1),w=y(null),Ct=y([]),_e=y([]),te=y([]),J=y(""),Le=y(""),lt=y(!1),st=y(!1),ve=y(!1),P=y({major_id:"",chapter_id:"",tag_id:""}),ge=y([]),ne=y([]),ye=y(!1),ot=y(!1),j=y({id:"",title:"",exam_full_name:"",year:"",school:"",paper_type:1,total_score:150,duration:180,difficulty:"中等"}),nt=y(!1),x=y(null),he=y(!1),rt=y(!1),it=y(!1),ut=y(!1),fe=y(!1),dt=y(!1),u=y({question_id:"",exercise_type:1,exercise_type_name:"",stem:"",options:[],answer:"",analysis:"",paper_score:2,subs:[]}),Q=s=>{if(!s)return"";let e=s;e=e.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<img src="$2" alt="$1" style="max-width:100%;height:auto;display:block;margin:10px 0;">'),e=e.replace(/\$([^$]+)\$/g,(i,m)=>{try{return Et.renderToString(m,{throwOnError:!1,displayMode:!1,strict:!1})}catch(r){return console.warn("KaTeX render error:",r),i}}),e=e.replace(/\$\$([^$]+)\$\$/g,(i,m)=>{try{return Et.renderToString(m,{throwOnError:!1,displayMode:!0,strict:!1})}catch(r){return console.warn("KaTeX render error:",r),i}}),e=e.replace(/<code>([\s\S]*?)<\/code>/g,'<code class="code-block">$1</code>'),e=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`);const o=[];if(e=e.replace(/<img[^>]*>/gi,i=>{const m=`__RENDERED_ELEMENT_${o.length}__`;return o.push({placeholder:m,content:i}),m}),e=e.replace(/<pre[^>]*>[\s\S]*?<\/pre>/gi,i=>{const m=`__RENDERED_ELEMENT_${o.length}__`;return o.push({placeholder:m,content:i}),m}),e=e.replace(/<span[^>]*class="katex"[^>]*>[\s\S]*?<\/span>/gi,i=>{const m=`__RENDERED_ELEMENT_${o.length}__`;return o.push({placeholder:m,content:i}),m}),!e.includes("<p")&&!e.includes("<div")){const i=e.split(/\n{2,}/).filter(m=>m.trim());i.length>1?e=i.map(m=>`<p style="margin: 0 0 8px 0; line-height: 1.6;">${m.replace(/\n/g,"<br>")}</p>`).join(""):i.length===1&&(e=i[0].replace(/\n/g,"<br>"))}else e=e.replace(/\n/g,"<br>");return o.forEach(({placeholder:i,content:m})=>{e=e.replace(i,m)}),e},re=async()=>{Ne.value=!0;try{const s={page:X.page,pageSize:X.pageSize,status:X.status},e=await G.get("/api/exams",{params:s});gt.value=e.data.list||[],yt.value=e.data.total||0}catch(s){console.error("获取考试列表失败:",s),k.error("获取考试列表失败")}finally{Ne.value=!1}},Pt=async()=>{Ae.value=!0;try{const s=await L.getComputerPapers({page:1,pageSize:100});Qe.value=s.data.list||s.data||[]}catch(s){console.error("获取试卷列表失败:",s)}finally{Ae.value=!1}},Dt=s=>{s===3&&(_.sourcePaperId="")},Rt=s=>{const e=Qe.value.find(o=>String(o.id)===String(s));e&&(_.sourcePaperName=e.title||e.exam_full_name||"",_.totalScore=e.total_score||100)},Ft=()=>{je.value=!1,Qt(),ce.value=!0},Nt=s=>{je.value=!0,_.id=s.id,_.title=s.title,_.description=s.description||"",_.paperType=s.paper_type,_.sourcePaperId=String(s.source_paper_id),_.startTime=s.start_time,_.endTime=s.end_time,_.duration=s.duration,_.passScore=s.pass_score,_.totalScore=s.total_score,_.isLimitedTime=s.is_limited_time,_.showResultImmediately=s.show_result_immediately,_.allowReview=s.allow_review,_.questionIds=s.question_ids?s.question_ids.split(",").map(e=>String(e)):[],ce.value=!0},Qt=()=>{_.id=null,_.title="",_.description="",_.majorId="",_.paperType=1,_.sourcePaperId="",_.sourcePaperName="",_.startTime="",_.endTime="",_.duration=120,_.passScore=60,_.totalScore=100,_.isLimitedTime=1,_.showResultImmediately=1,_.allowReview=1,_.questionIds=[],_.questions=[],ae.value=[]},At=async()=>{Be.value&&await Be.value.validate(async s=>{if(s){Oe.value=!0;try{const e={title:_.title,description:_.description,paper_type:_.paperType,source_paper_id:_.sourcePaperId,start_time:_.startTime,end_time:_.endTime,duration:_.duration,pass_score:_.passScore,total_score:_.totalScore,is_limited_time:_.isLimitedTime,show_result_immediately:_.showResultImmediately,allow_review:_.allowReview,question_ids:_.questionIds.join(",")};je.value?(e.id=_.id,await G.put(`/api/exams/${_.id}`,e),k.success("考试更新成功")):(await G.post("/api/exams",e),k.success("考试创建成功")),ce.value=!1,re()}catch(e){console.error("保存考试失败:",e),k.error("保存考试失败")}finally{Oe.value=!1}}})},Ot=async s=>{try{await Ce.confirm("确定要删除该考试吗？","提示",{type:"warning"}),await G.delete(`/api/exams/${s}`),k.success("删除成功"),re()}catch(e){e!=="cancel"&&(console.error("删除考试失败:",e),k.error("删除失败"))}},Bt=async s=>{try{await G.put(`/api/exams/${s.id}/publish`,{is_published:s.is_published?0:1}),k.success(s.is_published?"取消发布成功":"发布成功"),re()}catch(e){console.error("发布状态更新失败:",e),k.error("操作失败")}},Kt=()=>{$e.value=!0,I.keyword="",I.type="",I.chapterId="",I.page=1,ie()},ie=async()=>{Ke.value=!0;try{const s={page:I.page,pageSize:I.pageSize,keyword:I.keyword,type:I.type,chapterId:I.chapterId},e=await G.get("/api/questions",{params:s});ht.value=e.data.list||e.data||[],bt.value=e.data.total||0}catch(s){console.error("获取题目列表失败:",s)}finally{Ke.value=!1}},Yt=s=>{wt.value=s},Jt=()=>{ae.value=wt.value.map(s=>({...s,score:s.paper_score||s.default_score||5})),_.questionIds=ae.value.map(s=>String(s.question_id||s.id)),$e.value=!1},Wt=s=>{ae.value.splice(s,1),_.questionIds=ae.value.map(e=>String(e.question_id||e.id))},Tt=()=>{I.page=1,ie()},Gt=()=>ae.value.reduce((s,e)=>s+(parseFloat(e.score)||0),0),Xt=async s=>{q.value=s,Ye.value=!0,Je.value="statistics";try{const e=await G.get(`/api/exams/${s.id}/statistics`);U.value=e.data,Me.value=e.data.question_analysis||[]}catch(e){console.error("获取考试统计失败:",e)}},be=async(s=null)=>{var e;if(s||(s=(e=q.value)==null?void 0:e.id),!!s){Ge.value=!0;try{const o={page:Z.value.page,pageSize:Z.value.pageSize,keyword:Z.value.keyword},i=await G.get(`/api/exams/${s}/records`,{params:o});Vt.value=i.data.list||i.data||[],kt.value=i.data.total||0}catch(o){console.error("获取考试记录失败:",o)}finally{Ge.value=!1}}},St=async(s=null)=>{var e;if(s||(s=(e=q.value)==null?void 0:e.id),!!s)try{const o=await G.get(`/api/exams/${s}/pending-questions`);ee.value=o.data||[],ee.value.forEach(i=>{le[i.answer_id]={score:0,comment:""}})}catch(o){console.error("获取待批改题目失败:",o)}},Zt=async s=>{try{await G.post(`/api/exam-answers/${s.answer_id}/grade`,{score:le[s.answer_id].score,comment:le[s.answer_id].comment}),k.success("评分提交成功"),St()}catch(e){console.error("提交评分失败:",e),k.error("提交评分失败")}},ea=s=>{const e=ee.value.findIndex(o=>o.answer_id===s.answer_id);e>-1&&ee.value.splice(e,1)},ta=s=>{w.value=s,at.value=!0},aa=s=>{if(!s)return[];try{const e=typeof s=="string"?JSON.parse(s):s,o=Object.values(e).reduce((i,m)=>i+m,0);return Object.entries(e).map(([i,m])=>({option:i,count:m,percentage:o>0?(m/o*100).toFixed(1):0}))}catch{return[]}},la=s=>{if(!s)return[];try{const e=typeof s=="string"?JSON.parse(s):s;return Object.entries(e).map(([o,i])=>({answer:o,count:i}))}catch{return[]}},sa=s=>{s==="statistics"&&q.value?ol(()=>{U.value&&(oa(),na(),ra(),U.value.score_trend&&ia())}):s==="records"&&q.value?be():s==="grading"&&q.value&&St()},oa=()=>{var i;if(!Xe.value||!((i=U.value)!=null&&i.score_distribution))return;const s=Re(Xe.value),e=U.value.score_distribution,o={tooltip:{trigger:"axis"},xAxis:{type:"category",data:Object.keys(e)},yAxis:{type:"value"},series:[{data:Object.values(e),type:"bar",itemStyle:{color:"#409eff"}}]};s.setOption(o)},na=()=>{var i;if(!Ze.value||!((i=U.value)!=null&&i.question_type_stats))return;const s=Re(Ze.value),e=U.value.question_type_stats,o={tooltip:{trigger:"item"},series:[{type:"pie",radius:"50%",data:e.map(m=>({name:m.type_name,value:m.question_count}))}]};s.setOption(o)},ra=()=>{if(!et.value||!U.value)return;const s=Re(et.value),e=U.value.pass_count||0,o=(U.value.total_participants||0)-e,i={tooltip:{trigger:"item"},series:[{type:"pie",radius:["40%","70%"],data:[{name:"及格",value:e,itemStyle:{color:"#67c23a"}},{name:"不及格",value:o,itemStyle:{color:"#f56c6c"}}]}]};s.setOption(i)},ia=()=>{var o;if(!tt.value||!((o=U.value)!=null&&o.score_trend))return;const s=Re(tt.value),e={tooltip:{trigger:"axis"},xAxis:{type:"category",data:U.value.score_trend.map((i,m)=>`第${m+1}次`)},yAxis:{type:"value"},series:[{data:U.value.score_trend,type:"line",smooth:!0,itemStyle:{color:"#409eff"}}]};s.setOption(e)},ua=nl(()=>{var e;if(!Me.value||!((e=U.value)!=null&&e.question_type_stats))return[];const s=[];return U.value.question_type_stats.forEach(o=>{const i=Me.value.filter(m=>String(m.exercise_type)===String(o.exercise_type)).sort((m,r)=>(parseFloat(r.correct_rate)||100)-(parseFloat(m.correct_rate)||100)).slice(0,We.value);s.push(...i)}),s}),we=s=>s?new Date(s).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",da=s=>s?new Date(s).toLocaleDateString("zh-CN"):"-",qe=s=>s?s.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").trim():"",zt=s=>({1:"primary",2:"success",3:"warning"})[s]||"info",W=s=>{if(!s)return[];if(Array.isArray(s))return s.filter(e=>e&&typeof e=="string"&&e.trim()!=="");try{const e=typeof s=="string"?JSON.parse(s):s;return Array.isArray(e)?e.filter(o=>o&&typeof o=="string"&&o.trim()!==""):[]}catch{return[]}},pa=s=>({ongoing:"success",upcoming:"warning",completed:"info"})[s]||"info",ma=s=>({ongoing:"进行中",upcoming:"即将开始",completed:"已结束"})[s]||"未知",ca=async()=>{try{const s=await L.getComputerSubjects({admin:1});Ct.value=s.data||[]}catch(s){console.error("获取科目列表失败:",s)}},se=async()=>{Fe.value=!0;try{const e=(await L.getComputerPaperList({page:me.value,pageSize:Ue.value,keyword:Te.value,paperType:Se.value,majorId:ze.value})).data||{};vt.value=e.list||[],ft.value=e.total||0}catch(s){console.error("获取试卷列表失败:",s),k.error("获取试卷列表失败")}finally{Fe.value=!1}},Ie=()=>{me.value=1,se()},_a=()=>{Te.value="",Se.value="",ze.value="",me.value=1,se()},va=s=>{Ue.value=s,se()},fa=s=>{me.value=s,se()},Ut=async s=>{try{const e=await L.getComputerPaperDetail(s.id);x.value=e.data||null,nt.value=!0,he.value=!1}catch(e){console.error("获取试卷详情失败:",e),k.error("获取试卷详情失败")}},ga=async()=>{var i,m;if(!x.value||!x.value.questions||x.value.questions.length===0){k.warning("试卷中没有题目，无需同步");return}const s=x.value.questions,e=x.value,o=[];if(s.forEach(r=>{(r.exam_time!==e.year||r.from_school!==e.school||r.exam_code!==e.exam_code||r.exam_full_name!==e.exam_full_name)&&o.push(r)}),o.length===0){k.info("所有题目信息已与试卷一致，无需更新");return}try{await Ce.confirm(`检测到 ${o.length} 道题目需要更新：

试卷年份: ${e.year||"未设置"}
试卷学校/来源: ${e.school||"未设置"}
试卷科目代码: ${e.exam_code||"未设置"}
试卷考试全称: ${e.exam_full_name||"未设置"}

是否将这些信息同步到所有题目？`,"确认统一题目信息",{confirmButtonText:"同步更新",cancelButtonText:"取消",type:"warning"}),it.value=!0;let r=0,c=0;for(const h of o)try{await L.updateComputerQuestion(h.question_id,{...h,exam_time:e.year,from_school:e.school,exam_code:e.exam_code,exam_full_name:e.exam_full_name}),r++}catch(V){console.error(`更新题目 ${h.question_id} 失败:`,V),c++}c===0?k.success(`成功更新 ${r} 道题目`):k.warning(`更新完成：成功 ${r} 道，失败 ${c} 道`),await Ut({id:e.id})}catch(r){r!=="cancel"&&(console.error("同步题目信息失败:",r),k.error("同步失败: "+(((m=(i=r.response)==null?void 0:i.data)==null?void 0:m.message)||r.message)))}finally{it.value=!1}},ya=s=>{j.value={id:s.id,title:s.title||"",exam_full_name:s.exam_full_name||"",year:s.year||"",school:s.school||"",paper_type:s.paper_type||1,total_score:s.total_score||150,duration:s.duration||180,difficulty:s.difficulty||"中等"},ye.value=!0},ha=async()=>{var s,e;if(!j.value.title){k.warning("请输入试卷名称");return}ot.value=!0;try{await L.updateComputerPaper(j.value.id,{title:j.value.title,exam_full_name:j.value.exam_full_name,year:j.value.year,school:j.value.school,paper_type:j.value.paper_type,total_score:j.value.total_score,duration:j.value.duration,difficulty:j.value.difficulty}),k.success("保存成功"),ye.value=!1,se()}catch(o){console.error("保存试卷失败:",o),k.error("保存失败: "+(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||o.message))}finally{ot.value=!1}},ba=async s=>{var e,o;try{await Ce.confirm(`确定要删除试卷"${s.title}"吗？此操作将同时删除试卷与题目的关联关系，但不会删除题目本身。`,"确认删除",{type:"warning"}),await L.deleteComputerPaper(s.id),k.success("删除成功"),se()}catch(i){i!=="cancel"&&(console.error("删除试卷失败:",i),k.error("删除失败: "+(((o=(e=i.response)==null?void 0:e.data)==null?void 0:o.message)||i.message)))}},wa=async s=>{console.log("点击编辑按钮:",s),await xa(s)},xa=async s=>{console.log("编辑题目:",s.question_id);try{await Va();const o=(await L.getComputerQuestionDetail(s.question_id)).data;let i=o.major_id,m=o.chapter_id;if((!i||!m)&&o.tags&&o.tags.length>0){const r=await Ca(o.tags);r&&(i=r.major_id,m=r.chapter_id,console.log("从标签推断:",r))}if(o.chapter_id){const r=await jt(o.chapter_id);r&&(J.value=r.chapter_name,!i&&r.major_id&&(i=r.major_id))}if(i&&await xe(i),J.value="",Le.value="",m){const r=te.value.find(c=>String(c.chapter_id||c.id)===String(m));if(r){const c=[],h=_e.value.find(V=>String(V.major_id||V.id)===String(i));h&&c.push(h.subject_name||h.name),(r.parent_name||r.parent_chapter_name)&&c.push(r.parent_name||r.parent_chapter_name),c.push(r.chapter_name||r.name),Le.value=c.join(" > ")}else{const c=await jt(m);c&&(Le.value=c.chapter_name)}}u.value={question_id:o.question_id,exercise_type:o.exercise_type,exercise_type_name:o.exercise_type_name,stem:o.stem||"",options:o.options?typeof o.options=="string"?JSON.parse(o.options):o.options:[],answer:o.answer||"",analysis:o.analysis||"",paper_score:s.paper_score||o.total_score||2,subs:o.subs||[],knowledgeTags:o.tags||[],major_id:i?String(i):null,chapter_id:m?String(m):null,exam_group_id:o.exam_group_id,level:o.level||1,total_score:o.total_score||0,exam_id:o.exam_id,category_id:o.category_id,from_school:o.from_school||"",exam_time:o.exam_time||"",exam_code:o.exam_code||"",exam_full_name:o.exam_full_name||"",exercise_number:o.exercise_number||1,video_url:o.video_url||""},fe.value=!0,console.log("对话框状态:",fe.value),console.log("题目详情（含小题）:",u.value)}catch(e){console.error("获取题目详情失败:",e),k.error("获取题目详情失败")}},Va=async()=>{lt.value=!0;try{const s=await L.getComputerSubjects();_e.value=s.data||[]}catch(s){console.error("获取科目列表失败:",s),_e.value=[]}finally{lt.value=!1}},xe=async s=>{if(!s){te.value=[];return}st.value=!0;try{const e=await L.getComputerChapters({majorId:String(s)});Array.isArray(e.data)?te.value=e.data:e.data&&Array.isArray(e.data.list)?te.value=e.data.list:e.data&&Array.isArray(e.data.data)?te.value=e.data.data:te.value=[]}catch(e){console.error("获取章节列表失败:",e),te.value=[]}finally{st.value=!1}},ka=s=>{if(!s)return"";const e=[];return(s.parent_name||s.parent_chapter_name)&&e.push(s.parent_name||s.parent_chapter_name),e.push(s.chapter_name||s.name),e.join(" > ")},Ca=async s=>{var e,o;if(!s||s.length===0)return null;try{const i=s.map(r=>typeof r=="string"?r:r.tag_id).filter(r=>r&&/^\d+$/.test(String(r))),m=s.map(r=>typeof r=="string"?r:r.tag_name).filter(r=>r&&!/^\d+$/.test(String(r)));if(i.length>0){const c=((e=(await L.getComputerTags({keyword:i.join(","),pageSize:i.length})).data)==null?void 0:e.list)||[];for(const h of c)if(h.chapter_id){const V=[];return h.major_name&&V.push(h.major_name),h.parent_chapter_name&&V.push(h.parent_chapter_name),h.chapter_name&&V.push(h.chapter_name),J.value=V.length>0?V.join(" > "):"未分配章节",{major_id:h.major_id||h.chapter_id,chapter_id:h.chapter_id,chapter_name:J.value}}}if(m.length>0)for(const r of m){const h=((o=(await L.getComputerTags({keyword:r,pageSize:1})).data)==null?void 0:o.list)||[];if(h.length>0){const V=h[0];if(V.chapter_id){const N=[];return V.major_name&&N.push(V.major_name),V.parent_chapter_name&&N.push(V.parent_chapter_name),V.chapter_name&&N.push(V.chapter_name),J.value=N.length>0?N.join(" > "):"未分配章节",{major_id:V.major_id||V.chapter_id,chapter_id:V.chapter_id,chapter_name:J.value}}}}return J.value="",null}catch(i){return console.error("推断科目章节失败:",i),J.value="",null}},Ta=()=>{const s=String.fromCharCode(65+u.value.options.length);u.value.options.push({option_key:s,option_value:""})},Sa=s=>{u.value.options.splice(s,1),u.value.options.forEach((e,o)=>{e.option_key=String.fromCharCode(65+o)})},za=async s=>{u.value.chapter_id=null,Le.value="",J.value="",await xe(s)},jt=async s=>{var e;if(!s)return null;try{const i=((e=(await L.getComputerTags({keyword:s,pageSize:1})).data)==null?void 0:e.list)||[];if(i.length>0){const m=i[0],r=[];return m.major_name&&r.push(m.major_name),m.parent_chapter_name&&r.push(m.parent_chapter_name),m.chapter_name&&r.push(m.chapter_name),{chapter_name:r.join(" > "),major_id:m.major_id,major_name:m.major_name}}return null}catch(o){return console.warn("获取章节信息失败:",o),null}},Ua=s=>{const e={1:"单选题",2:"多选题",3:"填空题",4:"解答题",5:"判断题"};u.value.exercise_type_name=e[s]||"",(s===1||s===2||s===5)&&(!u.value.options||u.value.options.length===0)&&(u.value.options=[{option_key:"A",option_value:""},{option_key:"B",option_value:""},{option_key:"C",option_value:""},{option_key:"D",option_value:""}]),s===4&&(!u.value.subs||u.value.subs.length===0)&&(u.value.subs=[])},ja=()=>{u.value.subs||(u.value.subs=[]),u.value.subs.push({stem:"",answer:"",analysis:"",score:0})},$a=s=>{u.value.subs.splice(s,1)},Ma=s=>{u.value.knowledgeTags.splice(s,1)},La=()=>{P.value={major_id:u.value.major_id||"",chapter_id:u.value.chapter_id||"",tag_id:""},ge.value=[],ne.value=[],P.value.major_id&&$t(P.value.major_id),P.value.chapter_id&&Mt(P.value.chapter_id),ve.value=!0},qa=async s=>{P.value.chapter_id="",P.value.tag_id="",ge.value=[],ne.value=[],s&&await $t(s)},Ia=async s=>{P.value.tag_id="",ne.value=[],s&&await Mt(s)},$t=async s=>{var e;try{const o=await L.getComputerChapters({majorId:s});console.log("获取章节列表:",o.data);const i=((e=o.data)==null?void 0:e.data)||o.data||[],m=Array.isArray(i)?i:i.chapters||[];ge.value=m.map(r=>({id:r.id||r.chapter_id,name:r.name||r.chapter_name||"未命名章节"}))}catch(o){console.error("获取章节列表失败:",o),ge.value=[]}},Mt=async s=>{var e;try{const o=await L.getComputerTags({chapterId:s,pageSize:1e3});console.log("获取考点列表:",o.data);const i=((e=o.data)==null?void 0:e.data)||o.data||{},m=i.list||i||[];ne.value=m.map(r=>({tag_id:r.tag_id||r.id,tag_name:r.tag_name||r.name||"未命名考点"}))}catch(o){console.error("获取考点列表失败:",o),ne.value=[]}},Ea=async()=>{var i,m,r,c,h;const s=P.value.tag_id;if(!s)return;const e=ne.value.find(V=>String(V.tag_id)===String(s));if(!e){k.error("未找到选中的考点");return}if((i=u.value.knowledgeTags)==null?void 0:i.some(V=>String(V.tag_id||V)===String(s))){k.warning("该标签已存在"),ve.value=!1;return}try{const V=await L.getKnowledgeTagById(s),N=((m=V.data)==null?void 0:m.data)||V.data;if(N&&N.chapter_id){const b=await L.getChapterById(N.chapter_id),R=((r=b.data)==null?void 0:r.data)||b.data;if(R){const ue=u.value.major_id,D=u.value.chapter_id,O=String(R.major_id),B=String(R.chapter_id);if(!ue&&!D)u.value.major_id=O,await xe(O),u.value.chapter_id=B,k.success(`已自动关联科目和章节：${R.chapter_name}`);else if(ue!==O||D!==B){const T=((c=_e.value.find(Ve=>String(Ve.id)===String(ue)))==null?void 0:c.name)||ue||"无",de=((h=te.value.find(Ve=>String(Ve.chapter_id)===String(D)))==null?void 0:h.chapter_name)||D||"无";try{await Ce.confirm(`考点的所属信息与您当前设置不一致：

当前：${T} / ${de}
考点：${R.subject_name||O} / ${R.chapter_name}

是否更新为考点的所属科目和章节？`,"科目章节不一致",{confirmButtonText:"更新",cancelButtonText:"保持当前",type:"warning",dangerouslyUseHTMLString:!1}),u.value.major_id=O,await xe(O),u.value.chapter_id=B,k.success(`已更新为：${R.chapter_name}`)}catch{k.info("保持当前科目章节设置")}}}}}catch(V){console.error("获取考点信息失败:",V)}u.value.knowledgeTags||(u.value.knowledgeTags=[]),u.value.knowledgeTags.push({tag_id:e.tag_id,tag_name:e.tag_name}),k.success("添加成功"),ve.value=!1},Ha=async()=>{Ce.prompt("请输入知识点标签名称或ID","添加标签",{confirmButtonText:"确定",cancelButtonText:"取消",inputValidator:s=>!s||s.trim()===""?"标签名称或ID不能为空":!0}).then(async({value:s})=>{const e=s.trim();try{let o=null;if(/^\d+$/.test(e))try{const m=await L.getKnowledgeTagById(e);m.data&&(o=m.data)}catch{}if(!o){const m=await L.getKnowledgeTagByName(e);m.data&&(o=m.data)}if(o&&o.chapter_id){const r=(await L.getChapterById(o.chapter_id)).data;r&&(r.major_id&&!u.value.major_id&&(u.value.major_id=r.major_id,await xe(r.major_id)),u.value.chapter_id||(u.value.chapter_id=r.chapter_id),k.success(`已自动关联科目和章节：${r.chapter_name}`))}if(u.value.knowledgeTags||(u.value.knowledgeTags=[]),u.value.knowledgeTags.some(m=>(typeof m=="string"?m:m.tag_name)===((o==null?void 0:o.tag_name)||e))){k.warning("该标签已存在");return}u.value.knowledgeTags.push({tag_id:o==null?void 0:o.tag_id,tag_name:(o==null?void 0:o.tag_name)||e}),k.success("添加成功")}catch(o){console.error("添加标签失败:",o),u.value.knowledgeTags||(u.value.knowledgeTags=[]),u.value.knowledgeTags.push({tag_name:e}),k.success("添加成功（未找到对应考点信息）")}}).catch(()=>{})},Pa=async()=>{var s,e;dt.value=!0;try{const o={stem:u.value.stem,answer:u.value.answer,analysis:u.value.analysis,options:u.value.options,subs:u.value.subs,exercise_type:u.value.exercise_type,exercise_type_name:u.value.exercise_type_name,knowledgeTags:u.value.knowledgeTags,major_id:u.value.major_id,chapter_id:u.value.chapter_id,exam_group_id:u.value.exam_group_id,level:u.value.level,total_score:u.value.total_score,exam_id:u.value.exam_id,category_id:u.value.category_id,from_school:u.value.from_school,exam_time:u.value.exam_time,exam_code:u.value.exam_code,exam_full_name:u.value.exam_full_name,exercise_number:u.value.exercise_number,video_url:u.value.video_url};await L.updateComputerQuestion(u.value.question_id,o);const i=x.value.questions.findIndex(m=>m.question_id===u.value.question_id);i!==-1&&(x.value.questions[i].stem=u.value.stem,x.value.questions[i].answer=u.value.answer,x.value.questions[i].analysis=u.value.analysis,x.value.questions[i].options=u.value.options,x.value.questions[i].subs=u.value.subs,x.value.questions[i].paper_score=u.value.paper_score,x.value.questions[i].exercise_type=u.value.exercise_type,x.value.questions[i].exercise_type_name=u.value.exercise_type_name),k.success("保存成功"),fe.value=!1,J.value=""}catch(o){console.error("保存题目失败:",o),k.error("保存失败: "+(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||o.message))}finally{dt.value=!1}},Da=async()=>{var s,e;rt.value=!0;try{const o=x.value.questions.map((i,m)=>({question_id:i.question_id,sort_order:m+1,score:i.paper_score||i.total_score||2}));await L.updateComputerPaperQuestions(x.value.id,{questions:o}),k.success("保存成功")}catch(o){console.error("保存题目顺序失败:",o),k.error("保存失败: "+(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||o.message))}finally{rt.value=!1}},Ra=async()=>{var s,e;if(x.value){ut.value=!0;try{const o={title:x.value.title,exam_full_name:x.value.exam_full_name,year:x.value.year,school:x.value.school,paper_type:x.value.paper_type,exam_code:x.value.exam_code,total_score:x.value.total_score,duration:x.value.duration};await L.updateComputerPaper(x.value.id,o),k.success("试卷信息保存成功"),await se()}catch(o){console.error("保存试卷信息失败:",o),k.error("保存失败: "+(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||o.message))}finally{ut.value=!1}}};return Ya(()=>{ca(),se(),re()}),(s,e)=>{const o=z("el-input"),i=z("el-option"),m=z("el-select"),r=z("el-button"),c=z("el-table-column"),h=z("el-tag"),V=z("el-table"),N=z("el-pagination"),b=z("el-form-item"),R=z("el-radio-button"),ue=z("el-radio-group"),D=z("el-input-number"),O=z("el-form"),B=z("el-dialog"),T=z("el-descriptions-item"),de=z("el-descriptions"),Ve=z("DocumentChecked"),A=z("el-icon"),C=z("el-col"),Fa=z("el-rate"),F=z("el-row"),Na=z("el-button-group"),Lt=z("el-date-picker"),pt=z("el-switch"),ke=z("el-tab-pane"),oe=z("el-card"),Qa=z("el-alert"),Aa=z("el-slider"),Oa=z("el-empty"),qt=z("el-tabs"),Ba=z("el-progress"),Ee=Ja("loading");return d(),f("div",fl,[t(qt,{modelValue:_t.value,"onUpdate:modelValue":e[82]||(e[82]=a=>_t.value=a),type:"border-card"},{default:l(()=>[t(ke,{label:"试卷管理",name:"papers"},{default:l(()=>[e[125]||(e[125]=n("h2",null,"计算机试卷管理",-1)),n("div",gl,[t(o,{modelValue:Te.value,"onUpdate:modelValue":e[0]||(e[0]=a=>Te.value=a),placeholder:"搜索试卷名称/学校/考试名称",style:{width:"300px"},clearable:"",onKeyup:Pe(Ie,["enter"])},null,8,["modelValue"]),t(m,{modelValue:Se.value,"onUpdate:modelValue":e[1]||(e[1]=a=>Se.value=a),placeholder:"试卷类型",clearable:"",style:{width:"150px","margin-left":"10px"},onChange:Ie},{default:l(()=>[t(i,{label:"真题卷",value:1}),t(i,{label:"模拟卷",value:2}),t(i,{label:"组卷",value:3})]),_:1},8,["modelValue"]),t(m,{modelValue:ze.value,"onUpdate:modelValue":e[2]||(e[2]=a=>ze.value=a),placeholder:"科目",clearable:"",style:{width:"150px","margin-left":"10px"},onChange:Ie},{default:l(()=>[(d(!0),f(E,null,H(Ct.value,a=>(d(),S(i,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(r,{type:"primary",onClick:Ie,style:{"margin-left":"10px"}},{default:l(()=>[...e[83]||(e[83]=[p("搜索",-1)])]),_:1}),t(r,{onClick:_a},{default:l(()=>[...e[84]||(e[84]=[p("重置",-1)])]),_:1})]),De((d(),S(V,{data:vt.value,border:""},{default:l(()=>[t(c,{type:"index",label:"序号",width:"60",align:"center"}),t(c,{prop:"title",label:"试卷名称","min-width":"200","show-overflow-tooltip":""}),t(c,{prop:"exam_full_name",label:"考试全称","min-width":"200","show-overflow-tooltip":""}),t(c,{prop:"year",label:"年份",width:"80",align:"center"}),t(c,{prop:"school",label:"学校/来源",width:"120","show-overflow-tooltip":""}),t(c,{prop:"paper_type",label:"类型",width:"80",align:"center"},{default:l(({row:a})=>[a.paper_type===1?(d(),S(h,{key:0,type:"success"},{default:l(()=>[...e[85]||(e[85]=[p("真题卷",-1)])]),_:1})):a.paper_type===2?(d(),S(h,{key:1,type:"warning"},{default:l(()=>[...e[86]||(e[86]=[p("模拟卷",-1)])]),_:1})):(d(),S(h,{key:2,type:"info"},{default:l(()=>[...e[87]||(e[87]=[p("组卷",-1)])]),_:1}))]),_:1}),t(c,{prop:"exam_code",label:"科目",width:"80",align:"center"}),t(c,{prop:"question_count",label:"题目数",width:"80",align:"center"}),t(c,{prop:"total_score",label:"总分",width:"80",align:"center"}),t(c,{prop:"duration",label:"时长(分)",width:"80",align:"center"}),t(c,{prop:"difficulty",label:"难度",width:"80",align:"center"}),t(c,{prop:"created_at",label:"创建时间",width:"160"},{default:l(({row:a})=>[p(v(da(a.created_at)),1)]),_:1}),t(c,{label:"操作",width:"200",fixed:"right"},{default:l(({row:a})=>[t(r,{type:"primary",size:"small",onClick:g=>Ut(a)},{default:l(()=>[...e[88]||(e[88]=[p("详情",-1)])]),_:1},8,["onClick"]),t(r,{type:"warning",size:"small",onClick:g=>ya(a)},{default:l(()=>[...e[89]||(e[89]=[p("编辑",-1)])]),_:1},8,["onClick"]),t(r,{type:"danger",size:"small",onClick:g=>ba(a)},{default:l(()=>[...e[90]||(e[90]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ee,Fe.value]]),n("div",yl,[t(N,{"current-page":me.value,"onUpdate:currentPage":e[3]||(e[3]=a=>me.value=a),"page-size":Ue.value,"onUpdate:pageSize":e[4]||(e[4]=a=>Ue.value=a),"page-sizes":[10,20,50,100],total:ft.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:va,onCurrentChange:fa},null,8,["current-page","page-size","total"])]),t(B,{modelValue:ye.value,"onUpdate:modelValue":e[14]||(e[14]=a=>ye.value=a),title:"编辑试卷",width:"600px"},{footer:l(()=>[t(r,{onClick:e[13]||(e[13]=a=>ye.value=!1)},{default:l(()=>[...e[94]||(e[94]=[p("取消",-1)])]),_:1}),t(r,{type:"primary",onClick:ha,loading:ot.value},{default:l(()=>[...e[95]||(e[95]=[p("保存",-1)])]),_:1},8,["loading"])]),default:l(()=>[t(O,{model:j.value,"label-width":"100px"},{default:l(()=>[t(b,{label:"试卷名称"},{default:l(()=>[t(o,{modelValue:j.value.title,"onUpdate:modelValue":e[5]||(e[5]=a=>j.value.title=a)},null,8,["modelValue"])]),_:1}),t(b,{label:"考试全称"},{default:l(()=>[t(o,{modelValue:j.value.exam_full_name,"onUpdate:modelValue":e[6]||(e[6]=a=>j.value.exam_full_name=a)},null,8,["modelValue"])]),_:1}),t(b,{label:"年份"},{default:l(()=>[t(o,{modelValue:j.value.year,"onUpdate:modelValue":e[7]||(e[7]=a=>j.value.year=a)},null,8,["modelValue"])]),_:1}),t(b,{label:"学校/来源"},{default:l(()=>[t(o,{modelValue:j.value.school,"onUpdate:modelValue":e[8]||(e[8]=a=>j.value.school=a)},null,8,["modelValue"])]),_:1}),t(b,{label:"试卷类型"},{default:l(()=>[t(ue,{modelValue:j.value.paper_type,"onUpdate:modelValue":e[9]||(e[9]=a=>j.value.paper_type=a)},{default:l(()=>[t(R,{label:1},{default:l(()=>[...e[91]||(e[91]=[p("真题卷",-1)])]),_:1}),t(R,{label:2},{default:l(()=>[...e[92]||(e[92]=[p("模拟卷",-1)])]),_:1}),t(R,{label:3},{default:l(()=>[...e[93]||(e[93]=[p("组卷",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"总分"},{default:l(()=>[t(D,{modelValue:j.value.total_score,"onUpdate:modelValue":e[10]||(e[10]=a=>j.value.total_score=a),min:0,max:300},null,8,["modelValue"])]),_:1}),t(b,{label:"考试时长"},{default:l(()=>[t(D,{modelValue:j.value.duration,"onUpdate:modelValue":e[11]||(e[11]=a=>j.value.duration=a),min:0,max:300},null,8,["modelValue"])]),_:1}),t(b,{label:"难度"},{default:l(()=>[t(m,{modelValue:j.value.difficulty,"onUpdate:modelValue":e[12]||(e[12]=a=>j.value.difficulty=a),placeholder:"选择难度",style:{width:"100%"}},{default:l(()=>[t(i,{label:"简单",value:"简单"}),t(i,{label:"中等",value:"中等"}),t(i,{label:"困难",value:"困难"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:nt.value,"onUpdate:modelValue":e[24]||(e[24]=a=>nt.value=a),title:"试卷详情",width:"95%",top:"3vh",fullscreen:he.value},{header:l(()=>[n("div",hl,[e[96]||(e[96]=n("span",null,"试卷详情",-1)),t(r,{type:"primary",size:"small",onClick:e[15]||(e[15]=a=>he.value=!he.value)},{default:l(()=>[p(v(he.value?"退出全屏":"全屏"),1)]),_:1})])]),default:l(()=>{var a;return[x.value?(d(),f("div",bl,[t(de,{column:4,border:""},{default:l(()=>[t(T,{label:"试卷名称"},{default:l(()=>[t(o,{modelValue:x.value.title,"onUpdate:modelValue":e[16]||(e[16]=g=>x.value.title=g),size:"small",placeholder:"试卷名称"},null,8,["modelValue"])]),_:1}),t(T,{label:"考试全称"},{default:l(()=>[t(o,{modelValue:x.value.exam_full_name,"onUpdate:modelValue":e[17]||(e[17]=g=>x.value.exam_full_name=g),size:"small",placeholder:"考试全称"},null,8,["modelValue"])]),_:1}),t(T,{label:"年份"},{default:l(()=>[t(o,{modelValue:x.value.year,"onUpdate:modelValue":e[18]||(e[18]=g=>x.value.year=g),size:"small",placeholder:"如：2024年"},null,8,["modelValue"])]),_:1}),t(T,{label:"学校/来源"},{default:l(()=>[t(o,{modelValue:x.value.school,"onUpdate:modelValue":e[19]||(e[19]=g=>x.value.school=g),size:"small",placeholder:"如：全国统考"},null,8,["modelValue"])]),_:1}),t(T,{label:"类型"},{default:l(()=>[t(m,{modelValue:x.value.paper_type,"onUpdate:modelValue":e[20]||(e[20]=g=>x.value.paper_type=g),size:"small",style:{width:"100%"}},{default:l(()=>[t(i,{label:"真题卷",value:1}),t(i,{label:"模拟卷",value:2}),t(i,{label:"组卷",value:3})]),_:1},8,["modelValue"])]),_:1}),t(T,{label:"科目"},{default:l(()=>[t(o,{modelValue:x.value.exam_code,"onUpdate:modelValue":e[21]||(e[21]=g=>x.value.exam_code=g),size:"small",placeholder:"如：408"},null,8,["modelValue"])]),_:1}),t(T,{label:"总分"},{default:l(()=>[t(D,{modelValue:x.value.total_score,"onUpdate:modelValue":e[22]||(e[22]=g=>x.value.total_score=g),size:"small",min:0,max:300,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(T,{label:"时长"},{default:l(()=>[t(D,{modelValue:x.value.duration,"onUpdate:modelValue":e[23]||(e[23]=g=>x.value.duration=g),size:"small",min:0,max:300,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),n("div",wl,[t(r,{type:"primary",size:"small",onClick:Ra,loading:ut.value},{default:l(()=>[...e[97]||(e[97]=[p("保存试卷信息",-1)])]),_:1},8,["loading"])]),n("div",xl,[n("h3",null,"题目列表（共 "+v(((a=x.value.questions)==null?void 0:a.length)||0)+" 题）",1),n("div",null,[t(r,{type:"danger",onClick:ga,loading:it.value},{default:l(()=>[t(A,null,{default:l(()=>[t(Ve)]),_:1}),e[98]||(e[98]=p(" 统一题目信息 ",-1))]),_:1},8,["loading"]),t(r,{type:"primary",onClick:Da,loading:rt.value},{default:l(()=>[...e[99]||(e[99]=[p("保存题目修改",-1)])]),_:1},8,["loading"])])]),n("div",Vl,[(d(!0),f(E,null,H(x.value.questions,(g,$)=>(d(),f("div",{key:g.question_id,class:"question-item"},[n("div",kl,[n("span",Cl,"第 "+v(g.sort_order||$+1)+" 题",1),n("span",Tl,v(g.exercise_type_name),1),n("span",Sl,"分值: "+v(g.paper_score||g.total_score)+"分",1),t(r,{type:"primary",size:"small",onClick:Wa(Y=>wa(g),["stop"])},{default:l(()=>[...e[100]||(e[100]=[p("编辑",-1)])]),_:1},8,["onClick"])]),n("div",{class:"question-content math-content",innerHTML:Q(g.stem)},null,8,zl),g.options&&g.options.length>0?(d(),f("div",Ul,[(d(!0),f(E,null,H(g.options,Y=>(d(),f("div",{key:Y.option_key,class:"option-item-inline"},[n("span",jl,v(Y.option_key)+".",1),n("span",{class:"math-content",innerHTML:Q(Y.option_value)},null,8,$l)]))),128))])):M("",!0),g.subs&&g.subs.length>0?(d(),f("div",Ml,[(d(!0),f(E,null,H(g.subs,(Y,It)=>(d(),f("div",{key:It,class:"sub-item"},[n("div",Ll,"("+v(String.fromCharCode(97+It))+")",1),n("div",{class:"sub-content math-content",innerHTML:Q(Y.stem||Y.sub_stem)},null,8,ql),Y.answer||Y.sub_answer?(d(),f("div",Il,[e[101]||(e[101]=n("strong",null,"答案：",-1)),n("span",{class:"math-content",innerHTML:Q(Y.answer||Y.sub_answer)},null,8,El)])):M("",!0)]))),128))])):M("",!0),n("div",Hl,[e[102]||(e[102]=n("strong",null,"答案：",-1)),n("span",{class:"math-content",innerHTML:Q(g.answer)},null,8,Pl)]),g.analysis?(d(),f("div",Dl,[e[103]||(e[103]=n("strong",null,"解析：",-1)),n("span",{class:"math-content",innerHTML:Q(g.analysis)},null,8,Rl)])):M("",!0)]))),128))])])):M("",!0)]}),_:1},8,["modelValue","fullscreen"]),t(B,{modelValue:fe.value,"onUpdate:modelValue":e[41]||(e[41]=a=>fe.value=a),title:"编辑题目",width:"1000px",top:"3vh",class:"question-edit-dialog"},{footer:l(()=>[t(r,{onClick:e[40]||(e[40]=a=>fe.value=!1)},{default:l(()=>[...e[111]||(e[111]=[p("取消",-1)])]),_:1}),t(r,{type:"primary",onClick:Pa,loading:dt.value},{default:l(()=>[...e[112]||(e[112]=[p("保存",-1)])]),_:1},8,["loading"])]),default:l(()=>[t(O,{model:u.value,"label-width":"100px",class:"question-edit-form"},{default:l(()=>[t(F,{gutter:20},{default:l(()=>[t(C,{span:8},{default:l(()=>[t(b,{label:"题型"},{default:l(()=>[t(m,{modelValue:u.value.exercise_type,"onUpdate:modelValue":e[25]||(e[25]=a=>u.value.exercise_type=a),style:{width:"100%"},onChange:Ua},{default:l(()=>[t(i,{label:"单选题",value:1}),t(i,{label:"多选题",value:2}),t(i,{label:"填空题",value:3}),t(i,{label:"解答题",value:4}),t(i,{label:"判断题",value:5})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(C,{span:8},{default:l(()=>[t(b,{label:"难度"},{default:l(()=>[t(Fa,{modelValue:u.value.level,"onUpdate:modelValue":e[26]||(e[26]=a=>u.value.level=a),max:5},null,8,["modelValue"])]),_:1})]),_:1}),t(C,{span:8},{default:l(()=>[t(b,{label:"分值"},{default:l(()=>[t(D,{modelValue:u.value.total_score,"onUpdate:modelValue":e[27]||(e[27]=a=>u.value.total_score=a),min:0,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(F,{gutter:20},{default:l(()=>[t(C,{span:6},{default:l(()=>[t(b,{label:"所属科目"},{default:l(()=>[t(m,{modelValue:u.value.major_id,"onUpdate:modelValue":e[28]||(e[28]=a=>u.value.major_id=a),style:{width:"100%"},placeholder:"请选择科目",onChange:za,loading:lt.value},{default:l(()=>[(d(!0),f(E,null,H(_e.value,a=>(d(),S(i,{key:a.major_id||a.id,label:a.subject_name||a.name,value:String(a.major_id||a.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1}),t(C,{span:12},{default:l(()=>[t(b,{label:"所属章节"},{default:l(()=>[n("div",Fl,[t(m,{modelValue:u.value.chapter_id,"onUpdate:modelValue":e[29]||(e[29]=a=>u.value.chapter_id=a),style:{flex:"1","min-width":"200px"},placeholder:"请选择章节",loading:st.value},{default:l(()=>[(d(!0),f(E,null,H(te.value,a=>(d(),S(i,{key:a.chapter_id||a.id,label:ka(a),value:String(a.chapter_id||a.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])])]),_:1})]),_:1}),t(C,{span:6},{default:l(()=>[t(b,{label:"题号"},{default:l(()=>[t(D,{modelValue:u.value.exercise_number,"onUpdate:modelValue":e[30]||(e[30]=a=>u.value.exercise_number=a),min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(F,{gutter:20},{default:l(()=>[t(C,{span:8},{default:l(()=>[t(b,{label:"考试年份"},{default:l(()=>[t(o,{modelValue:u.value.exam_time,"onUpdate:modelValue":e[31]||(e[31]=a=>u.value.exam_time=a),placeholder:"如：2025年"},null,8,["modelValue"])]),_:1})]),_:1}),t(C,{span:8},{default:l(()=>[t(b,{label:"学校/来源"},{default:l(()=>[t(o,{modelValue:u.value.from_school,"onUpdate:modelValue":e[32]||(e[32]=a=>u.value.from_school=a),placeholder:"如：全国统考"},null,8,["modelValue"])]),_:1})]),_:1}),t(C,{span:8},{default:l(()=>[t(b,{label:"科目代码"},{default:l(()=>[t(o,{modelValue:u.value.exam_code,"onUpdate:modelValue":e[33]||(e[33]=a=>u.value.exam_code=a),placeholder:"如：408"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(b,{label:"知识点标签"},{default:l(()=>[n("div",Nl,[(d(!0),f(E,null,H(u.value.knowledgeTags,(a,g)=>(d(),S(h,{key:g,closable:"",onClose:$=>Ma(g),class:"tag-item"},{default:l(()=>[p(v(a.tag_name||a),1)]),_:2},1032,["onClose"]))),128)),t(Na,null,{default:l(()=>[t(r,{type:"primary",link:"",size:"small",onClick:La},{default:l(()=>[t(A,null,{default:l(()=>[t(K(mt))]),_:1}),e[104]||(e[104]=p(" 从考点选择 ",-1))]),_:1}),t(r,{type:"success",link:"",size:"small",onClick:Ha},{default:l(()=>[t(A,null,{default:l(()=>[t(K(ct))]),_:1}),e[105]||(e[105]=p(" 输入添加 ",-1))]),_:1})]),_:1})])]),_:1}),t(b,{label:"题干",class:"form-item-stem"},{default:l(()=>[n("div",Ql,[t(pe,{modelValue:u.value.stem,"onUpdate:modelValue":e[34]||(e[34]=a=>u.value.stem=a),placeholder:"请输入题干",height:120},null,8,["modelValue"])])]),_:1}),u.value.exercise_type===1||u.value.exercise_type===2||u.value.exercise_type===5?(d(),S(b,{key:0,label:"选项",class:"form-item-options"},{default:l(()=>[n("div",Al,[(d(!0),f(E,null,H(u.value.options,(a,g)=>(d(),f("div",{key:g,class:"option-edit-row"},[t(o,{modelValue:a.option_key,"onUpdate:modelValue":$=>a.option_key=$,style:{width:"50px"},placeholder:"选项",size:"small"},null,8,["modelValue","onUpdate:modelValue"]),n("div",Ol,[t(pe,{modelValue:a.option_value,"onUpdate:modelValue":$=>a.option_value=$,placeholder:"选项内容",height:80},null,8,["modelValue","onUpdate:modelValue"])]),t(r,{type:"danger",size:"small",onClick:$=>Sa(g)},{default:l(()=>[...e[106]||(e[106]=[p("删除",-1)])]),_:1},8,["onClick"])]))),128))]),t(r,{type:"primary",size:"small",onClick:Ta,class:"add-option-btn"},{default:l(()=>[t(A,null,{default:l(()=>[t(K(ct))]),_:1}),e[107]||(e[107]=p(" 添加选项 ",-1))]),_:1})]),_:1})):M("",!0),u.value.exercise_type===4?(d(),S(b,{key:1,label:"小题列表"},{default:l(()=>[n("div",Bl,[(d(!0),f(E,null,H(u.value.subs,(a,g)=>(d(),f("div",{key:g,class:"sub-item-editor"},[n("div",Kl,[n("span",Yl,"小题 "+v(g+1),1),t(o,{modelValue:a.score,"onUpdate:modelValue":$=>a.score=$,placeholder:"分值",style:{width:"80px"},size:"small"},{append:l(()=>[...e[108]||(e[108]=[p("分",-1)])]),_:1},8,["modelValue","onUpdate:modelValue"]),t(r,{type:"danger",size:"small",onClick:$=>$a(g)},{default:l(()=>[...e[109]||(e[109]=[p("删除",-1)])]),_:1},8,["onClick"])]),n("div",Jl,[t(b,{label:"小题题干"},{default:l(()=>[t(pe,{modelValue:a.stem,"onUpdate:modelValue":$=>a.stem=$,placeholder:"请输入小题题干",height:80},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(b,{label:"小题答案"},{default:l(()=>[t(pe,{modelValue:a.answer,"onUpdate:modelValue":$=>a.answer=$,placeholder:"请输入小题答案",height:80},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(b,{label:"小题解析"},{default:l(()=>[t(pe,{modelValue:a.analysis,"onUpdate:modelValue":$=>a.analysis=$,placeholder:"请输入小题解析",height:80},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]))),128))]),t(r,{type:"primary",size:"small",onClick:ja,class:"mt-10"},{default:l(()=>[t(A,null,{default:l(()=>[t(K(ct))]),_:1}),e[110]||(e[110]=p(" 添加小题 ",-1))]),_:1})]),_:1})):M("",!0),t(b,{label:"答案",class:"form-item-answer"},{default:l(()=>[n("div",Wl,[t(pe,{modelValue:u.value.answer,"onUpdate:modelValue":e[35]||(e[35]=a=>u.value.answer=a),placeholder:"请输入答案",height:100},null,8,["modelValue"])])]),_:1}),t(b,{label:"解析",class:"form-item-analysis"},{default:l(()=>[n("div",Gl,[t(pe,{modelValue:u.value.analysis,"onUpdate:modelValue":e[36]||(e[36]=a=>u.value.analysis=a),placeholder:"请输入解析",height:120},null,8,["modelValue"])])]),_:1}),t(b,{label:"试卷分值",class:"form-item-score"},{default:l(()=>[t(D,{modelValue:u.value.paper_score,"onUpdate:modelValue":e[37]||(e[37]=a=>u.value.paper_score=a),min:0,max:100},null,8,["modelValue"])]),_:1}),t(b,{label:"考试全称"},{default:l(()=>[t(o,{modelValue:u.value.exam_full_name,"onUpdate:modelValue":e[38]||(e[38]=a=>u.value.exam_full_name=a),placeholder:"如：计算机学科基础综合"},null,8,["modelValue"])]),_:1}),t(b,{label:"视频URL"},{default:l(()=>[t(o,{modelValue:u.value.video_url,"onUpdate:modelValue":e[39]||(e[39]=a=>u.value.video_url=a),placeholder:"请输入视频链接（如有）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:ve.value,"onUpdate:modelValue":e[46]||(e[46]=a=>ve.value=a),title:"选择考点",width:"600px","close-on-click-modal":!1},{footer:l(()=>[t(r,{onClick:e[45]||(e[45]=a=>ve.value=!1)},{default:l(()=>[...e[113]||(e[113]=[p("取消",-1)])]),_:1}),t(r,{type:"primary",onClick:Ea,disabled:!P.value.tag_id},{default:l(()=>[...e[114]||(e[114]=[p("确定",-1)])]),_:1},8,["disabled"])]),default:l(()=>[t(O,{"label-width":"80px"},{default:l(()=>[t(b,{label:"选择科目"},{default:l(()=>[t(m,{modelValue:P.value.major_id,"onUpdate:modelValue":e[42]||(e[42]=a=>P.value.major_id=a),placeholder:"请选择科目",clearable:"",style:{width:"100%"},onChange:qa},{default:l(()=>[(d(!0),f(E,null,H(_e.value,a=>(d(),S(i,{key:a.id,label:a.name,value:String(a.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"选择章节"},{default:l(()=>[t(m,{modelValue:P.value.chapter_id,"onUpdate:modelValue":e[43]||(e[43]=a=>P.value.chapter_id=a),placeholder:"请选择章节",clearable:"",style:{width:"100%"},onChange:Ia,disabled:!P.value.major_id},{default:l(()=>[(d(!0),f(E,null,H(ge.value,a=>(d(),S(i,{key:a.id,label:a.name,value:String(a.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(b,{label:"选择考点"},{default:l(()=>[t(m,{modelValue:P.value.tag_id,"onUpdate:modelValue":e[44]||(e[44]=a=>P.value.tag_id=a),placeholder:"请选择考点",clearable:"",style:{width:"100%"},disabled:!P.value.chapter_id,filterable:""},{default:l(()=>[(d(!0),f(E,null,H(ne.value,a=>(d(),S(i,{key:a.tag_id,label:a.tag_name,value:String(a.tag_id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(B,{modelValue:ce.value,"onUpdate:modelValue":e[61]||(e[61]=a=>ce.value=a),title:je.value?"编辑考试":"创建在线考试",width:"800px","destroy-on-close":""},{footer:l(()=>[t(r,{onClick:e[60]||(e[60]=a=>ce.value=!1)},{default:l(()=>[...e[122]||(e[122]=[p("取消",-1)])]),_:1}),t(r,{type:"primary",loading:Oe.value,onClick:At},{default:l(()=>[...e[123]||(e[123]=[p("确定",-1)])]),_:1},8,["loading"])]),default:l(()=>[t(O,{model:_,rules:Ht,ref_key:"examFormRef",ref:Be,"label-width":"120px"},{default:l(()=>[t(F,{gutter:20},{default:l(()=>[t(C,{span:24},{default:l(()=>[t(b,{label:"考试名称",prop:"title"},{default:l(()=>[t(o,{modelValue:_.title,"onUpdate:modelValue":e[47]||(e[47]=a=>_.title=a),placeholder:"请输入考试名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(F,{gutter:20},{default:l(()=>[t(C,{span:24},{default:l(()=>[t(b,{label:"考试描述"},{default:l(()=>[t(o,{modelValue:_.description,"onUpdate:modelValue":e[48]||(e[48]=a=>_.description=a),type:"textarea",rows:2,placeholder:"请输入考试描述"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(F,{gutter:20},{default:l(()=>[t(C,{span:12},{default:l(()=>[t(b,{label:"试卷类型",prop:"paperType"},{default:l(()=>[t(m,{modelValue:_.paperType,"onUpdate:modelValue":e[49]||(e[49]=a=>_.paperType=a),placeholder:"选择试卷类型",style:{width:"100%"},onChange:Dt},{default:l(()=>[t(i,{label:"真题卷",value:1}),t(i,{label:"模拟题卷",value:2}),t(i,{label:"组卷（从题库抽题）",value:3})]),_:1},8,["modelValue"])]),_:1})]),_:1}),_.paperType===1||_.paperType===2?(d(),S(C,{key:0,span:12},{default:l(()=>[t(b,{label:"来源试卷",prop:"sourcePaperId"},{default:l(()=>[t(m,{modelValue:_.sourcePaperId,"onUpdate:modelValue":e[50]||(e[50]=a=>_.sourcePaperId=a),placeholder:"选择来源试卷",style:{width:"100%"},filterable:"",loading:Ae.value,onFocus:Pt,onChange:Rt},{default:l(()=>[(d(!0),f(E,null,H(Qe.value,a=>(d(),S(i,{key:a.id,label:`${a.year||""} ${a.from_school||""} ${a.name||a.exam_full_name||a.paper_name||a.title||"未命名试卷"}`,value:String(a.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1})):M("",!0)]),_:1}),_.paperType===3?(d(),S(F,{key:0,gutter:20},{default:l(()=>[t(C,{span:24},{default:l(()=>[t(b,{label:"选择题目",prop:"questionIds"},{default:l(()=>[n("div",Xl,[t(o,{modelValue:xt.value,"onUpdate:modelValue":e[51]||(e[51]=a=>xt.value=a),placeholder:"搜索题目...",style:{width:"300px"},onKeyup:Pe(Tt,["enter"])},{append:l(()=>[t(r,{onClick:Tt},{default:l(()=>[t(A,null,{default:l(()=>[t(K(mt))]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(r,{type:"primary",class:"ml-10",onClick:Kt},{default:l(()=>[...e[115]||(e[115]=[p("选择题目",-1)])]),_:1}),n("span",Zl,"已选择 "+v(_.questionIds.length)+" 题",1)]),ae.value.length>0?(d(),f("div",es,[t(V,{data:ae.value,size:"small",border:"","max-height":"300"},{default:l(()=>[t(c,{type:"index",label:"序号",width:"60",align:"center"}),t(c,{prop:"exercise_type_name",label:"题型",width:"100"}),t(c,{prop:"stem",label:"题干","show-overflow-tooltip":""},{default:l(({row:a})=>[n("div",{innerHTML:qe(a.stem)},null,8,ts)]),_:1}),t(c,{label:"分值",width:"120",align:"center"},{default:l(({row:a,$index:g})=>[t(D,{modelValue:a.score,"onUpdate:modelValue":$=>a.score=$,min:0,max:100,precision:1,size:"small",style:{width:"90px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(c,{label:"操作",width:"80",align:"center",fixed:"right"},{default:l(({$index:a})=>[t(r,{size:"small",type:"danger",link:"",onClick:g=>Wt(a)},{default:l(()=>[...e[116]||(e[116]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),n("div",as," 总分："+v(Gt())+" 分 ",1)])):M("",!0)]),_:1})]),_:1})]),_:1})):M("",!0),t(F,{gutter:20},{default:l(()=>[t(C,{span:12},{default:l(()=>[t(b,{label:"开始时间",prop:"startTime"},{default:l(()=>[t(Lt,{modelValue:_.startTime,"onUpdate:modelValue":e[52]||(e[52]=a=>_.startTime=a),type:"datetime",placeholder:"选择开始时间",style:{width:"100%"},"value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1}),t(C,{span:12},{default:l(()=>[t(b,{label:"结束时间",prop:"endTime"},{default:l(()=>[t(Lt,{modelValue:_.endTime,"onUpdate:modelValue":e[53]||(e[53]=a=>_.endTime=a),type:"datetime",placeholder:"选择结束时间",style:{width:"100%"},"value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(F,{gutter:20},{default:l(()=>[t(C,{span:12},{default:l(()=>[t(b,{label:"考试时长",prop:"duration"},{default:l(()=>[t(D,{modelValue:_.duration,"onUpdate:modelValue":e[54]||(e[54]=a=>_.duration=a),min:1,max:300,style:{width:"100%"}},{append:l(()=>[...e[117]||(e[117]=[p("分钟",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(C,{span:12},{default:l(()=>[t(b,{label:"及格分数",prop:"passScore"},{default:l(()=>[t(D,{modelValue:_.passScore,"onUpdate:modelValue":e[55]||(e[55]=a=>_.passScore=a),min:0,max:_.totalScore||100,precision:1,style:{width:"100%"}},{append:l(()=>[...e[118]||(e[118]=[p("分",-1)])]),_:1},8,["modelValue","max"])]),_:1})]),_:1})]),_:1}),t(F,{gutter:20},{default:l(()=>[t(C,{span:12},{default:l(()=>[t(b,{label:"总分",prop:"totalScore"},{default:l(()=>[t(D,{modelValue:_.totalScore,"onUpdate:modelValue":e[56]||(e[56]=a=>_.totalScore=a),min:1,max:1e3,precision:1,style:{width:"100%"}},{append:l(()=>[...e[119]||(e[119]=[p("分",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(C,{span:12},{default:l(()=>[t(b,{label:"是否限时"},{default:l(()=>[t(pt,{modelValue:_.isLimitedTime,"onUpdate:modelValue":e[57]||(e[57]=a=>_.isLimitedTime=a),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(F,{gutter:20},{default:l(()=>[t(C,{span:12},{default:l(()=>[t(b,{label:"立即显示结果"},{default:l(()=>[t(pt,{modelValue:_.showResultImmediately,"onUpdate:modelValue":e[58]||(e[58]=a=>_.showResultImmediately=a),"active-value":1,"inactive-value":0},null,8,["modelValue"]),e[120]||(e[120]=n("div",{class:"form-tip"},"交卷后立即显示成绩",-1))]),_:1})]),_:1}),t(C,{span:12},{default:l(()=>[t(b,{label:"允许查看解析"},{default:l(()=>[t(pt,{modelValue:_.allowReview,"onUpdate:modelValue":e[59]||(e[59]=a=>_.allowReview=a),"active-value":1,"inactive-value":0},null,8,["modelValue"]),e[121]||(e[121]=n("div",{class:"form-tip"},"考试结束后允许查看答案解析",-1))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(B,{modelValue:$e.value,"onUpdate:modelValue":e[67]||(e[67]=a=>$e.value=a),title:"选择题目",width:"900px","destroy-on-close":""},{default:l(()=>[n("div",ls,[n("div",ss,[t(F,{gutter:10},{default:l(()=>[t(C,{span:8},{default:l(()=>[t(o,{modelValue:I.keyword,"onUpdate:modelValue":e[62]||(e[62]=a=>I.keyword=a),placeholder:"搜索题目内容...",clearable:"",onKeyup:Pe(ie,["enter"])},{append:l(()=>[t(r,{onClick:ie},{default:l(()=>[t(A,null,{default:l(()=>[t(K(mt))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(C,{span:6},{default:l(()=>[t(m,{modelValue:I.type,"onUpdate:modelValue":e[63]||(e[63]=a=>I.type=a),placeholder:"题型",clearable:"",onChange:ie,style:{width:"100%"}},{default:l(()=>[t(i,{label:"单选题",value:"单选题"}),t(i,{label:"多选题",value:"多选题"}),t(i,{label:"填空题",value:"填空题"}),t(i,{label:"解答题",value:"解答题"}),t(i,{label:"判断题",value:"判断题"})]),_:1},8,["modelValue"])]),_:1}),t(C,{span:6},{default:l(()=>[t(m,{modelValue:I.chapterId,"onUpdate:modelValue":e[64]||(e[64]=a=>I.chapterId=a),placeholder:"章节",clearable:"",onChange:ie,style:{width:"100%"}},{default:l(()=>[(d(!0),f(E,null,H(s.chapters,a=>(d(),S(i,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(C,{span:4},{default:l(()=>[t(r,{type:"primary",onClick:Jt},{default:l(()=>[...e[124]||(e[124]=[p("确认选择",-1)])]),_:1})]),_:1})]),_:1})]),De((d(),S(V,{data:ht.value,border:"",stripe:"",onSelectionChange:Yt,height:"400"},{default:l(()=>[t(c,{type:"selection",width:"55",align:"center"}),t(c,{prop:"question_id",label:"ID",width:"150"}),t(c,{prop:"exercise_type_name",label:"题型",width:"100",align:"center"}),t(c,{prop:"stem",label:"题干","min-width":"300","show-overflow-tooltip":""},{default:l(({row:a})=>[n("div",{innerHTML:qe(a.stem)},null,8,os)]),_:1}),t(c,{prop:"chapter_name",label:"章节",width:"150"})]),_:1},8,["data"])),[[Ee,Ke.value]]),n("div",ns,[t(N,{"current-page":I.page,"onUpdate:currentPage":e[65]||(e[65]=a=>I.page=a),"page-size":I.pageSize,"onUpdate:pageSize":e[66]||(e[66]=a=>I.pageSize=a),total:bt.value,layout:"total, prev, pager, next",onCurrentChange:ie},null,8,["current-page","page-size","total"])])])]),_:1},8,["modelValue"])]),_:1}),t(ke,{label:"在线考试管理",name:"online-exams"},{default:l(()=>[n("div",rs,[t(r,{type:"primary",onClick:Ft},{default:l(()=>[...e[126]||(e[126]=[p("+ 创建在线考试",-1)])]),_:1}),t(r,{class:"ml-10",onClick:re},{default:l(()=>[...e[127]||(e[127]=[p("刷新",-1)])]),_:1}),t(ue,{modelValue:X.status,"onUpdate:modelValue":e[68]||(e[68]=a=>X.status=a),onChange:re,class:"ml-20"},{default:l(()=>[t(R,{label:""},{default:l(()=>[...e[128]||(e[128]=[p("全部",-1)])]),_:1}),t(R,{label:"ongoing"},{default:l(()=>[...e[129]||(e[129]=[p("进行中",-1)])]),_:1}),t(R,{label:"upcoming"},{default:l(()=>[...e[130]||(e[130]=[p("即将开始",-1)])]),_:1}),t(R,{label:"completed"},{default:l(()=>[...e[131]||(e[131]=[p("已结束",-1)])]),_:1})]),_:1},8,["modelValue"])]),De((d(),S(V,{data:gt.value,border:"",stripe:""},{default:l(()=>[t(c,{prop:"id",label:"ID",width:"80",align:"center"}),t(c,{prop:"title",label:"考试名称","min-width":"200","show-overflow-tooltip":""}),t(c,{prop:"paper_type_name",label:"试卷类型",width:"100",align:"center"},{default:l(({row:a})=>[t(h,{type:zt(a.paper_type)},{default:l(()=>[p(v(a.paper_type_name),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"start_time",label:"开始时间",width:"160",align:"center"},{default:l(({row:a})=>[p(v(we(a.start_time)),1)]),_:1}),t(c,{prop:"end_time",label:"结束时间",width:"160",align:"center"},{default:l(({row:a})=>[p(v(we(a.end_time)),1)]),_:1}),t(c,{prop:"duration",label:"时长",width:"80",align:"center"},{default:l(({row:a})=>[p(v(a.duration)+"分钟 ",1)]),_:1}),t(c,{prop:"participant_count",label:"参与人数",width:"100",align:"center"}),t(c,{label:"发布状态",width:"100",align:"center"},{default:l(({row:a})=>[t(h,{type:a.is_published?"success":"info"},{default:l(()=>[p(v(a.is_published?"已发布":"未发布"),1)]),_:2},1032,["type"])]),_:1}),t(c,{label:"考试状态",width:"100",align:"center"},{default:l(({row:a})=>[t(h,{type:pa(a.examStatus)},{default:l(()=>[p(v(ma(a.examStatus)),1)]),_:2},1032,["type"])]),_:1}),t(c,{label:"操作",width:"320",align:"center",fixed:"right"},{default:l(({row:a})=>[t(r,{size:"small",type:"primary",onClick:g=>Xt(a)},{default:l(()=>[...e[132]||(e[132]=[p("详情/统计",-1)])]),_:1},8,["onClick"]),t(r,{size:"small",onClick:g=>Nt(a)},{default:l(()=>[...e[133]||(e[133]=[p("编辑",-1)])]),_:1},8,["onClick"]),t(r,{size:"small",type:a.is_published?"warning":"success",onClick:g=>Bt(a)},{default:l(()=>[p(v(a.is_published?"取消发布":"发布"),1)]),_:2},1032,["type","onClick"]),t(r,{size:"small",type:"danger",onClick:g=>Ot(a.id)},{default:l(()=>[...e[134]||(e[134]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ee,Ne.value]]),n("div",is,[t(N,{"current-page":X.page,"onUpdate:currentPage":e[69]||(e[69]=a=>X.page=a),"page-size":X.pageSize,"onUpdate:pageSize":e[70]||(e[70]=a=>X.pageSize=a),total:yt.value,layout:"total, prev, pager, next",onCurrentChange:re},null,8,["current-page","page-size","total"])]),t(B,{modelValue:Ye.value,"onUpdate:modelValue":e[80]||(e[80]=a=>Ye.value=a),title:"考试详情/统计",width:"1200px","destroy-on-close":"",class:"statistics-dialog"},{default:l(()=>[q.value?(d(),S(qt,{key:0,modelValue:Je.value,"onUpdate:modelValue":e[79]||(e[79]=a=>Je.value=a),onTabChange:sa},{default:l(()=>[t(ke,{label:"统计分析",name:"statistics"},{default:l(()=>[q.value?(d(),f("div",us,[t(de,{column:2,border:""},{default:l(()=>[t(T,{label:"考试名称"},{default:l(()=>[p(v(q.value.title),1)]),_:1}),t(T,{label:"试卷类型"},{default:l(()=>[t(h,{type:zt(q.value.paper_type)},{default:l(()=>[p(v(q.value.paper_type_name),1)]),_:1},8,["type"])]),_:1}),t(T,{label:"开始时间"},{default:l(()=>[p(v(we(q.value.start_time)),1)]),_:1}),t(T,{label:"结束时间"},{default:l(()=>[p(v(we(q.value.end_time)),1)]),_:1}),t(T,{label:"考试时长"},{default:l(()=>[p(v(q.value.duration)+" 分钟",1)]),_:1}),t(T,{label:"总分"},{default:l(()=>[p(v(q.value.total_score)+" 分",1)]),_:1}),t(T,{label:"及格分数"},{default:l(()=>[p(v(q.value.pass_score)+" 分",1)]),_:1}),t(T,{label:"参与人数"},{default:l(()=>[p(v(q.value.participant_count||0)+" 人",1)]),_:1})]),_:1})])):M("",!0),U.value?(d(),f("div",ds,[t(F,{gutter:20,class:"statistics-overview"},{default:l(()=>[t(C,{span:4},{default:l(()=>[n("div",ps,[n("div",ms,[t(A,null,{default:l(()=>[t(K(Ga))]),_:1})]),n("div",cs,[n("div",_s,v(U.value.total_participants||0),1),e[135]||(e[135]=n("div",{class:"stat-label"},"参与人数",-1))])])]),_:1}),t(C,{span:4},{default:l(()=>[n("div",vs,[n("div",fs,[t(A,null,{default:l(()=>[t(K(Xa))]),_:1})]),n("div",gs,[n("div",ys,v(U.value.graded_count||0),1),e[136]||(e[136]=n("div",{class:"stat-label"},"已阅卷",-1))])])]),_:1}),t(C,{span:4},{default:l(()=>[n("div",hs,[n("div",bs,[t(A,null,{default:l(()=>[t(K(Za))]),_:1})]),n("div",ws,[n("div",xs,v(U.value.average_score?Number(U.value.average_score).toFixed(1):0),1),e[137]||(e[137]=n("div",{class:"stat-label"},"平均分",-1))])])]),_:1}),t(C,{span:4},{default:l(()=>[n("div",Vs,[n("div",ks,[t(A,null,{default:l(()=>[t(K(el))]),_:1})]),n("div",Cs,[n("div",Ts,v(U.value.highest_score||0),1),e[138]||(e[138]=n("div",{class:"stat-label"},"最高分",-1))])])]),_:1}),t(C,{span:4},{default:l(()=>[n("div",Ss,[n("div",zs,[t(A,null,{default:l(()=>[t(K(tl))]),_:1})]),n("div",Us,[n("div",js,v(U.value.lowest_score||0),1),e[139]||(e[139]=n("div",{class:"stat-label"},"最低分",-1))])])]),_:1}),t(C,{span:4},{default:l(()=>[n("div",{class:al(["stat-card",U.value.pass_rate>=60?"success":"danger"])},[n("div",$s,[t(A,null,{default:l(()=>[t(K(ll))]),_:1})]),n("div",Ms,[n("div",Ls,v(U.value.pass_rate?Number(U.value.pass_rate).toFixed(1):0)+"%",1),e[140]||(e[140]=n("div",{class:"stat-label"},"及格率",-1))])],2)]),_:1})]),_:1}),t(F,{gutter:20,class:"mt-20"},{default:l(()=>[t(C,{span:12},{default:l(()=>[t(oe,{shadow:"never"},{header:l(()=>[n("div",qs,[e[141]||(e[141]=n("span",null,"分数段分布",-1)),t(h,{size:"small",type:"info"},{default:l(()=>[p("共 "+v(U.value.total_participants||0)+" 人",1)]),_:1})])]),default:l(()=>[n("div",{ref_key:"scoreChartRef",ref:Xe,style:{height:"300px"}},null,512)]),_:1})]),_:1}),t(C,{span:12},{default:l(()=>[t(oe,{shadow:"never"},{header:l(()=>[...e[142]||(e[142]=[n("div",{class:"card-header"},[n("span",null,"题型分布")],-1)])]),default:l(()=>[n("div",{ref_key:"questionTypeChartRef",ref:Ze,style:{height:"300px"}},null,512)]),_:1})]),_:1})]),_:1}),t(F,{gutter:20,class:"mt-20"},{default:l(()=>[t(C,{span:12},{default:l(()=>[t(oe,{shadow:"never"},{header:l(()=>[...e[143]||(e[143]=[n("div",{class:"card-header"},[n("span",null,"及格情况分布")],-1)])]),default:l(()=>[n("div",{ref_key:"passChartRef",ref:et,style:{height:"300px"}},null,512)]),_:1})]),_:1}),U.value.score_trend&&U.value.score_trend.length>0?(d(),S(C,{key:0,span:12},{default:l(()=>[t(oe,{shadow:"never"},{header:l(()=>[...e[144]||(e[144]=[n("div",{class:"card-header"},[n("span",null,"分数趋势")],-1)])]),default:l(()=>[n("div",{ref_key:"trendChartRef",ref:tt,style:{height:"300px"}},null,512)]),_:1})]),_:1})):M("",!0)]),_:1}),t(oe,{class:"mt-20",shadow:"never"},{header:l(()=>[...e[145]||(e[145]=[n("div",{class:"card-header"},[n("span",null,"题型得分统计")],-1)])]),default:l(()=>[t(V,{data:U.value.question_type_stats||[],border:"",stripe:""},{default:l(()=>[t(c,{prop:"type_name",label:"题型",width:"120"}),t(c,{prop:"question_count",label:"题目数量",width:"100",align:"center"}),t(c,{prop:"total_score",label:"总分值",width:"100",align:"center"}),t(c,{prop:"average_score",label:"平均得分",width:"100",align:"center"},{default:l(({row:a})=>[p(v(a.average_score?Number(a.average_score).toFixed(2):0),1)]),_:1}),t(c,{prop:"correct_rate",label:"平均正确率",width:"100",align:"center"},{default:l(({row:a})=>[t(h,{type:a.correct_rate>=60?"success":a.correct_rate>=40?"warning":"danger",size:"small"},{default:l(()=>[p(v(a.correct_rate?Number(a.correct_rate).toFixed(1):0)+"% ",1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])]),_:1}),t(oe,{class:"mt-20",shadow:"never"},{header:l(()=>[n("div",Is,[n("div",null,[e[147]||(e[147]=n("span",null,"各题型错误率最高题目",-1)),t(h,{size:"small",type:"danger",class:"ml-10"},{default:l(()=>[...e[146]||(e[146]=[p("需重点关注",-1)])]),_:1})]),n("div",Es,[e[148]||(e[148]=n("span",{style:{"font-size":"12px",color:"#666"}},"每题型显示数量:",-1)),t(D,{modelValue:We.value,"onUpdate:modelValue":e[71]||(e[71]=a=>We.value=a),min:1,max:20,size:"small",style:{width:"100px"}},null,8,["modelValue"])])])]),default:l(()=>[t(V,{data:ua.value,border:"",stripe:"","max-height":"400"},{default:l(()=>[t(c,{label:"题号",width:"80",align:"center"},{default:l(({row:a})=>[t(h,{type:"info",size:"small"},{default:l(()=>[p(v(a.sort_order||"-"),1)]),_:2},1024)]),_:1}),t(c,{label:"题型",width:"100"},{default:l(({row:a})=>[parseInt(a.exercise_type)===1?(d(),f("span",Hs,"单选题")):parseInt(a.exercise_type)===2?(d(),f("span",Ps,"多选题")):parseInt(a.exercise_type)===3?(d(),f("span",Ds,"判断题")):parseInt(a.exercise_type)===4?(d(),f("span",Rs,"解答题")):(d(),f("span",Fs,v(a.exercise_type_name||a.question_type||"-"),1))]),_:1}),t(c,{prop:"stem",label:"题干","min-width":"250","show-overflow-tooltip":""},{default:l(({row:a})=>[n("div",{innerHTML:qe(a.stem)},null,8,Ns)]),_:1}),t(c,{label:"考点/知识点","min-width":"180","show-overflow-tooltip":""},{default:l(({row:a})=>[Array.isArray(a.knowledge_points)&&W(a.knowledge_points).length>0?(d(),f("div",Qs,[(d(!0),f(E,null,H(W(a.knowledge_points).slice(0,3),(g,$)=>(d(),S(h,{key:$,size:"small",class:"mr-5",type:"info"},{default:l(()=>[p(v(g),1)]),_:2},1024))),128)),W(a.knowledge_points).length>3?(d(),S(h,{key:0,size:"small",type:"info"},{default:l(()=>[p("+"+v(W(a.knowledge_points).length-3),1)]),_:2},1024)):M("",!0)])):(d(),f("span",As,"-"))]),_:1}),t(c,{prop:"question_score",label:"分值",width:"80",align:"center"}),t(c,{prop:"total_attempts",label:"答题次数",width:"100",align:"center"}),t(c,{label:"错误率",width:"100",align:"center"},{default:l(({row:a})=>[t(h,{type:"danger",size:"small"},{default:l(()=>[p(v((100-parseFloat(a.correct_rate||0)).toFixed(1))+"% ",1)]),_:2},1024)]),_:1}),t(c,{prop:"wrong_count",label:"错误人数",width:"100",align:"center"})]),_:1},8,["data"])]),_:1}),t(oe,{class:"mt-20",shadow:"never"},{header:l(()=>[...e[149]||(e[149]=[n("div",{class:"card-header"},[n("span",null,"每题作答分析")],-1)])]),default:l(()=>[t(V,{data:Me.value,border:"",stripe:"","max-height":"500"},{default:l(()=>[t(c,{label:"题号",width:"60",align:"center"},{default:l(({row:a})=>[t(h,{type:"info",size:"small"},{default:l(()=>[p(v(a.sort_order||"-"),1)]),_:2},1024)]),_:1}),t(c,{label:"题型",width:"100"},{default:l(({row:a})=>[a.exercise_type==1?(d(),f("span",Os,"单选题")):a.exercise_type==2?(d(),f("span",Bs,"多选题")):a.exercise_type==3?(d(),f("span",Ks,"判断题")):a.exercise_type==4?(d(),f("span",Ys,"解答题")):(d(),f("span",Js,v(a.exercise_type_name||"-"),1))]),_:1}),t(c,{prop:"stem",label:"题干","min-width":"250","show-overflow-tooltip":""},{default:l(({row:a})=>[n("div",{innerHTML:qe(a.stem)},null,8,Ws)]),_:1}),t(c,{label:"考点/知识点","min-width":"150","show-overflow-tooltip":""},{default:l(({row:a})=>[Array.isArray(a.knowledge_points)&&W(a.knowledge_points).length>0?(d(),f("div",Gs,[(d(!0),f(E,null,H(W(a.knowledge_points).slice(0,2),(g,$)=>(d(),S(h,{key:$,size:"small",class:"mr-5",type:"info"},{default:l(()=>[p(v(g),1)]),_:2},1024))),128)),W(a.knowledge_points).length>2?(d(),S(h,{key:0,size:"small",type:"info"},{default:l(()=>[p("+"+v(W(a.knowledge_points).length-2),1)]),_:2},1024)):M("",!0)])):(d(),f("span",Xs,"-"))]),_:1}),t(c,{prop:"question_score",label:"分值",width:"80",align:"center"}),t(c,{label:"正确率",width:"100",align:"center"},{default:l(({row:a})=>[t(h,{type:parseFloat(a.correct_rate||0)>=60?"success":"danger",size:"small"},{default:l(()=>[p(v(a.correct_rate||0)+"% ",1)]),_:2},1032,["type"])]),_:1}),t(c,{label:"操作",width:"100",align:"center",fixed:"right"},{default:l(({row:a})=>[t(r,{size:"small",type:"primary",link:"",onClick:g=>ta(a)},{default:l(()=>[...e[150]||(e[150]=[p("查看详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])):M("",!0)]),_:1}),t(ke,{label:"考试记录",name:"records"},{default:l(()=>[n("div",Zs,[t(o,{modelValue:Z.value.keyword,"onUpdate:modelValue":e[72]||(e[72]=a=>Z.value.keyword=a),placeholder:"搜索考生姓名/学号",style:{width:"300px"},clearable:"",onKeyup:e[73]||(e[73]=Pe(()=>be(q.value.id),["enter"]))},null,8,["modelValue"]),t(r,{type:"primary",class:"ml-10",onClick:e[74]||(e[74]=()=>be(q.value.id))},{default:l(()=>[...e[151]||(e[151]=[p("搜索",-1)])]),_:1}),t(r,{onClick:e[75]||(e[75]=()=>be(q.value.id))},{default:l(()=>[...e[152]||(e[152]=[p("刷新",-1)])]),_:1})]),De((d(),S(V,{data:Vt.value,border:"",stripe:""},{default:l(()=>[t(c,{prop:"user_name",label:"考生姓名",width:"120"}),t(c,{prop:"user_id",label:"学号",width:"120"}),t(c,{prop:"submit_time",label:"交卷时间",width:"180"},{default:l(({row:a})=>[p(v(a.submit_time?we(a.submit_time):"-"),1)]),_:1}),t(c,{prop:"score",label:"得分",width:"100",align:"center"},{default:l(({row:a})=>[n("span",{style:sl({color:a.score>=q.value.pass_score?"#67c23a":"#f56c6c",fontWeight:"bold"})},v(a.score??"-"),5)]),_:1}),t(c,{prop:"is_graded",label:"批改状态",width:"100",align:"center"},{default:l(({row:a})=>[t(h,{type:a.is_graded?"success":"warning",size:"small"},{default:l(()=>[p(v(a.is_graded?"已批改":"待批改"),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"答题用时",label:"答题用时",width:"120"},{default:l(({row:a})=>[p(v(a.time_spent?`${Math.floor(a.time_spent/60)}分${a.time_spent%60}秒`:"-"),1)]),_:1})]),_:1},8,["data"])),[[Ee,Ge.value]]),n("div",eo,[t(N,{"current-page":Z.value.page,"onUpdate:currentPage":e[76]||(e[76]=a=>Z.value.page=a),"page-size":Z.value.pageSize,"onUpdate:pageSize":e[77]||(e[77]=a=>Z.value.pageSize=a),total:kt.value,layout:"total, prev, pager, next",onCurrentChange:e[78]||(e[78]=()=>be(q.value.id))},null,8,["current-page","page-size","total"])])]),_:1}),t(ke,{label:"解答题批改",name:"grading"},{default:l(()=>[ee.value&&ee.value.length>0?(d(),f("div",to,[t(Qa,{title:`还有 ${ee.value.length} 道解答题待批改`,type:"warning",closable:!1,class:"mb-20"},null,8,["title"]),(d(!0),f(E,null,H(ee.value,(a,g)=>(d(),S(oe,{key:a.answer_id,class:"grading-item mb-20"},{header:l(()=>[n("div",ao,[n("span",null,"第 "+v(g+1)+" 题 / 共 "+v(ee.value.length)+" 题",1),n("span",null,"考生："+v(a.nickname||a.username),1),t(h,{type:"info"},{default:l(()=>[p("满分："+v(a.question_score)+" 分",1)]),_:2},1024)])]),default:l(()=>[n("div",lo,[e[153]||(e[153]=n("h4",null,"题目：",-1)),n("div",{class:"question-stem",innerHTML:a.stem},null,8,so)]),n("div",oo,[e[154]||(e[154]=n("h4",null,"考生答案：",-1)),n("div",{class:"user-answer",innerHTML:a.user_answer||"未作答"},null,8,no)]),a.correct_answer?(d(),f("div",ro,[e[155]||(e[155]=n("h4",null,"参考答案：",-1)),n("div",{class:"reference-answer",innerHTML:a.correct_answer},null,8,io)])):M("",!0),n("div",uo,[t(O,{model:le[a.answer_id],"label-width":"80px"},{default:l(()=>[t(b,{label:"得分"},{default:l(()=>[t(Aa,{modelValue:le[a.answer_id].score,"onUpdate:modelValue":$=>le[a.answer_id].score=$,max:parseFloat(a.question_score),step:.5,"show-stops":"","show-input":""},null,8,["modelValue","onUpdate:modelValue","max"])]),_:2},1024),t(b,{label:"评语"},{default:l(()=>[t(o,{modelValue:le[a.answer_id].comment,"onUpdate:modelValue":$=>le[a.answer_id].comment=$,type:"textarea",rows:2,placeholder:"请输入评语（可选）"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(b,null,{default:l(()=>[t(r,{type:"primary",onClick:$=>Zt(a)},{default:l(()=>[...e[156]||(e[156]=[p("提交评分",-1)])]),_:1},8,["onClick"]),t(r,{onClick:$=>ea(a)},{default:l(()=>[...e[157]||(e[157]=[p("跳过",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1032,["model"])])]),_:2},1024))),128))])):(d(),S(Oa,{key:1,description:"暂无待批改的解答题"}))]),_:1})]),_:1},8,["modelValue"])):M("",!0)]),_:1},8,["modelValue"]),t(B,{modelValue:at.value,"onUpdate:modelValue":e[81]||(e[81]=a=>at.value=a),title:"题目详情",width:"900px","destroy-on-close":""},{default:l(()=>[w.value?(d(),f("div",po,[n("div",mo,[t(de,{column:4,size:"small",border:""},{default:l(()=>[t(T,{label:"题号"},{default:l(()=>[p(v(w.value.sort_order),1)]),_:1}),t(T,{label:"题型"},{default:l(()=>[parseInt(w.value.exercise_type)===1?(d(),f("span",co,"单选题")):parseInt(w.value.exercise_type)===2?(d(),f("span",_o,"多选题")):parseInt(w.value.exercise_type)===3?(d(),f("span",vo,"判断题")):parseInt(w.value.exercise_type)===4?(d(),f("span",fo,"解答题")):(d(),f("span",go,v(w.value.exercise_type_name||"-"),1))]),_:1}),t(T,{label:"分值"},{default:l(()=>[p(v(w.value.question_score)+"分",1)]),_:1}),t(T,{label:"难度"},{default:l(()=>[w.value.difficulty===1?(d(),S(h,{key:0,type:"success",size:"small"},{default:l(()=>[...e[158]||(e[158]=[p("简单",-1)])]),_:1})):w.value.difficulty===2?(d(),S(h,{key:1,type:"warning",size:"small"},{default:l(()=>[...e[159]||(e[159]=[p("中等",-1)])]),_:1})):w.value.difficulty===3?(d(),S(h,{key:2,type:"danger",size:"small"},{default:l(()=>[...e[160]||(e[160]=[p("困难",-1)])]),_:1})):(d(),f("span",yo,"-"))]),_:1})]),_:1})]),n("div",ho,[e[161]||(e[161]=n("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"4px",color:"#303133"}},"题目内容",-1)),n("div",{class:"question-stem",style:{padding:"8px",background:"#f5f7fa","border-radius":"4px","line-height":"1.5"},innerHTML:Q(w.value.stem)},null,8,bo),w.value.options&&w.value.options!=="{}"?(d(),f("div",wo,[(d(!0),f(E,null,H(JSON.parse(w.value.options),(a,g)=>(d(),f("div",{key:g,class:"option-item",style:{padding:"4px 0","line-height":"1.5"}},[n("span",xo,v(g)+".",1),n("span",{class:"option-content",innerHTML:Q(a)},null,8,Vo)]))),128))])):M("",!0)]),n("div",ko,[t(de,{column:2,size:"small",border:""},{default:l(()=>[t(T,{label:"考点/知识点"},{default:l(()=>[w.value.knowledge_points&&W(w.value.knowledge_points).length>0?(d(),f("div",Co,[(d(!0),f(E,null,H(W(w.value.knowledge_points),(a,g)=>(d(),S(h,{key:g,size:"small",class:"mr-5",type:"info",effect:"plain"},{default:l(()=>[p(v(a),1)]),_:2},1024))),128))])):(d(),f("span",To,"-"))]),_:1}),t(T,{label:"正确率"},{default:l(()=>[t(h,{type:parseFloat(w.value.correct_rate)>=60?"success":"danger",size:"small"},{default:l(()=>[p(v(w.value.correct_rate)+"% ",1)]),_:1},8,["type"]),n("span",So," ("+v(w.value.correct_count)+"/"+v(w.value.total_attempts)+") ",1)]),_:1})]),_:1})]),n("div",zo,[t(de,{column:4,size:"small",border:""},{default:l(()=>[t(T,{label:"答题次数"},{default:l(()=>[p(v(w.value.total_attempts),1)]),_:1}),t(T,{label:"正确人数"},{default:l(()=>[p(v(w.value.correct_count),1)]),_:1}),t(T,{label:"错误人数"},{default:l(()=>[p(v(w.value.wrong_count),1)]),_:1}),t(T,{label:"未答人数"},{default:l(()=>[p(v(w.value.unanswered_count),1)]),_:1}),t(T,{label:"平均得分"},{default:l(()=>[p(v(w.value.average_score),1)]),_:1}),t(T,{label:"最高得分"},{default:l(()=>[p(v(w.value.max_score),1)]),_:1}),t(T,{label:"最低得分"},{default:l(()=>[p(v(w.value.min_score),1)]),_:1}),t(T,{label:"方差"},{default:l(()=>[p(v(w.value.variance||"-"),1)]),_:1})]),_:1})]),w.value.option_distribution&&Object.keys(w.value.option_distribution).length>0?(d(),f("div",Uo,[e[162]||(e[162]=n("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"6px",color:"#303133","font-size":"13px"}},"选项分布",-1)),t(V,{data:aa(w.value.option_distribution),border:"",stripe:"",size:"small"},{default:l(()=>[t(c,{prop:"option",label:"选项",width:"60",align:"center"}),t(c,{prop:"count",label:"选择人数",width:"90",align:"center"}),t(c,{label:"占比","min-width":"120"},{default:l(({row:a})=>[t(Ba,{percentage:a.percentage,status:a.percentage<30?"exception":"success"},null,8,["percentage","status"])]),_:1})]),_:1},8,["data"])])):M("",!0),w.value.common_wrong_answers&&Object.keys(w.value.common_wrong_answers).length>0?(d(),f("div",jo,[e[163]||(e[163]=n("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"6px",color:"#303133","font-size":"13px"}},"常见错误答案",-1)),t(V,{data:la(w.value.common_wrong_answers),border:"",stripe:"",size:"small"},{default:l(()=>[t(c,{prop:"answer",label:"错误答案",width:"100"}),t(c,{prop:"count",label:"错误次数",width:"90",align:"center"})]),_:1},8,["data"])])):M("",!0),w.value.correct_answer&&(!w.value.subs||w.value.subs.length===0)?(d(),f("div",$o,[e[164]||(e[164]=n("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"6px",color:"#303133","font-size":"13px"}},"正确答案",-1)),n("div",{class:"math-content",style:{padding:"10px",background:"#f0f9ff",border:"1px solid #b3d8ff","border-radius":"4px",color:"#409eff","font-weight":"bold",display:"inline-block","min-width":"100px"},innerHTML:Q(w.value.correct_answer)},null,8,Mo)])):M("",!0),w.value.subs&&w.value.subs.length>0?(d(),f("div",Lo,[e[167]||(e[167]=n("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"6px",color:"#303133","font-size":"13px"}},"小题列表",-1)),(d(!0),f(E,null,H(w.value.subs,(a,g)=>(d(),f("div",{key:g,class:"sub-question-item",style:{"margin-bottom":"8px",padding:"10px",background:"#f5f7fa","border-radius":"4px"}},[n("div",qo,"小题 "+v(a.question_order||g+1),1),n("div",{class:"math-content",style:{"line-height":"1.5"},innerHTML:Q(a.stem)},null,8,Io),a.answer?(d(),f("div",Eo,[e[165]||(e[165]=n("span",{style:{"font-weight":"bold"}},"答案：",-1)),n("span",{innerHTML:Q(a.answer)},null,8,Ho)])):M("",!0),a.analysis?(d(),f("div",Po,[e[166]||(e[166]=n("span",{style:{"font-weight":"bold"}},"解析：",-1)),n("span",{innerHTML:Q(a.analysis)},null,8,Do)])):M("",!0)]))),128))])):M("",!0),w.value.analysis?(d(),f("div",Ro,[e[168]||(e[168]=n("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"4px",color:"#303133","font-size":"13px"}},"解析",-1)),n("div",{class:"math-content",style:{padding:"8px",background:"#f5f7fa","border-radius":"4px","line-height":"1.6","font-size":"14px"},innerHTML:Q(w.value.analysis)},null,8,Fo)])):M("",!0)])):M("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])])}}},Jo=Ka(No,[["__scopeId","data-v-2fbc9923"]]);export{Jo as default};
