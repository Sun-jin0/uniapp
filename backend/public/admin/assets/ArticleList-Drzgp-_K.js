import{_ as J,i as O,o as c,c as k,e as _,a,w as l,b as Q,C as W,z,p as U,f as i,r as n,D as X,u as Y,F as Z,y as ee,d as r,m as te,t as f,G as ae,E as le}from"./index-1rGkZLYp.js";const oe={class:"article-list"},ne={class:"header-actions"},se={class:"left"},ie={key:1},re={class:"title-cell"},ce={class:"pagination-container"},de={__name:"ArticleList",setup(ue){const A=Y(),y=i([]),h=i(0),d=i(1),g=i(10),b=i(!1),C=i(""),v=i("全部"),w=i(!1),S=["全部","资料","备考经验","政策动态","考试技巧","系统通知"],u=async()=>{b.value=!0;try{const o={page:d.value,size:g.value,keyword:C.value,status:w.value?0:1,noticeType:"article"};v.value!=="全部"&&(o.category=v.value);const e=await U.getNotices(o);e.code===0&&(e.data&&e.data.list?(y.value=e.data.list,h.value=e.data.total||0):Array.isArray(e.data)&&(y.value=e.data,h.value=e.data.length))}catch(o){console.error("加载文章列表失败:",o)}finally{b.value=!1}},p=()=>{d.value=1,u()},D=o=>{g.value=o,u()},N=o=>{d.value=o,u()},B=()=>{A.push("/article/edit")},E=o=>{A.push(`/article/edit?id=${o._id}`)},L=async o=>{try{await ae.confirm("确定要删除这篇文章吗？","提示",{type:"warning"}),(await U.deleteNotice(o._id)).code===0&&(le.success("删除成功"),u())}catch(e){e!=="cancel"&&console.error("删除失败:",e)}},P=o=>o?new Date(o).toLocaleString():"-";return O(()=>{u()}),(o,e)=>{const T=n("Search"),V=n("el-icon"),m=n("el-button"),K=n("el-input"),M=n("el-option"),$=n("el-select"),F=n("el-checkbox"),j=n("Plus"),G=n("el-image"),s=n("el-table-column"),x=n("el-tag"),I=n("el-table"),R=n("el-pagination"),q=X("loading");return c(),k("div",oe,[_("div",ne,[_("div",se,[a(K,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=t=>C.value=t),placeholder:"搜索文章标题...",class:"search-input",clearable:"",onClear:p,onKeyup:Q(p,["enter"])},{append:l(()=>[a(m,{onClick:p},{default:l(()=>[a(V,null,{default:l(()=>[a(T)]),_:1})]),_:1})]),_:1},8,["modelValue"]),a($,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t),placeholder:"选择分类",onChange:p,class:"category-select"},{default:l(()=>[(c(),k(Z,null,ee(S,t=>a(M,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),a(F,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=t=>w.value=t),onChange:p,border:""},{default:l(()=>[...e[5]||(e[5]=[r("仅看草稿",-1)])]),_:1},8,["modelValue"])]),a(m,{type:"primary",onClick:B},{default:l(()=>[a(V,null,{default:l(()=>[a(j)]),_:1}),e[6]||(e[6]=r(" 发布文章 ",-1))]),_:1})]),W((c(),z(I,{data:y.value,style:{width:"100%"},border:"",stripe:""},{default:l(()=>[a(s,{label:"封面",width:"120",align:"center"},{default:l(({row:t})=>[t.imageUrl?(c(),z(G,{key:0,src:t.imageUrl,fit:"cover",class:"article-cover","preview-src-list":[t.imageUrl],"preview-teleported":""},null,8,["src","preview-src-list"])):(c(),k("span",ie,"无"))]),_:1}),a(s,{prop:"title",label:"标题","min-width":"200"},{default:l(({row:t})=>[_("div",re,[t.linkUrl?(c(),z(x,{key:0,size:"small",type:"success",class:"mr-5"},{default:l(()=>[...e[7]||(e[7]=[r("微信",-1)])]),_:1})):te("",!0),_("span",null,f(t.title),1)])]),_:1}),a(s,{prop:"category",label:"分类",width:"120",align:"center"}),a(s,{prop:"author",label:"作者",width:"120",align:"center"},{default:l(({row:t})=>[r(f(t.author||"管理员"),1)]),_:1}),a(s,{prop:"viewCount",label:"阅读量",width:"100",align:"center",sortable:""}),a(s,{prop:"isActive",label:"状态",width:"100",align:"center"},{default:l(({row:t})=>[a(x,{type:t.isActive===1?"success":"info"},{default:l(()=>[r(f(t.isActive===1?"已发布":"草稿"),1)]),_:2},1032,["type"])]),_:1}),a(s,{prop:"createdAt",label:"创建时间",width:"180",align:"center"},{default:l(({row:t})=>[r(f(P(t.createdAt)),1)]),_:1}),a(s,{label:"操作",width:"180",align:"center",fixed:"right"},{default:l(({row:t})=>[a(m,{size:"small",onClick:H=>E(t)},{default:l(()=>[...e[8]||(e[8]=[r("编辑",-1)])]),_:1},8,["onClick"]),a(m,{size:"small",type:"danger",onClick:H=>L(t)},{default:l(()=>[...e[9]||(e[9]=[r("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[q,b.value]]),_("div",ce,[a(R,{"current-page":d.value,"onUpdate:currentPage":e[3]||(e[3]=t=>d.value=t),"page-size":g.value,"onUpdate:pageSize":e[4]||(e[4]=t=>g.value=t),"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",total:h.value,onSizeChange:D,onCurrentChange:N},null,8,["current-page","page-size","total"])])])}}},_e=J(de,[["__scopeId","data-v-e5c708ae"]]);export{_e as default};
