import{_ as Yl,K as Zl,i as et,o as i,c as y,e as d,a as t,w as a,L as g,f as s,r as b,D as lt,d as u,F as $,y as S,z as w,t as c,M as Ye,m as N,C as Ze,k as el,N as tt,b as at,O as ot,q as Oe,G as fe,E as r}from"./index-1rGkZLYp.js";const nt=ce=>ce,ut=ce=>ce,dt={class:"video-admin"},it={class:"manage-layout"},st={class:"manage-sidebar"},rt={class:"sidebar-header"},vt={class:"custom-tree-node"},pt={class:"custom-tree-node"},mt={class:"manage-main"},ft={class:"content-header"},ct={class:"header-actions"},yt={class:"table-wrapper"},bt={class:"image-slot"},_t={class:"action-buttons"},gt={class:"filter-bar"},wt={class:"table-wrapper"},Vt={key:0},Ct={key:1},kt={key:2},xt={class:"filter-bar"},Ut={class:"table-wrapper"},$t={class:"content-header"},St={class:"header-actions"},jt={class:"table-wrapper"},It={class:"action-buttons"},Rt={class:"video-items-section"},Nt={class:"section-header"},Mt={class:"idx"},Bt={style:{display:"flex","flex-direction":"column",gap:"8px"}},zt={style:{"font-weight":"bold",color:"#409EFF"}},qt={style:{display:"flex",gap:"10px"}},Ot={key:0,style:{"margin-top":"8px",color:"#67C23A","font-size":"12px"}},Tt={style:{"font-weight":"bold",color:"#409EFF"}},Ft={style:{display:"flex","flex-direction":"column",gap:"8px"}},Dt={key:0,class:"collection-videos-manager"},Et={style:{"margin-bottom":"16px"}},Jt={class:"collection-layout"},Gt={class:"available-videos"},Lt={class:"selected-videos"},Pt={class:"panel-header"},At={class:"selected-list"},Kt={class:"selected-title"},ht={key:0},Qt={style:{"font-weight":"bold",color:"#409EFF"}},Ht={style:{display:"flex","flex-direction":"column",gap:"8px"}},Wt={style:{"max-height":"200px","overflow-y":"auto",border:"1px solid #dcdfe6","border-radius":"4px",padding:"10px"}},Xt={style:{"font-weight":"bold"}},Yt={style:{"margin-top":"8px",color:"#409EFF"}},Zt={__name:"VideoAdmin",setup(ce){const ye=s("content"),I=s([]),ll=Oe(()=>I.value.map(o=>String(o.id))),T=s([]),be=s(!1),_e=s(null),H=s(null),ge=s(""),Te=s([]),W=s(!1),B=s({}),X=s(!1),R=s({}),Y=s(!1),f=s({items:[]}),Z=s(0),ee=s(0),we=s([]),Ve=s(!1),Fe=s(null),Ce=s(1),le=s([]),te=s(!1),q=s({requires_redemption:-1,is_public:-1,category_id:null}),G=s(null),J=s(null),ke=s(!1),ae=s(1),oe=s([]),De=s(""),xe=s([]),Le=s([]),Ue=s(0),$e=s(""),j=s([]),Ee=s(null),L=s([]),ne=s(!1),k=s({}),ue=s(!1),A=s(null),Je=s([]),F=s([]),Se=s(!1),je=s(null),de=s(1),ie=s([]),se=s(!1),_=s({collectionName:"",subjectId:null,categoryId:null,importType:"file",jsonContent:"",requiresRedemption:1,isPublic:1}),z=s([]),tl=s(null),Ie=s(null),Re=o=>o?new Date(o).toLocaleString():"-",al=Oe(()=>{const o={},e=ge.value.toLowerCase();return Je.value.forEach(n=>{if(e&&!n.title.toLowerCase().includes(e))return;const m=n.subject_name||"未分类";o[m]||(o[m]=[]),o[m].push(n)}),o}),ol=Oe(()=>Je.value.filter(o=>F.value.includes(o.id))),nl=o=>{const e=F.value.indexOf(o);e>-1&&F.value.splice(e,1)},K=async()=>{try{const o=await g.getSubjects();o.code===0&&(I.value=o.data||[])}catch(o){console.error(o)}},re=async()=>{be.value=!0;const o={};H.value?o.category_id=H.value:_e.value&&(o.subject_id=_e.value);try{const e=await g.getResources(o);e.code===0&&(T.value=e.data||[])}catch(e){console.error(e)}finally{be.value=!1}},ul=(o,e)=>{_e.value=o.id,H.value=e.id,re()},dl=Oe(()=>{var o;if(H.value){const e=I.value.find(m=>m.id===_e.value),n=(o=e==null?void 0:e.categories)==null?void 0:o.find(m=>m.id===H.value);return`${(e==null?void 0:e.name)||""} / ${(n==null?void 0:n.name)||""}`}return"所有视频"}),il=o=>{if(!o)return[];const e=I.value.find(n=>n.id===o);return(e==null?void 0:e.categories)||[]},sl=o=>{const e=I.value.find(n=>n.id===o);return(e==null?void 0:e.name)||""},rl=o=>{var e;for(const n of I.value){const m=(e=n.categories)==null?void 0:e.find(x=>x.id===o);if(m)return m.name}return""},Pe=(o=null)=>{B.value=o?{...o}:{name:"",sort:0},W.value=!0},vl=async()=>{try{B.value.id?await g.updateSubject(B.value.id,B.value):await g.createSubject(B.value),W.value=!1,K()}catch{r.error("操作失败")}},pl=o=>{fe.confirm(`确定删除科目 ${o.name} 吗？`,"提示").then(async()=>{await g.deleteSubject(o.id),K()})},Ae=(o,e=null)=>{R.value=e?{...e,subjectName:o.name,parent_id:o.id}:{name:"",sort:0,subjectName:o.name,parent_id:o.id},X.value=!0},ml=async()=>{try{R.value.id?await g.updateCategory(R.value.id,R.value):await g.createCategory(R.value),X.value=!1,K()}catch{r.error("操作失败")}},fl=o=>{fe.confirm(`确定删除分类 ${o.name} 吗？`,"提示").then(async()=>{await g.deleteCategory(o.id),K()})},Ke=async(o=null)=>{var e;if(I.value.length>0&&(Z.value=0,he()),o){const m=(await g.getResourceDetail(o.id)).data||{...o,items:[]};m.items&&m.items.forEach(x=>{x.url&&(x.url=ut(x.url))}),f.value=m}else f.value={title:"",type:"single",requires_redemption:0,is_public:1,items:[],category_id:(e=we.value[0])==null?void 0:e.id};Y.value=!0},he=()=>{const o=I.value[Z.value];we.value=o?o.categories||[]:[],ee.value=0},cl=o=>{Z.value=o,he()},yl=o=>{ee.value=o},bl=async()=>{const o=we.value[ee.value];if(!o)return r.warning("请选择分类");const e=JSON.parse(JSON.stringify(f.value));e.category_id=o.id,e.items&&e.items.forEach(n=>{n.url&&(n.url=nt(n.url))});try{if(e.id){if((await g.updateResource(e.id,e)).code===0){const m=T.value.findIndex(x=>x.id===e.id);m!==-1&&(T.value[m]={...T.value[m],...e}),r.success("更新成功")}}else await g.createResource(e),re(),r.success("创建成功");Y.value=!1}catch{r.error("保存失败")}},_l=o=>{fe.confirm("确定删除吗？","提示").then(async()=>{await g.deleteResource(o.id);const e=T.value.findIndex(n=>n.id===o.id);e!==-1&&T.value.splice(e,1),r.success("删除成功")})},gl=o=>{j.value=o.map(e=>e.id)},wl=()=>{q.value={requires_redemption:-1,is_public:-1},G.value=null,J.value=null,te.value=!0},Vl=async()=>{if(j.value.length===0){r.warning("请先选择要操作的资源");return}const o={};if(J.value&&(o.category_id=J.value),q.value.requires_redemption!==-1&&(o.requires_redemption=q.value.requires_redemption),q.value.is_public!==-1&&(o.is_public=q.value.is_public),Object.keys(o).forEach(e=>{(o[e]===null||o[e]===void 0)&&delete o[e]}),Object.keys(o).length===0){r.warning("请至少选择一项要修改的内容");return}try{const e=[...j.value];await g.batchUpdateResources(e,o),T.value=T.value.map(n=>e.includes(n.id)?{...n,...o}:n),r.success("批量操作成功"),te.value=!1,Ee.value&&Ee.value.clearSelection(),j.value=[]}catch(e){console.error("批量操作失败:",e),r.error("批量操作失败: "+(e.message||"未知错误"))}},Cl=()=>{if(j.value.length===0){r.warning("请先选择要生成兑换码的资源");return}ae.value=1,oe.value=[],ke.value=!0},kl=async()=>{if(j.value.length===0){r.warning("请先选择要生成兑换码的资源");return}try{const o=await g.generateCodes({resourceIds:j.value,count:ae.value});o.code===0&&(oe.value=o.data,r.success(`成功生成 ${o.data.length} 个兑换码，每个可访问 ${j.value.length} 个资源`))}catch{r.error("生成兑换码失败")}},Ge=o=>{navigator.clipboard.writeText(o).then(()=>{r.success("已复制到剪贴板")}).catch(()=>{r.error("复制失败")})},xl=async()=>{if(!$e.value){r.warning("请输入B站分享文字");return}const o=$e.value.match(/https?:\/\/[^\s]+/);if(!o){r.warning("未找到有效链接");return}const e=o[0],n=r({message:"解析中...",duration:0,type:"info"});try{const m=await g.parseBiliLink(e);if(n.close(),m.code===0){const x=m.data;f.value.title||(f.value.title=x.title),f.value.bili_link=x.bili_link||f.value.bili_link,f.value.cover_url=x.cover_url||f.value.cover_url,f.value.description=x.description||f.value.description,f.value.items||(f.value.items=[]),f.value.items.push({title:x.title,bili_link:x.bili_link,url:"",duration:""}),r.success("识别成功")}else r.error(m.message||"识别失败")}catch(m){n.close(),console.error("解析出错:",m),r.error("解析出错: "+(m.message||"未知错误"))}},Ul=()=>{f.value.items||(f.value.items=[]),f.value.items.push({title:"",url:"",duration:""})},$l=o=>{f.value.items.splice(o,1)},Sl=o=>{const e=`https://your-domain.com/video/${o.vid}`;navigator.clipboard.writeText(e).then(()=>{r.success("链接已复制到剪贴板")}).catch(()=>{r.error("复制失败")})},ve=async()=>{const o=await g.getCodes({keyword:De.value});o.code===0&&(xe.value=o.data||[])},jl=o=>{Fe.value=o,Ce.value=1,le.value=[],Ve.value=!0},Il=async()=>{const o=await g.generateCodes({resourceIds:[Fe.value.id],count:Ce.value});o.code===0&&(le.value=o.data)},Ne=async()=>{const o=["","feedback","recommend"],e={};Ue.value>0&&(e.type=o[Ue.value]);const n=await g.getFeedbacks(e);n.code===0&&(Le.value=n.data||[])},Me=async()=>{const o=await g.getCollections();o.code===0&&(L.value=o.data||[])},Qe=(o=null)=>{k.value=o?{...o}:{name:"",description:"",cover_url:"",sort:0,is_active:1},ne.value=!0},Rl=async()=>{try{if(k.value.id){if((await g.updateCollection(k.value.id,k.value)).code===0){const e=L.value.findIndex(n=>n.id===k.value.id);e!==-1&&(L.value[e]={...L.value[e],...k.value}),r.success("更新成功")}}else await g.createCollection(k.value),Me(),r.success("创建成功");ne.value=!1}catch{r.error("操作失败")}},Nl=async o=>{try{await fe.confirm("确定删除此合集吗？","确认删除",{type:"warning"}),await g.deleteCollection(o.id);const e=L.value.findIndex(n=>n.id===o.id);e!==-1&&L.value.splice(e,1),r.success("删除成功")}catch(e){e!=="cancel"&&r.error("删除失败")}},Ml=async o=>{A.value=o,ge.value="";const e=await g.getCollectionDetail(o.id);e.code===0&&(A.value=e.data,F.value=e.data.videos.map(m=>m.resource_id));const n=await g.getResources({status:1});if(n.code===0){Je.value=n.data;const m=new Set(n.data.map(x=>x.subject_name||"未分类"));Te.value=Array.from(m)}ue.value=!0},Bl=async()=>{try{await g.updateCollectionVideos({collectionId:A.value.id,videoIds:F.value}),r.success("更新成功"),ue.value=!1}catch{r.error("更新失败")}},zl=o=>{je.value=o,de.value=1,ie.value=[],Se.value=!0},ql=async()=>{try{const o=await g.generateCollectionCodes({collectionId:je.value.id,count:de.value});o.code===0&&(ie.value=o.data,r.success(`成功生成 ${o.data.length} 个兑换码`))}catch{r.error("生成兑换码失败")}},Ol=()=>{switch(ye.value){case"content":re(),K();break;case"code":ve();break;case"feedback":Ne();break;case"collections":Me();break}};Zl(ye,o=>{Ol()});const Tl=async o=>{try{await fe.confirm(`确定要删除兑换码 "${o.code}" 吗？`,"确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}),await g.deleteCode(o.id);const e=xe.value.findIndex(n=>n.id===o.id);e!==-1&&xe.value.splice(e,1),r.success("删除成功")}catch(e){e!=="cancel"&&r.error(e.message||"删除失败")}};et(()=>{K(),ve(),Ne(),Me()});const Fl=()=>{_.value={collectionName:"",subjectId:null,categoryId:null,importType:"file",jsonContent:"",requiresRedemption:1,isPublic:1},z.value=[],Ie.value=null,se.value=!0},Dl=o=>{if(!o)return[];const e=I.value.find(n=>n.id===o);return e?e.categories:[]},El=o=>{Ie.value=o.raw},Jl=async()=>{var o;try{let e=null;if(_.value.importType==="file"){if(!Ie.value){r.warning("请选择JSON文件");return}const m=await Ie.value.text();e=JSON.parse(m)}else{if(!_.value.jsonContent.trim()){r.warning("请粘贴JSON内容");return}e=JSON.parse(_.value.jsonContent)}const n=((o=e.data)==null?void 0:o.list)||e.list||[];if(n.length===0){r.warning("未找到视频数据");return}if(z.value=n.map(m=>({title:m.lessonName||m.title||"未命名",url:m.lessonUrl||m.url||""})).filter(m=>m.url),z.value.length===0){r.warning("未找到有效的视频链接");return}r.success(`成功解析 ${z.value.length} 个视频`)}catch(e){r.error("JSON解析失败："+e.message)}},Gl=async()=>{try{if(!_.value.collectionName){r.warning("请输入集合名称");return}if(!_.value.subjectId){r.warning("请选择科目");return}if(z.value.length===0){r.warning("没有可导入的视频");return}(await g.batchImportVideos({collectionName:_.value.collectionName,subjectId:_.value.subjectId,categoryId:_.value.categoryId,videos:z.value,requiresRedemption:_.value.requiresRedemption,isPublic:_.value.isPublic})).code===0&&(r.success(`成功导入 ${z.value.length} 个视频`),se.value=!1,re())}catch(o){r.error("导入失败："+(o.message||"未知错误"))}};return(o,e)=>{const n=b("el-button"),m=b("el-menu-item"),x=b("el-sub-menu"),Ll=b("el-menu"),V=b("el-table-column"),He=b("el-icon"),Pl=b("el-image"),h=b("el-tag"),Be=b("el-table"),ze=b("el-tab-pane"),C=b("el-input"),D=b("el-option"),P=b("el-select"),Al=b("el-tabs"),v=b("el-form-item"),Q=b("el-input-number"),E=b("el-form"),O=b("el-dialog"),pe=b("el-col"),We=b("el-row"),M=b("el-radio"),me=b("el-radio-group"),qe=b("el-switch"),Kl=b("el-checkbox"),hl=b("el-checkbox-group"),Ql=b("el-collapse-item"),Hl=b("el-collapse"),Wl=b("el-empty"),Xl=b("el-upload"),Xe=lt("loading");return i(),y("div",dt,[e[137]||(e[137]=d("div",{class:"header"},[d("h2",null,"视频课程管理")],-1)),t(Al,{modelValue:ye.value,"onUpdate:modelValue":e[7]||(e[7]=l=>ye.value=l),type:"border-card"},{default:a(()=>[t(ze,{label:"内容管理",name:"content"},{default:a(()=>[d("div",it,[d("div",st,[d("div",rt,[e[67]||(e[67]=d("span",null,"科目分类",-1)),t(n,{type:"primary",size:"small",onClick:e[0]||(e[0]=l=>Pe())},{default:a(()=>[...e[66]||(e[66]=[u("添加科目",-1)])]),_:1})]),t(Ll,{"default-openeds":ll.value},{default:a(()=>[(i(!0),y($,null,S(I.value,l=>(i(),w(x,{key:l.id,index:String(l.id)},{title:a(()=>[d("span",vt,[d("span",null,c(l.name),1),d("span",{class:"tree-actions",onClick:e[1]||(e[1]=Ye(()=>{},["stop"]))},[t(n,{type:"primary",size:"small",onClick:p=>Pe(l)},{default:a(()=>[...e[68]||(e[68]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(n,{type:"primary",size:"small",onClick:p=>Ae(l)},{default:a(()=>[...e[69]||(e[69]=[u("添加",-1)])]),_:1},8,["onClick"]),t(n,{type:"danger",size:"small",onClick:p=>pl(l)},{default:a(()=>[...e[70]||(e[70]=[u("删除",-1)])]),_:1},8,["onClick"])])])]),default:a(()=>[(i(!0),y($,null,S(l.categories,p=>(i(),w(m,{key:p.id,index:`${l.id}-${p.id}`,onClick:U=>ul(l,p)},{default:a(()=>[d("span",pt,[d("span",null,c(p.name),1),d("span",{class:"tree-actions",onClick:e[2]||(e[2]=Ye(()=>{},["stop"]))},[t(n,{type:"primary",size:"small",onClick:U=>Ae(l,p)},{default:a(()=>[...e[71]||(e[71]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(n,{type:"danger",size:"small",onClick:U=>fl(p)},{default:a(()=>[...e[72]||(e[72]=[u("删除",-1)])]),_:1},8,["onClick"])])])]),_:2},1032,["index","onClick"]))),128))]),_:2},1032,["index"]))),128))]),_:1},8,["default-openeds"])]),d("div",mt,[d("div",ft,[d("h3",null,c(dl.value),1),d("div",ct,[j.value.length?(i(),w(n,{key:0,type:"warning",onClick:wl},{default:a(()=>[u("批量操作 ("+c(j.value.length)+")",1)]),_:1})):N("",!0),j.value.length?(i(),w(n,{key:1,type:"success",onClick:Cl},{default:a(()=>[...e[73]||(e[73]=[u("批量生成兑换码",-1)])]),_:1})):N("",!0),t(n,{type:"success",onClick:re},{default:a(()=>[...e[74]||(e[74]=[u("刷新",-1)])]),_:1}),t(n,{type:"primary",onClick:e[3]||(e[3]=l=>Ke())},{default:a(()=>[...e[75]||(e[75]=[u("新建视频/合集",-1)])]),_:1}),t(n,{type:"info",onClick:Fl},{default:a(()=>[...e[76]||(e[76]=[u("批量导入",-1)])]),_:1})])]),d("div",yt,[Ze((i(),w(Be,{ref_key:"resourceTableRef",ref:Ee,data:T.value,onSelectionChange:gl,style:{width:"100%","min-width":"900px"}},{default:a(()=>[t(V,{type:"selection",width:"55"}),t(V,{label:"封面",width:"120"},{default:a(l=>[t(Pl,{src:l.row.cover_url,style:{width:"100px",height:"60px"},fit:"cover"},{error:a(()=>[d("div",bt,[t(He,null,{default:a(()=>[t(el(tt))]),_:1})])]),_:1},8,["src"])]),_:1}),t(V,{prop:"title",label:"标题","min-width":"150","show-overflow-tooltip":""}),t(V,{label:"类型",width:"80"},{default:a(l=>[t(h,{type:l.row.type==="collection"?"warning":"info"},{default:a(()=>[u(c(l.row.type==="collection"?"合集":"单集"),1)]),_:2},1032,["type"])]),_:1}),t(V,{label:"权限",width:"100"},{default:a(l=>[t(h,{type:l.row.requires_redemption?"danger":"success"},{default:a(()=>[u(c(l.row.requires_redemption?"需兑换":"免费"),1)]),_:2},1032,["type"])]),_:1}),t(V,{label:"状态",width:"80"},{default:a(l=>[t(h,{type:l.row.is_public?"success":"info"},{default:a(()=>[u(c(l.row.is_public?"公开":"隐藏"),1)]),_:2},1032,["type"])]),_:1}),t(V,{label:"操作",width:"320",fixed:"right"},{default:a(l=>[d("div",_t,[t(n,{type:"primary",size:"small",onClick:p=>Ke(l.row)},{default:a(()=>[...e[77]||(e[77]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(n,{type:"success",size:"small",onClick:p=>jl(l.row)},{default:a(()=>[...e[78]||(e[78]=[u("兑换码",-1)])]),_:1},8,["onClick"]),t(n,{type:"info",size:"small",onClick:p=>Sl(l.row)},{default:a(()=>[...e[79]||(e[79]=[u("链接",-1)])]),_:1},8,["onClick"]),t(n,{type:"danger",size:"small",onClick:p=>_l(l.row)},{default:a(()=>[...e[80]||(e[80]=[u("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[Xe,be.value]])])])])]),_:1}),t(ze,{label:"兑换码管理",name:"code"},{default:a(()=>[d("div",gt,[t(C,{modelValue:De.value,"onUpdate:modelValue":e[4]||(e[4]=l=>De.value=l),placeholder:"搜索兑换码...",style:{width:"300px"},onKeyup:at(ve,["enter"])},null,8,["modelValue"]),t(n,{type:"primary",onClick:ve},{default:a(()=>[...e[81]||(e[81]=[u("搜索",-1)])]),_:1}),t(n,{type:"success",onClick:ve},{default:a(()=>[...e[82]||(e[82]=[u("刷新",-1)])]),_:1})]),d("div",wt,[Ze((i(),w(Be,{data:xe.value,style:{width:"100%","min-width":"900px"}},{default:a(()=>[t(V,{prop:"code",label:"兑换码",width:"180"}),t(V,{label:"对应资源","min-width":"150","show-overflow-tooltip":""},{default:a(l=>[u(c(l.row.resource_title||l.row.collection_name||"-"),1)]),_:1}),t(V,{label:"状态",width:"100"},{default:a(l=>[t(h,{type:l.row.is_used?"danger":"success"},{default:a(()=>[u(c(l.row.is_used?"已使用":"未使用"),1)]),_:2},1032,["type"])]),_:1}),t(V,{label:"使用者",width:"180"},{default:a(l=>[l.row.used_by_student_id?(i(),y("span",Vt,c(l.row.used_by_student_id),1)):l.row.used_by?(i(),y("span",Ct," ID: "+c(l.row.used_by),1)):(i(),y("span",kt,"-"))]),_:1}),t(V,{prop:"used_at",label:"使用时间",width:"180"},{default:a(l=>[u(c(Re(l.row.used_at)),1)]),_:1}),t(V,{prop:"created_at",label:"生成时间",width:"180"},{default:a(l=>[u(c(Re(l.row.created_at)),1)]),_:1}),t(V,{label:"操作",width:"100",fixed:"right"},{default:a(l=>[t(n,{type:"danger",size:"small",onClick:p=>Tl(l.row)},{default:a(()=>[...e[83]||(e[83]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Xe,be.value]])])]),_:1}),t(ze,{label:"反馈与推荐",name:"feedback"},{default:a(()=>[d("div",xt,[t(P,{modelValue:Ue.value,"onUpdate:modelValue":e[5]||(e[5]=l=>Ue.value=l),onChange:Ne},{default:a(()=>[t(D,{label:"全部",value:0}),t(D,{label:"反馈",value:1}),t(D,{label:"推荐",value:2})]),_:1},8,["modelValue"]),t(n,{type:"primary",onClick:Ne},{default:a(()=>[...e[84]||(e[84]=[u("刷新",-1)])]),_:1})]),d("div",Ut,[t(Be,{data:Le.value,style:{width:"100%","min-width":"800px"}},{default:a(()=>[t(V,{label:"类型",width:"80"},{default:a(l=>[t(h,null,{default:a(()=>[u(c(l.row.type==="feedback"?"反馈":"推荐"),1)]),_:2},1024)]),_:1}),t(V,{prop:"content",label:"内容","min-width":"200","show-overflow-tooltip":""}),t(V,{prop:"resource_title",label:"相关视频",width:"200","show-overflow-tooltip":""}),t(V,{prop:"nickname",label:"用户",width:"120"}),t(V,{prop:"created_at",label:"时间",width:"180"},{default:a(l=>[u(c(Re(l.row.created_at)),1)]),_:1})]),_:1},8,["data"])])]),_:1}),t(ze,{label:"合集管理",name:"collections"},{default:a(()=>[d("div",$t,[e[87]||(e[87]=d("h3",null,"合集列表",-1)),d("div",St,[t(n,{type:"success",onClick:Me},{default:a(()=>[...e[85]||(e[85]=[u("刷新",-1)])]),_:1}),t(n,{type:"primary",onClick:e[6]||(e[6]=l=>Qe())},{default:a(()=>[...e[86]||(e[86]=[u("新建合集",-1)])]),_:1})])]),d("div",jt,[t(Be,{data:L.value,style:{width:"100%","min-width":"800px"}},{default:a(()=>[t(V,{prop:"name",label:"合集名称","min-width":"200"}),t(V,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),t(V,{prop:"sort",label:"排序",width:"80"}),t(V,{label:"状态",width:"80"},{default:a(l=>[t(h,{type:l.row.is_active?"success":"info"},{default:a(()=>[u(c(l.row.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(V,{prop:"created_at",label:"创建时间",width:"180"},{default:a(l=>[u(c(Re(l.row.created_at)),1)]),_:1}),t(V,{label:"操作",width:"280",fixed:"right"},{default:a(l=>[d("div",It,[t(n,{type:"primary",size:"small",onClick:p=>Ml(l.row)},{default:a(()=>[...e[88]||(e[88]=[u("管理视频",-1)])]),_:1},8,["onClick"]),t(n,{type:"success",size:"small",onClick:p=>zl(l.row)},{default:a(()=>[...e[89]||(e[89]=[u("生成兑换码",-1)])]),_:1},8,["onClick"]),t(n,{type:"primary",size:"small",onClick:p=>Qe(l.row)},{default:a(()=>[...e[90]||(e[90]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(n,{type:"danger",size:"small",onClick:p=>Nl(l.row)},{default:a(()=>[...e[91]||(e[91]=[u("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])])]),_:1})]),_:1},8,["modelValue"]),t(O,{modelValue:W.value,"onUpdate:modelValue":e[11]||(e[11]=l=>W.value=l),title:B.value.id?"编辑科目":"新建科目",width:"400px"},{footer:a(()=>[t(n,{onClick:e[10]||(e[10]=l=>W.value=!1)},{default:a(()=>[...e[92]||(e[92]=[u("取消",-1)])]),_:1}),t(n,{type:"primary",onClick:vl},{default:a(()=>[...e[93]||(e[93]=[u("保存",-1)])]),_:1})]),default:a(()=>[t(E,{model:B.value,"label-width":"80px"},{default:a(()=>[t(v,{label:"名称"},{default:a(()=>[t(C,{modelValue:B.value.name,"onUpdate:modelValue":e[8]||(e[8]=l=>B.value.name=l)},null,8,["modelValue"])]),_:1}),t(v,{label:"排序"},{default:a(()=>[t(Q,{modelValue:B.value.sort,"onUpdate:modelValue":e[9]||(e[9]=l=>B.value.sort=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(O,{modelValue:X.value,"onUpdate:modelValue":e[16]||(e[16]=l=>X.value=l),title:R.value.id?"编辑分类":"新建分类",width:"400px"},{footer:a(()=>[t(n,{onClick:e[15]||(e[15]=l=>X.value=!1)},{default:a(()=>[...e[94]||(e[94]=[u("取消",-1)])]),_:1}),t(n,{type:"primary",onClick:ml},{default:a(()=>[...e[95]||(e[95]=[u("保存",-1)])]),_:1})]),default:a(()=>[t(E,{model:R.value,"label-width":"80px"},{default:a(()=>[t(v,{label:"所属科目"},{default:a(()=>[t(C,{modelValue:R.value.subjectName,"onUpdate:modelValue":e[12]||(e[12]=l=>R.value.subjectName=l),disabled:""},null,8,["modelValue"])]),_:1}),t(v,{label:"名称"},{default:a(()=>[t(C,{modelValue:R.value.name,"onUpdate:modelValue":e[13]||(e[13]=l=>R.value.name=l)},null,8,["modelValue"])]),_:1}),t(v,{label:"排序"},{default:a(()=>[t(Q,{modelValue:R.value.sort,"onUpdate:modelValue":e[14]||(e[14]=l=>R.value.sort=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(O,{modelValue:Y.value,"onUpdate:modelValue":e[28]||(e[28]=l=>Y.value=l),title:f.value.id?"编辑视频":"新建视频",width:"800px"},{footer:a(()=>[t(n,{onClick:e[27]||(e[27]=l=>Y.value=!1)},{default:a(()=>[...e[103]||(e[103]=[u("取消",-1)])]),_:1}),t(n,{type:"primary",onClick:bl},{default:a(()=>[...e[104]||(e[104]=[u("保存",-1)])]),_:1})]),default:a(()=>[t(E,{model:f.value,"label-width":"100px"},{default:a(()=>[t(We,null,{default:a(()=>[t(pe,{span:12},{default:a(()=>[t(v,{label:"归属科目"},{default:a(()=>[t(P,{modelValue:Z.value,"onUpdate:modelValue":e[17]||(e[17]=l=>Z.value=l),onChange:cl},{default:a(()=>[(i(!0),y($,null,S(I.value,(l,p)=>(i(),w(D,{key:l.id,label:l.name,value:p},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(pe,{span:12},{default:a(()=>[t(v,{label:"归属分类"},{default:a(()=>[t(P,{modelValue:ee.value,"onUpdate:modelValue":e[18]||(e[18]=l=>ee.value=l),onChange:yl},{default:a(()=>[(i(!0),y($,null,S(we.value,(l,p)=>(i(),w(D,{key:l.id,label:l.name,value:p},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(v,{label:"B站快速识别"},{default:a(()=>[t(C,{modelValue:$e.value,"onUpdate:modelValue":e[19]||(e[19]=l=>$e.value=l),placeholder:"粘贴 B站 分享文字，如：【标题】链接"},{append:a(()=>[t(n,{onClick:xl},{default:a(()=>[...e[96]||(e[96]=[u("识别",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"标题"},{default:a(()=>[t(C,{modelValue:f.value.title,"onUpdate:modelValue":e[20]||(e[20]=l=>f.value.title=l)},null,8,["modelValue"])]),_:1}),t(v,{label:"B站链接"},{default:a(()=>[t(C,{modelValue:f.value.bili_link,"onUpdate:modelValue":e[21]||(e[21]=l=>f.value.bili_link=l),placeholder:"合集主链接/单集链接"},null,8,["modelValue"])]),_:1}),t(v,{label:"封面URL"},{default:a(()=>[t(C,{modelValue:f.value.cover_url,"onUpdate:modelValue":e[22]||(e[22]=l=>f.value.cover_url=l)},null,8,["modelValue"])]),_:1}),t(v,{label:"简介"},{default:a(()=>[t(C,{modelValue:f.value.description,"onUpdate:modelValue":e[23]||(e[23]=l=>f.value.description=l),type:"textarea"},null,8,["modelValue"])]),_:1}),t(We,null,{default:a(()=>[t(pe,{span:8},{default:a(()=>[t(v,{label:"类型"},{default:a(()=>[t(me,{modelValue:f.value.type,"onUpdate:modelValue":e[24]||(e[24]=l=>f.value.type=l)},{default:a(()=>[t(M,{label:"single"},{default:a(()=>[...e[97]||(e[97]=[u("单集",-1)])]),_:1}),t(M,{label:"collection"},{default:a(()=>[...e[98]||(e[98]=[u("合集",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(pe,{span:8},{default:a(()=>[t(v,{label:"权限"},{default:a(()=>[t(me,{modelValue:f.value.requires_redemption,"onUpdate:modelValue":e[25]||(e[25]=l=>f.value.requires_redemption=l)},{default:a(()=>[t(M,{label:0},{default:a(()=>[...e[99]||(e[99]=[u("免费",-1)])]),_:1}),t(M,{label:1},{default:a(()=>[...e[100]||(e[100]=[u("需兑换",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(pe,{span:8},{default:a(()=>[t(v,{label:"公开"},{default:a(()=>[t(qe,{modelValue:f.value.is_public,"onUpdate:modelValue":e[26]||(e[26]=l=>f.value.is_public=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d("div",Rt,[d("div",Nt,[d("h4",null,"视频列表 ("+c(f.value.items?f.value.items.length:0)+")",1),t(n,{size:"small",onClick:Ul},{default:a(()=>[...e[101]||(e[101]=[u("添加视频",-1)])]),_:1})]),(i(!0),y($,null,S(f.value.items,(l,p)=>(i(),y("div",{key:p,class:"video-item-row"},[d("span",Mt,c(p+1),1),t(C,{modelValue:l.title,"onUpdate:modelValue":U=>l.title=U,placeholder:"标题",style:{width:"200px"}},null,8,["modelValue","onUpdate:modelValue"]),t(C,{modelValue:l.url,"onUpdate:modelValue":U=>l.url=U,placeholder:"OSS URL",style:{flex:"1"}},null,8,["modelValue","onUpdate:modelValue"]),t(C,{modelValue:l.duration,"onUpdate:modelValue":U=>l.duration=U,placeholder:"时长",style:{width:"80px"}},null,8,["modelValue","onUpdate:modelValue"]),t(n,{link:"",type:"danger",onClick:U=>$l(p)},{default:a(()=>[...e[102]||(e[102]=[u("×",-1)])]),_:1},8,["onClick"])]))),128))])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(O,{modelValue:Ve.value,"onUpdate:modelValue":e[31]||(e[31]=l=>Ve.value=l),title:"生成兑换码",width:"400px"},{footer:a(()=>[t(n,{onClick:e[30]||(e[30]=l=>Ve.value=!1)},{default:a(()=>[...e[106]||(e[106]=[u("关闭",-1)])]),_:1}),le.value.length?N("",!0):(i(),w(n,{key:0,type:"primary",onClick:Il},{default:a(()=>[...e[107]||(e[107]=[u("生成",-1)])]),_:1}))]),default:a(()=>[t(E,{"label-width":"100px"},{default:a(()=>[t(v,{label:"资源"},{default:a(()=>{var l;return[d("span",null,c((l=Fe.value)==null?void 0:l.title),1)]}),_:1}),t(v,{label:"数量"},{default:a(()=>[t(Q,{modelValue:Ce.value,"onUpdate:modelValue":e[29]||(e[29]=l=>Ce.value=l),min:1},null,8,["modelValue"])]),_:1}),le.value.length?(i(),w(v,{key:0,label:"结果"},{default:a(()=>[d("div",Bt,[(i(!0),y($,null,S(le.value,(l,p)=>(i(),y("div",{key:p,style:{display:"flex","align-items":"center",gap:"8px"}},[t(C,{value:l,readonly:"",style:{flex:"1"}},null,8,["value"]),t(n,{type:"primary",size:"small",onClick:U=>Ge(l)},{default:a(()=>[...e[105]||(e[105]=[u("复制",-1)])]),_:1},8,["onClick"])]))),128))])]),_:1})):N("",!0)]),_:1})]),_:1},8,["modelValue"]),t(O,{modelValue:te.value,"onUpdate:modelValue":e[38]||(e[38]=l=>te.value=l),title:"批量操作视频资源",width:"600px"},{footer:a(()=>[t(n,{onClick:e[37]||(e[37]=l=>te.value=!1)},{default:a(()=>[...e[114]||(e[114]=[u("取消",-1)])]),_:1}),t(n,{type:"primary",onClick:Vl},{default:a(()=>[...e[115]||(e[115]=[u("确定",-1)])]),_:1})]),default:a(()=>[t(E,{model:q.value,"label-width":"120px"},{default:a(()=>[t(v,{label:"选中资源数量"},{default:a(()=>[d("span",zt,c(j.value.length)+" 个",1)]),_:1}),t(v,{label:"移动到分类"},{default:a(()=>[d("div",qt,[t(P,{modelValue:G.value,"onUpdate:modelValue":e[32]||(e[32]=l=>G.value=l),placeholder:"选择科目",style:{width:"180px"},onChange:e[33]||(e[33]=l=>J.value=null)},{default:a(()=>[(i(!0),y($,null,S(I.value,l=>(i(),w(D,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(P,{modelValue:J.value,"onUpdate:modelValue":e[34]||(e[34]=l=>J.value=l),placeholder:"选择分类",style:{width:"180px"},disabled:!G.value},{default:a(()=>[(i(!0),y($,null,S(il(G.value),l=>(i(),w(D,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),G.value&&J.value?(i(),y("div",Ot," 将移动到: "+c(sl(G.value))+" / "+c(rl(J.value)),1)):N("",!0)]),_:1}),t(v,{label:"修改观看权限"},{default:a(()=>[t(me,{modelValue:q.value.requires_redemption,"onUpdate:modelValue":e[35]||(e[35]=l=>q.value.requires_redemption=l)},{default:a(()=>[t(M,{label:0},{default:a(()=>[...e[108]||(e[108]=[u("免费",-1)])]),_:1}),t(M,{label:1},{default:a(()=>[...e[109]||(e[109]=[u("需兑换",-1)])]),_:1}),t(M,{label:-1},{default:a(()=>[...e[110]||(e[110]=[u("不修改",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"修改公开状态"},{default:a(()=>[t(me,{modelValue:q.value.is_public,"onUpdate:modelValue":e[36]||(e[36]=l=>q.value.is_public=l)},{default:a(()=>[t(M,{value:1},{default:a(()=>[...e[111]||(e[111]=[u("公开",-1)])]),_:1}),t(M,{value:0},{default:a(()=>[...e[112]||(e[112]=[u("隐藏",-1)])]),_:1}),t(M,{value:-1},{default:a(()=>[...e[113]||(e[113]=[u("不修改",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(O,{modelValue:ke.value,"onUpdate:modelValue":e[41]||(e[41]=l=>ke.value=l),title:"生成兑换码",width:"500px"},{footer:a(()=>[t(n,{onClick:e[40]||(e[40]=l=>ke.value=!1)},{default:a(()=>[...e[118]||(e[118]=[u("关闭",-1)])]),_:1}),oe.value.length?N("",!0):(i(),w(n,{key:0,type:"primary",onClick:kl},{default:a(()=>[...e[119]||(e[119]=[u("生成",-1)])]),_:1}))]),default:a(()=>[t(E,{"label-width":"120px"},{default:a(()=>[t(v,{label:"选中资源数量"},{default:a(()=>[d("span",null,c(j.value.length)+" 个",1)]),_:1}),t(v,{label:"生成数量"},{default:a(()=>[t(Q,{modelValue:ae.value,"onUpdate:modelValue":e[39]||(e[39]=l=>ae.value=l),min:1,max:100},null,8,["modelValue"]),e[116]||(e[116]=d("span",{style:{"margin-left":"8px"}},"个兑换码",-1))]),_:1}),t(v,{label:"预计生成"},{default:a(()=>[d("span",Tt,c(ae.value)+" 个兑换码，每个可访问 "+c(j.value.length)+" 个资源",1)]),_:1}),oe.value.length?(i(),w(v,{key:0,label:"生成结果"},{default:a(()=>[d("div",Ft,[(i(!0),y($,null,S(oe.value,(l,p)=>(i(),y("div",{key:p,style:{display:"flex","align-items":"center",gap:"8px"}},[t(C,{value:l,readonly:"",style:{flex:"1"}},null,8,["value"]),t(n,{type:"primary",size:"small",onClick:U=>Ge(l)},{default:a(()=>[...e[117]||(e[117]=[u("复制",-1)])]),_:1},8,["onClick"])]))),128))])]),_:1})):N("",!0)]),_:1})]),_:1},8,["modelValue"]),t(O,{modelValue:ne.value,"onUpdate:modelValue":e[48]||(e[48]=l=>ne.value=l),title:k.value.id?"编辑合集":"新建合集",width:"500px"},{footer:a(()=>[t(n,{onClick:e[47]||(e[47]=l=>ne.value=!1)},{default:a(()=>[...e[120]||(e[120]=[u("取消",-1)])]),_:1}),t(n,{type:"primary",onClick:Rl},{default:a(()=>[...e[121]||(e[121]=[u("确定",-1)])]),_:1})]),default:a(()=>[t(E,{model:k.value,"label-width":"100px"},{default:a(()=>[t(v,{label:"合集名称"},{default:a(()=>[t(C,{modelValue:k.value.name,"onUpdate:modelValue":e[42]||(e[42]=l=>k.value.name=l)},null,8,["modelValue"])]),_:1}),t(v,{label:"描述"},{default:a(()=>[t(C,{modelValue:k.value.description,"onUpdate:modelValue":e[43]||(e[43]=l=>k.value.description=l),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(v,{label:"封面图"},{default:a(()=>[t(C,{modelValue:k.value.cover_url,"onUpdate:modelValue":e[44]||(e[44]=l=>k.value.cover_url=l),placeholder:"封面图URL"},null,8,["modelValue"])]),_:1}),t(v,{label:"排序"},{default:a(()=>[t(Q,{modelValue:k.value.sort,"onUpdate:modelValue":e[45]||(e[45]=l=>k.value.sort=l),min:0},null,8,["modelValue"])]),_:1}),t(v,{label:"状态"},{default:a(()=>[t(qe,{modelValue:k.value.is_active,"onUpdate:modelValue":e[46]||(e[46]=l=>k.value.is_active=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(O,{modelValue:ue.value,"onUpdate:modelValue":e[53]||(e[53]=l=>ue.value=l),title:"管理合集视频",width:"900px"},{footer:a(()=>[t(n,{onClick:e[52]||(e[52]=l=>ue.value=!1)},{default:a(()=>[...e[124]||(e[124]=[u("取消",-1)])]),_:1}),t(n,{type:"primary",onClick:Bl},{default:a(()=>[...e[125]||(e[125]=[u("保存",-1)])]),_:1})]),default:a(()=>[A.value?(i(),y("div",Dt,[d("p",Et,"合集："+c(A.value.name),1),d("div",Jt,[d("div",Gt,[e[122]||(e[122]=d("div",{class:"panel-header"},"可选视频",-1)),t(C,{modelValue:ge.value,"onUpdate:modelValue":e[49]||(e[49]=l=>ge.value=l),placeholder:"搜索视频...",clearable:"",class:"search-input"},{prefix:a(()=>[t(He,null,{default:a(()=>[t(el(ot))]),_:1})]),_:1},8,["modelValue"]),t(Hl,{modelValue:Te.value,"onUpdate:modelValue":e[51]||(e[51]=l=>Te.value=l),class:"subject-collapse"},{default:a(()=>[(i(!0),y($,null,S(al.value,(l,p)=>(i(),w(Ql,{key:p,title:`${p} (${l.length})`,name:p},{default:a(()=>[t(hl,{modelValue:F.value,"onUpdate:modelValue":e[50]||(e[50]=U=>F.value=U),class:"video-checkbox-group"},{default:a(()=>[(i(!0),y($,null,S(l,U=>(i(),w(Kl,{key:U.id,label:U.id,class:"video-checkbox"},{default:a(()=>[u(c(U.title),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue"])]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])]),d("div",Lt,[d("div",Pt,"已选视频 ("+c(F.value.length)+")",1),d("div",At,[(i(!0),y($,null,S(ol.value,l=>(i(),y("div",{key:l.id,class:"selected-item"},[d("span",Kt,c(l.title),1),t(n,{type:"danger",link:"",size:"small",onClick:p=>nl(l.id)},{default:a(()=>[...e[123]||(e[123]=[u(" 移除 ",-1)])]),_:1},8,["onClick"])]))),128)),F.value.length===0?(i(),w(Wl,{key:0,description:"暂无已选视频"})):N("",!0)])])])])):N("",!0)]),_:1},8,["modelValue"]),t(O,{modelValue:Se.value,"onUpdate:modelValue":e[56]||(e[56]=l=>Se.value=l),title:"生成合集兑换码",width:"500px"},{footer:a(()=>[t(n,{onClick:e[55]||(e[55]=l=>Se.value=!1)},{default:a(()=>[...e[128]||(e[128]=[u("关闭",-1)])]),_:1}),ie.value.length?N("",!0):(i(),w(n,{key:0,type:"primary",onClick:ql},{default:a(()=>[...e[129]||(e[129]=[u("生成",-1)])]),_:1}))]),default:a(()=>[je.value?(i(),y("div",ht,[t(E,{"label-width":"120px"},{default:a(()=>[t(v,{label:"合集名称"},{default:a(()=>[d("span",null,c(je.value.name),1)]),_:1}),t(v,{label:"视频数量"},{default:a(()=>{var l,p;return[d("span",null,c(((p=(l=A.value)==null?void 0:l.videos)==null?void 0:p.length)||0)+" 个",1)]}),_:1}),t(v,{label:"生成数量"},{default:a(()=>[t(Q,{modelValue:de.value,"onUpdate:modelValue":e[54]||(e[54]=l=>de.value=l),min:1,max:100},null,8,["modelValue"]),e[126]||(e[126]=d("span",{style:{"margin-left":"8px"}},"个兑换码",-1))]),_:1}),t(v,{label:"预计生成"},{default:a(()=>[d("span",Qt,c(de.value)+" 个兑换码，每个可访问合集内所有视频",1)]),_:1}),ie.value.length?(i(),w(v,{key:0,label:"生成结果"},{default:a(()=>[d("div",Ht,[(i(!0),y($,null,S(ie.value,(l,p)=>(i(),y("div",{key:p,style:{display:"flex","align-items":"center",gap:"8px"}},[t(C,{value:l,readonly:"",style:{flex:"1"}},null,8,["value"]),t(n,{type:"primary",size:"small",onClick:U=>Ge(l)},{default:a(()=>[...e[127]||(e[127]=[u("复制",-1)])]),_:1},8,["onClick"])]))),128))])]),_:1})):N("",!0)]),_:1})])):N("",!0)]),_:1},8,["modelValue"]),t(O,{modelValue:se.value,"onUpdate:modelValue":e[65]||(e[65]=l=>se.value=l),title:"批量导入视频集合",width:"700px"},{footer:a(()=>[t(n,{onClick:e[64]||(e[64]=l=>se.value=!1)},{default:a(()=>[...e[134]||(e[134]=[u("取消",-1)])]),_:1}),z.value.length===0?(i(),w(n,{key:0,type:"primary",onClick:Jl},{default:a(()=>[...e[135]||(e[135]=[u("预览",-1)])]),_:1})):(i(),w(n,{key:1,type:"success",onClick:Gl},{default:a(()=>[...e[136]||(e[136]=[u("确认导入",-1)])]),_:1}))]),default:a(()=>[t(E,{model:_.value,"label-width":"100px"},{default:a(()=>[t(v,{label:"集合名称",required:""},{default:a(()=>[t(C,{modelValue:_.value.collectionName,"onUpdate:modelValue":e[57]||(e[57]=l=>_.value.collectionName=l),placeholder:"请输入视频集合名称"},null,8,["modelValue"])]),_:1}),t(v,{label:"选择科目",required:""},{default:a(()=>[t(P,{modelValue:_.value.subjectId,"onUpdate:modelValue":e[58]||(e[58]=l=>_.value.subjectId=l),placeholder:"请选择科目",style:{width:"100%"}},{default:a(()=>[(i(!0),y($,null,S(I.value,l=>(i(),w(D,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"选择分类"},{default:a(()=>[t(P,{modelValue:_.value.categoryId,"onUpdate:modelValue":e[59]||(e[59]=l=>_.value.categoryId=l),placeholder:"请选择分类（可选）",style:{width:"100%"},clearable:""},{default:a(()=>[(i(!0),y($,null,S(Dl(_.value.subjectId),l=>(i(),w(D,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"导入方式"},{default:a(()=>[t(me,{modelValue:_.value.importType,"onUpdate:modelValue":e[60]||(e[60]=l=>_.value.importType=l)},{default:a(()=>[t(M,{label:"file"},{default:a(()=>[...e[130]||(e[130]=[u("上传JSON文件",-1)])]),_:1}),t(M,{label:"paste"},{default:a(()=>[...e[131]||(e[131]=[u("粘贴JSON内容",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),_.value.importType==="file"?(i(),w(v,{key:0,label:"选择文件"},{default:a(()=>[t(Xl,{ref_key:"uploadRef",ref:tl,action:"#","auto-upload":!1,"on-change":El,limit:1,accept:".json"},{tip:a(()=>[...e[133]||(e[133]=[d("div",{class:"el-upload__tip"},"请上传包含视频列表的JSON文件",-1)])]),default:a(()=>[t(n,{type:"primary"},{default:a(()=>[...e[132]||(e[132]=[u("选择JSON文件",-1)])]),_:1})]),_:1},512)]),_:1})):(i(),w(v,{key:1,label:"JSON内容"},{default:a(()=>[t(C,{modelValue:_.value.jsonContent,"onUpdate:modelValue":e[61]||(e[61]=l=>_.value.jsonContent=l),type:"textarea",rows:10,placeholder:`请粘贴JSON内容，格式参考：
{
  "data": {
    "list": [
      {
        "lessonName": "视频标题",
        "lessonUrl": "视频链接"
      }
    ]
  }
}`},null,8,["modelValue"])]),_:1})),t(v,{label:"权限设置"},{default:a(()=>[t(qe,{modelValue:_.value.requiresRedemption,"onUpdate:modelValue":e[62]||(e[62]=l=>_.value.requiresRedemption=l),"active-value":1,"inactive-value":0,"active-text":"需要兑换","inactive-text":"免费"},null,8,["modelValue"])]),_:1}),t(v,{label:"公开状态"},{default:a(()=>[t(qe,{modelValue:_.value.isPublic,"onUpdate:modelValue":e[63]||(e[63]=l=>_.value.isPublic=l),"active-value":1,"inactive-value":0,"active-text":"公开","inactive-text":"隐藏"},null,8,["modelValue"])]),_:1}),z.value.length>0?(i(),w(v,{key:2,label:"预览"},{default:a(()=>[d("div",Wt,[(i(!0),y($,null,S(z.value,(l,p)=>(i(),y("div",{key:p,style:{padding:"5px 0","border-bottom":"1px solid #ebeef5"}},[d("span",Xt,c(p+1)+".",1),u(" "+c(l.title),1)]))),128))]),d("div",Yt,"共 "+c(z.value.length)+" 个视频",1)]),_:1})):N("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},la=Yl(Zt,[["__scopeId","data-v-3ead1d60"]]);export{la as default};
