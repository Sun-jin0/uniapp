import{_ as Rt,i as Et,o as r,c as _,a as t,w as a,aC as H,E as z,f as v,r as b,g as _e,D as Ut,e as o,d as u,C as qe,z as V,t as p,F as O,y as D,m as T,b as at,k as W,O as lt,s as Ft,W as Ot,aD as Dt,aE as jt,aF as Nt,n as Qt,a0 as st,G as ot,q as At}from"./index-1rGkZLYp.js";import{k as nt}from"./katex.min-DPBfLjbn.js";import{u as Bt,i as Yt,a as Wt,b as Kt,c as Gt,d as Jt,e as Xt,f as Zt,g as ea,h as me,L as ta}from"./install-D-TER6JM.js";const aa={class:"online-exam-manage"},la={class:"filter-bar mb-20"},sa={class:"pagination-container mt-20"},oa={class:"question-select-header"},na={class:"ml-10"},ia={key:0,class:"selected-questions-preview"},ra=["innerHTML"],da={class:"total-score"},ua={class:"question-selector"},pa={class:"filter-bar mb-20"},ca=["innerHTML"],_a={class:"pagination-container mt-20"},ma={key:0,class:"exam-basic-info mb-20"},fa={key:1,class:"exam-statistics"},ga={class:"stat-card primary"},va={class:"stat-icon"},ya={class:"stat-content"},ba={class:"stat-value"},ha={class:"stat-card success"},xa={class:"stat-icon"},wa={class:"stat-content"},ka={class:"stat-value"},Ta={class:"stat-card warning"},Va={class:"stat-icon"},Sa={class:"stat-content"},Ca={class:"stat-value"},za={class:"stat-card danger"},Ma={class:"stat-icon"},Ia={class:"stat-content"},La={class:"stat-value"},$a={class:"stat-card info"},Ha={class:"stat-icon"},qa={class:"stat-content"},Pa={class:"stat-value"},Ra={class:"stat-icon"},Ea={class:"stat-content"},Ua={class:"stat-value"},Fa={class:"card-header"},Oa={class:"card-header",style:{display:"flex","justify-content":"space-between","align-items":"center"}},Da={style:{display:"flex","align-items":"center",gap:"10px"}},ja={key:0,style:{color:"#409eff"}},Na={key:1,style:{color:"#67c23a"}},Qa={key:2,style:{color:"#e6a23c"}},Aa={key:3,style:{color:"#f56c6c"}},Ba={key:4},Ya=["innerHTML"],Wa={key:0},Ka={key:1},Ga={key:0,style:{color:"#409eff"}},Ja={key:1,style:{color:"#67c23a"}},Xa={key:2,style:{color:"#e6a23c"}},Za={key:3,style:{color:"#f56c6c"}},el={key:4},tl=["innerHTML"],al={key:0},ll={key:1},sl={key:0},ol={class:"pagination-container mt-20"},nl={key:0},il={class:"grading-header"},rl={class:"question-content mb-20"},dl=["innerHTML"],ul={key:0,class:"subs-section"},pl={class:"sub-header"},cl={class:"sub-index"},_l={key:0,class:"sub-score"},ml=["innerHTML"],fl={key:0,class:"sub-answer"},gl=["innerHTML"],vl={class:"answer-content mb-20"},yl=["innerHTML"],bl={key:0,class:"correct-answer mb-20"},hl=["innerHTML"],xl={class:"grading-form"},wl={key:0,class:"question-detail-analysis"},kl={class:"exam-info-section",style:{"margin-bottom":"12px"}},Tl={key:0,style:{color:"#409eff"}},Vl={key:1,style:{color:"#67c23a"}},Sl={key:2,style:{color:"#e6a23c"}},Cl={key:3,style:{color:"#f56c6c"}},zl={key:4},Ml={key:3},Il={class:"question-content-section",style:{"margin-bottom":"8px"}},Ll=["innerHTML"],$l={key:0,class:"options-list",style:{"margin-top":"10px"}},Hl={style:{"font-weight":"bold","margin-right":"6px"}},ql=["innerHTML"],Pl={class:"knowledge-stats-section",style:{"margin-bottom":"12px"}},Rl={key:0,class:"knowledge-tags"},El={key:1},Ul={style:{"margin-left":"10px",color:"#909399","font-size":"12px"}},Fl={class:"statistics-section",style:{"margin-bottom":"12px"}},Ol={key:0,class:"option-distribution-section",style:{"margin-bottom":"12px"}},Dl={key:1,class:"wrong-answers-section",style:{"margin-bottom":"12px"}},jl={key:2,class:"correct-answer-section",style:{"margin-bottom":"12px"}},Nl=["innerHTML"],Ql={key:3,class:"sub-questions-section",style:{"margin-bottom":"12px"}},Al={style:{"font-weight":"bold","margin-bottom":"4px",color:"#606266"}},Bl=["innerHTML"],Yl={key:0,style:{"margin-top":"6px",padding:"6px",background:"#e6f7ff","border-radius":"3px",color:"#1890ff"}},Wl=["innerHTML"],Kl={key:1,style:{"margin-top":"6px",padding:"6px",background:"#f0f9ff","border-radius":"3px",color:"#409eff"}},Gl=["innerHTML"],Jl={key:4,class:"analysis-section"},Xl=["innerHTML"],Zl={__name:"OnlineExamManage",setup(es){Bt([Yt,Wt,Kt,Gt,Jt,Xt,Zt,ea]);const Pe=v("exams"),Re=v([]),fe=v(!1),Ee=v(0),U=_e({status:"",page:1,pageSize:10}),it=v([]),ae=v([]),ge=v(!1),K=v(!1),ee=v(!1),ve=v(!1),ye=v(null),c=_e({id:null,title:"",description:"",majorId:"",paperType:1,sourcePaperId:"",sourcePaperName:"",startTime:"",endTime:"",duration:120,passScore:60,totalScore:100,isLimitedTime:1,showResultImmediately:1,allowReview:1,questionIds:[],questions:[]}),rt={title:[{required:!0,message:"请输入考试名称",trigger:"blur"}],paperType:[{required:!0,message:"请选择试卷类型",trigger:"change"}],sourcePaperId:[{required:!0,message:"请选择来源试卷",trigger:"change",validator:(s,e,n)=>{(c.paperType===1||c.paperType===2)&&!e?n(new Error("请选择来源试卷")):n()}}],startTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],endTime:[{required:!0,message:"请选择结束时间",trigger:"change"}],duration:[{required:!0,message:"请输入考试时长",trigger:"blur"}],passScore:[{required:!0,message:"请输入及格分数",trigger:"blur"}],totalScore:[{required:!0,message:"请输入总分",trigger:"blur"}]},le=v(!1),Ue=v([]),be=v(!1),Fe=v(0),S=_e({keyword:"",type:"",chapterId:"",majorId:"",page:1,pageSize:10}),he=v([]),P=v([]),Oe=v(""),xe=v(!1),L=v(null),De=v([]),we=v("statistics"),h=v(null),I=v([]),ke=v(3),Te=v([]),Ve=v(!1),G=v({page:1,pageSize:10}),je=v(0),dt=v(!1),$=v([]),Q=_e({}),Se=v(null),Ce=v(null),ze=v(null),Me=v(null);let se=null,oe=null,ne=null,ie=null;const Ie=v(!1),m=v(null),A=async()=>{var s,e;fe.value=!0;try{const n=await H.get("/online-exam/admin/exams",{params:{page:U.page,pageSize:U.pageSize,status:U.status}});(n.code===0||n.code===200)&&(Re.value=((s=n.data)==null?void 0:s.list)||[],Ee.value=((e=n.data)==null?void 0:e.total)||0)}catch(n){console.error("获取考试列表失败:",n),z.error("获取考试列表失败")}finally{fe.value=!1}},Le=async()=>{var s,e;if(!(ae.value.length>0)){ge.value=!0;try{const[n,d]=await Promise.all([H.get("/computer/admin/papers",{params:{type:"real",page:1,pageSize:1e3}}),H.get("/computer/admin/papers",{params:{type:"mock",page:1,pageSize:1e3}})]),g=((s=n.data)==null?void 0:s.list)||[],i=((e=d.data)==null?void 0:e.list)||[];ae.value=[...g.map(f=>({...f,paper_type:1})),...i.map(f=>({...f,paper_type:2}))]}catch(n){console.error("获取试卷失败:",n),z.error("获取试卷列表失败")}finally{ge.value=!1}}},ut=s=>{c.sourcePaperId="",c.sourcePaperName="",c.questionIds=[],P.value=[],(s===1||s===2)&&Le()},pt=s=>{const e=ae.value.find(n=>String(n.id)===String(s));e&&(c.sourcePaperName=e.exam_full_name||e.name||e.title||"")},ct=()=>{ee.value=!1,mt(),K.value=!0},_t=s=>{ee.value=!0,Object.assign(c,{id:s.id,title:s.title,description:s.description,paperType:s.paper_type,sourcePaperId:s.source_paper_id?String(s.source_paper_id):"",sourcePaperName:s.source_paper_name||"",startTime:s.start_time,endTime:s.end_time,duration:s.duration,passScore:s.pass_score,totalScore:s.total_score,isLimitedTime:s.is_limited_time,showResultImmediately:s.show_result_immediately,allowReview:s.allow_review,questionIds:[],questions:[]}),(s.paper_type===1||s.paper_type===2)&&Le(),K.value=!0},mt=()=>{Object.assign(c,{id:null,title:"",description:"",paperType:1,sourcePaperId:"",sourcePaperName:"",startTime:"",endTime:"",duration:120,passScore:60,totalScore:100,isLimitedTime:1,showResultImmediately:1,allowReview:1,questionIds:[],questions:[]}),P.value=[]},ft=async()=>{ye.value&&await ye.value.validate(async s=>{var e,n;if(s){if(c.paperType===3&&P.value.length===0){z.error("组卷类型至少需要选择一道题目");return}ve.value=!0;try{const d=f=>{if(!f)return null;const x=new Date(f),F=x.getFullYear(),Z=String(x.getMonth()+1).padStart(2,"0"),de=String(x.getDate()).padStart(2,"0"),Y=String(x.getHours()).padStart(2,"0"),M=String(x.getMinutes()).padStart(2,"0"),y=String(x.getSeconds()).padStart(2,"0");return`${F}-${Z}-${de} ${Y}:${M}:${y}`},g={title:c.title,description:c.description,paperType:c.paperType,sourcePaperId:c.sourcePaperId,sourcePaperName:c.sourcePaperName,startTime:d(c.startTime),endTime:d(c.endTime),duration:c.duration,passScore:c.passScore,totalScore:c.totalScore,isLimitedTime:c.isLimitedTime,showResultImmediately:c.showResultImmediately,allowReview:c.allowReview};c.paperType===3&&(g.questionIds=P.value.map((f,x)=>({questionId:f.question_id,score:f.score||1,sortOrder:x+1,questionType:f.exercise_type})));let i;ee.value?i=await H.put(`/online-exam/admin/exams/${c.id}`,g):i=await H.post("/online-exam/admin/exams",g),i.code===0||i.code===200?(z.success(ee.value?"考试更新成功":"考试创建成功"),K.value=!1,A()):z.error(i.message||"操作失败")}catch(d){console.error("提交考试失败:",d),z.error(((n=(e=d.response)==null?void 0:e.data)==null?void 0:n.message)||"操作失败")}finally{ve.value=!1}}})},gt=async s=>{try{await ot.confirm("确定要删除这个考试吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await H.delete(`/online-exam/admin/exams/${s}`);e.code===0||e.code===200?(z.success("删除成功"),A()):z.error(e.message||"删除失败")}catch(e){e!=="cancel"&&(console.error("删除考试失败:",e),z.error("删除失败"))}},vt=async s=>{try{const e=s.is_published?0:1,n=s.is_published?"取消发布":"发布";await ot.confirm(`确定要${n}这个考试吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const d=await H.put(`/online-exam/admin/exams/${s.id}`,{isPublished:e});d.code===0||d.code===200?(z.success(`${n}成功`),A()):z.error(d.message||`${n}失败`)}catch(e){e!=="cancel"&&(console.error("发布考试失败:",e),z.error("操作失败"))}},Ne=()=>{S.page=1,S.keyword="",S.type="",S.chapterId="",J(),le.value=!0},J=async()=>{var s,e;be.value=!0;try{const n=await H.get("/computer/admin/questions/all",{params:{keyword:S.keyword,type:S.type,chapterId:S.chapterId,page:S.page,pageSize:S.pageSize}});(n.code===0||n.code===200)&&(Ue.value=((s=n.data)==null?void 0:s.list)||[],Fe.value=((e=n.data)==null?void 0:e.total)||0)}catch(n){console.error("获取题目列表失败:",n)}finally{be.value=!1}},yt=s=>{he.value=s},bt=()=>{if(he.value.length===0){z.warning("请至少选择一道题目");return}he.value.forEach(s=>{P.value.find(e=>e.question_id===s.question_id)||P.value.push({...s,score:1})}),le.value=!1,z.success(`已选择 ${P.value.length} 道题目`)},ht=s=>{P.value.splice(s,1)},Qe=()=>{Ne()},xt=()=>P.value.reduce((s,e)=>s+(parseFloat(e.score)||0),0).toFixed(1),wt=async s=>{L.value=s,we.value="statistics";try{const e=await H.get(`/online-exam/admin/exams/${s.id}/questions`);(e.code===0||e.code===200)&&(De.value=e.data||[]);const n=await H.get(`/online-exam/admin/exams/${s.id}/statistics`);(n.code===0||n.code===200)&&(h.value=n.data);const d=await H.get(`/online-exam/admin/exams/${s.id}/question-analysis`);if(console.log("API原始响应:",d),d.code===0||d.code===200){I.value=d.data||[];const g=I.value.find(i=>parseInt(i.exercise_type)===4);console.log("前端加载的解答题数据:",g?{question_id:g.question_id,exercise_type:g.exercise_type,subs:g.subs,subs_length:g.subs?g.subs.length:0,all_keys:Object.keys(g)}:"没有找到解答题"),console.log("前端加载的每题分析数据:",I.value.length>0?{question_id:I.value[0].question_id,exercise_type:I.value[0].exercise_type,exercise_type_name:I.value[0].exercise_type_name,knowledge_points:I.value[0].knowledge_points,sort_order:I.value[0].sort_order,subs:I.value[0].subs,subs_length:I.value[0].subs?I.value[0].subs.length:0,all_keys:Object.keys(I.value[0])}:"无数据")}await Ae(s.id),await kt(s.id)}catch(e){console.error("获取考试详情失败:",e),De.value=[]}xe.value=!0,st(()=>{h.value&&(Be(),Ye(),We(),Ke())})},Ae=async(s=null)=>{var n;const e=s||((n=L.value)==null?void 0:n.id);if(e){Ve.value=!0;try{const d=await H.get(`/online-exam/admin/exams/${e}/records`,{params:{page:G.value.page,pageSize:G.value.pageSize}});(d.code===0||d.code===200)&&(Te.value=d.data.list||[],je.value=d.data.total||0)}catch(d){console.error("获取考试记录失败:",d),z.error("获取考试记录失败")}finally{Ve.value=!1}}},kt=async(s=null)=>{var n;const e=s||((n=L.value)==null?void 0:n.id);if(console.log("获取待批改题目, examId:",e),!!e)try{const d=await H.get(`/online-exam/admin/exams/${e}/pending-subjective`);console.log("待批改题目响应:",d),(d.code===0||d.code===200)&&($.value=d.data||[],console.log(`获取到 ${$.value.length} 道待批改题目`),$.value.forEach(g=>{Q[g.answer_id]={score:0,comment:""}}))}catch(d){console.error("获取待批改题目失败:",d),$.value=[]}},Tt=async s=>{const e=Q[s.answer_id];if(e.score===void 0||e.score===null){z.warning("请输入得分");return}try{const n=await H.post(`/online-exam/admin/records/${s.record_id}/questions/${s.question_id}/grade`,{score:e.score,comment:e.comment});(n.code===0||n.code===200)&&(z.success("评分成功"),$.value=$.value.filter(d=>d.answer_id!==s.answer_id),$.value.length===0&&(dt.value=!1,z.success("所有解答题已批改完成")))}catch(n){console.error("评分失败:",n),z.error("评分失败")}},Vt=s=>{const e=$.value.findIndex(n=>n.answer_id===s.answer_id);if(e>-1){const n=$.value.splice(e,1)[0];$.value.push(n)}},St=s=>{console.log("查看题目详情，row数据:",{question_id:s.question_id,exercise_type:s.exercise_type,subs:s.subs,subs_length:s.subs?s.subs.length:0,all_keys:Object.keys(s)}),m.value=s,Ie.value=!0},Ct=s=>{if(!s)return[];try{const e=typeof s=="string"?JSON.parse(s):s,n=Object.values(e).reduce((d,g)=>d+g,0);return Object.entries(e).map(([d,g])=>({option:d,count:g,percentage:n>0?Math.round(g/n*100):0})).sort((d,g)=>g.count-d.count)}catch{return[]}},zt=s=>{if(!s)return[];try{const e=typeof s=="string"?JSON.parse(s):s;return Object.entries(e).map(([n,d])=>({answer:n,count:d})).sort((n,d)=>d.count-n.count)}catch{return[]}},B=s=>{if(!s)return"";let e=s;const n=[];return e=e.replace(/\\\((.*?)\\\)/gs,(d,g)=>{const i=n.length;try{const f=nt.renderToString(g.trim(),{throwOnError:!1,displayMode:!1});n.push(f)}catch{n.push(`<span style="color: red;">${g}</span>`)}return`__MATH_EXPR_${i}__`}),e=e.replace(/\\\[(.*?)\\\]/gs,(d,g)=>{const i=n.length;try{const f=nt.renderToString(g.trim(),{throwOnError:!1,displayMode:!0});n.push(f)}catch{n.push(`<div style="color: red;">${g}</div>`)}return`__MATH_EXPR_${i}__`}),n.forEach((d,g)=>{e=e.replace(`__MATH_EXPR_${g}__`,d)}),e},Mt=s=>{s==="statistics"&&st(()=>{Be(),Ye(),We(),Ke()})},Be=()=>{if(!Se.value||!h.value)return;se&&se.dispose(),se=me(Se.value);const s=h.value.score_distribution||{},e=h.value.score_ranges||["90-100分","80-89分","70-79分","60-69分","0-59分"],n=e,d=e.map(i=>{const f=i.replace("分","");return s[f]||0}),g={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:n,axisLabel:{rotate:30}},yAxis:{type:"value",name:"人数"},series:[{name:"人数",type:"bar",data:d,itemStyle:{color:new ta(0,0,0,1,[{offset:0,color:"#83bff6"},{offset:.5,color:"#188df0"},{offset:1,color:"#188df0"}])},label:{show:!0,position:"top",formatter:"{c}人"}}]};se.setOption(g)},Ye=()=>{if(!Ce.value||!h.value)return;oe&&oe.dispose(),oe=me(Ce.value);const e=(h.value.question_type_stats||[]).map(d=>({name:d.type_name||d.exercise_type_name||"未知题型",value:d.question_count||0})),n={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{name:"题型分布",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:`{b}: {c}题
({d}%)`},data:e}]};oe.setOption(n)},We=()=>{if(!ze.value||!h.value)return;ne&&ne.dispose(),ne=me(ze.value);const{passed:s,failed:e}=h.value.pass_distribution||{passed:0,failed:0},n={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c}人 ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{name:"考试情况",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:`{b}: {c}人
({d}%)`},data:[{value:s||0,name:"及格",itemStyle:{color:"#67c23a"}},{value:e||0,name:"不及格",itemStyle:{color:"#f56c6c"}}]}]};ne.setOption(n)},Ke=()=>{var n;if(!Me.value||!((n=h.value)!=null&&n.score_trend))return;ie&&ie.dispose(),ie=me(Me.value);const s=h.value.score_trend,e={tooltip:{trigger:"axis"},legend:{data:["提交人数","平均分"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:s.map(d=>d.date)},yAxis:[{type:"value",name:"人数",position:"left"},{type:"value",name:"分数",position:"right",min:0,max:h.value.total_score||150}],series:[{name:"提交人数",type:"bar",data:s.map(d=>d.count),itemStyle:{color:"#409eff"}},{name:"平均分",type:"line",yAxisIndex:1,data:s.map(d=>parseFloat(d.avg_score).toFixed(1)),smooth:!0,itemStyle:{color:"#67c23a"},lineStyle:{width:3}}]};ie.setOption(e)},It=At(()=>{if(!I.value||I.value.length===0)return[];const s={};I.value.forEach(n=>{const d=n.exercise_type||n.question_type||"unknown";s[d]||(s[d]=[]),s[d].push(n)});const e=[];return Object.values(s).forEach((n,d)=>{const g=n.filter(i=>i.total_attempts>0);g.length>0&&g.sort((x,F)=>parseFloat(x.correct_rate||0)-parseFloat(F.correct_rate||0)).slice(0,ke.value).forEach((x,F)=>{e.push({...x,wrong_count:(x.total_attempts||0)-(x.correct_count||0),rank_in_type:F+1,type_index:d})})}),e.sort((n,d)=>parseFloat(n.correct_rate||0)-parseFloat(d.correct_rate||0))}),X=s=>s?new Date(s).toLocaleString("zh-CN"):"-",re=s=>s?s.replace(/<[^>]*>/g,"").substring(0,100)+(s.length>100?"...":""):"",Ge=s=>({1:"success",2:"warning",3:"primary"})[s]||"info",R=s=>!s||!Array.isArray(s)?[]:s.filter(e=>e&&!/^\d+$/.test(e)),Lt=s=>({ongoing:"success",upcoming:"warning",completed:"info"})[s]||"info",$t=s=>({ongoing:"进行中",upcoming:"即将开始",completed:"已结束"})[s]||s;return Et(()=>{A()}),(s,e)=>{const n=b("el-button"),d=b("el-radio-button"),g=b("el-radio-group"),i=b("el-table-column"),f=b("el-tag"),x=b("el-table"),F=b("el-pagination"),Z=b("el-tab-pane"),de=b("el-tabs"),Y=b("el-input"),M=b("el-form-item"),y=b("el-col"),q=b("el-row"),E=b("el-option"),ue=b("el-select"),j=b("el-icon"),te=b("el-input-number"),Je=b("el-date-picker"),$e=b("el-switch"),Xe=b("el-form"),pe=b("el-dialog"),k=b("el-descriptions-item"),ce=b("el-descriptions"),Ht=b("Warning"),N=b("el-card"),Ze=b("el-progress"),et=b("el-empty"),qt=b("el-alert"),Pt=b("el-slider"),He=Ut("loading");return r(),_("div",aa,[t(de,{modelValue:Pe.value,"onUpdate:modelValue":e[3]||(e[3]=l=>Pe.value=l),type:"border-card"},{default:a(()=>[t(Z,{label:"考试管理",name:"exams"},{default:a(()=>[o("div",la,[t(n,{type:"primary",onClick:ct},{default:a(()=>[...e[31]||(e[31]=[u("+ 创建在线考试",-1)])]),_:1}),t(n,{class:"ml-10",onClick:A},{default:a(()=>[...e[32]||(e[32]=[u("刷新",-1)])]),_:1}),t(g,{modelValue:U.status,"onUpdate:modelValue":e[0]||(e[0]=l=>U.status=l),onChange:A,class:"ml-20"},{default:a(()=>[t(d,{label:""},{default:a(()=>[...e[33]||(e[33]=[u("全部",-1)])]),_:1}),t(d,{label:"ongoing"},{default:a(()=>[...e[34]||(e[34]=[u("进行中",-1)])]),_:1}),t(d,{label:"upcoming"},{default:a(()=>[...e[35]||(e[35]=[u("即将开始",-1)])]),_:1}),t(d,{label:"completed"},{default:a(()=>[...e[36]||(e[36]=[u("已结束",-1)])]),_:1})]),_:1},8,["modelValue"])]),qe((r(),V(x,{data:Re.value,border:"",stripe:""},{default:a(()=>[t(i,{prop:"id",label:"ID",width:"80",align:"center"}),t(i,{prop:"title",label:"考试名称","min-width":"200","show-overflow-tooltip":""}),t(i,{prop:"paper_type_name",label:"试卷类型",width:"100",align:"center"},{default:a(({row:l})=>[t(f,{type:Ge(l.paper_type)},{default:a(()=>[u(p(l.paper_type_name),1)]),_:2},1032,["type"])]),_:1}),t(i,{prop:"start_time",label:"开始时间",width:"160",align:"center"},{default:a(({row:l})=>[u(p(X(l.start_time)),1)]),_:1}),t(i,{prop:"end_time",label:"结束时间",width:"160",align:"center"},{default:a(({row:l})=>[u(p(X(l.end_time)),1)]),_:1}),t(i,{prop:"duration",label:"时长",width:"80",align:"center"},{default:a(({row:l})=>[u(p(l.duration)+"分钟 ",1)]),_:1}),t(i,{prop:"participant_count",label:"参与人数",width:"100",align:"center"}),t(i,{label:"发布状态",width:"100",align:"center"},{default:a(({row:l})=>[t(f,{type:l.is_published?"success":"info"},{default:a(()=>[u(p(l.is_published?"已发布":"未发布"),1)]),_:2},1032,["type"])]),_:1}),t(i,{label:"考试状态",width:"100",align:"center"},{default:a(({row:l})=>[t(f,{type:Lt(l.examStatus)},{default:a(()=>[u(p($t(l.examStatus)),1)]),_:2},1032,["type"])]),_:1}),t(i,{label:"操作",width:"320",align:"center",fixed:"right"},{default:a(({row:l})=>[t(n,{size:"small",type:"primary",onClick:w=>wt(l)},{default:a(()=>[...e[37]||(e[37]=[u("详情/统计",-1)])]),_:1},8,["onClick"]),t(n,{size:"small",onClick:w=>_t(l)},{default:a(()=>[...e[38]||(e[38]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(n,{size:"small",type:l.is_published?"warning":"success",onClick:w=>vt(l)},{default:a(()=>[u(p(l.is_published?"取消发布":"发布"),1)]),_:2},1032,["type","onClick"]),t(n,{size:"small",type:"danger",onClick:w=>gt(l.id)},{default:a(()=>[...e[39]||(e[39]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[He,fe.value]]),o("div",sa,[t(F,{"current-page":U.page,"onUpdate:currentPage":e[1]||(e[1]=l=>U.page=l),"page-size":U.pageSize,"onUpdate:pageSize":e[2]||(e[2]=l=>U.pageSize=l),total:Ee.value,layout:"total, prev, pager, next",onCurrentChange:A},null,8,["current-page","page-size","total"])])]),_:1})]),_:1},8,["modelValue"]),t(pe,{modelValue:K.value,"onUpdate:modelValue":e[18]||(e[18]=l=>K.value=l),title:ee.value?"编辑考试":"创建在线考试",width:"800px","destroy-on-close":""},{footer:a(()=>[t(n,{onClick:e[17]||(e[17]=l=>K.value=!1)},{default:a(()=>[...e[47]||(e[47]=[u("取消",-1)])]),_:1}),t(n,{type:"primary",loading:ve.value,onClick:ft},{default:a(()=>[...e[48]||(e[48]=[u("确定",-1)])]),_:1},8,["loading"])]),default:a(()=>[t(Xe,{model:c,rules:rt,ref_key:"examFormRef",ref:ye,"label-width":"120px"},{default:a(()=>[t(q,{gutter:20},{default:a(()=>[t(y,{span:24},{default:a(()=>[t(M,{label:"考试名称",prop:"title"},{default:a(()=>[t(Y,{modelValue:c.title,"onUpdate:modelValue":e[4]||(e[4]=l=>c.title=l),placeholder:"请输入考试名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(q,{gutter:20},{default:a(()=>[t(y,{span:24},{default:a(()=>[t(M,{label:"考试描述"},{default:a(()=>[t(Y,{modelValue:c.description,"onUpdate:modelValue":e[5]||(e[5]=l=>c.description=l),type:"textarea",rows:2,placeholder:"请输入考试描述"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(q,{gutter:20},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(M,{label:"试卷类型",prop:"paperType"},{default:a(()=>[t(ue,{modelValue:c.paperType,"onUpdate:modelValue":e[6]||(e[6]=l=>c.paperType=l),placeholder:"选择试卷类型",style:{width:"100%"},onChange:ut},{default:a(()=>[t(E,{label:"真题卷",value:1}),t(E,{label:"模拟题卷",value:2}),t(E,{label:"组卷（从题库抽题）",value:3})]),_:1},8,["modelValue"])]),_:1})]),_:1}),c.paperType===1||c.paperType===2?(r(),V(y,{key:0,span:12},{default:a(()=>[t(M,{label:"来源试卷",prop:"sourcePaperId"},{default:a(()=>[t(ue,{modelValue:c.sourcePaperId,"onUpdate:modelValue":e[7]||(e[7]=l=>c.sourcePaperId=l),placeholder:"选择来源试卷",style:{width:"100%"},filterable:"",loading:ge.value,onFocus:Le,onChange:pt},{default:a(()=>[(r(!0),_(O,null,D(ae.value,l=>(r(),V(E,{key:l.id,label:`${l.year||""} ${l.from_school||""} ${l.name||l.exam_full_name||l.paper_name||l.title||"未命名试卷"}`,value:String(l.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1})):T("",!0)]),_:1}),c.paperType===3?(r(),V(q,{key:0,gutter:20},{default:a(()=>[t(y,{span:24},{default:a(()=>[t(M,{label:"选择题目",prop:"questionIds"},{default:a(()=>[o("div",oa,[t(Y,{modelValue:Oe.value,"onUpdate:modelValue":e[8]||(e[8]=l=>Oe.value=l),placeholder:"搜索题目...",style:{width:"300px"},onKeyup:at(Qe,["enter"])},{append:a(()=>[t(n,{onClick:Qe},{default:a(()=>[t(j,null,{default:a(()=>[t(W(lt))]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(n,{type:"primary",class:"ml-10",onClick:Ne},{default:a(()=>[...e[40]||(e[40]=[u("选择题目",-1)])]),_:1}),o("span",na,"已选择 "+p(c.questionIds.length)+" 题",1)]),P.value.length>0?(r(),_("div",ia,[t(x,{data:P.value,size:"small",border:"","max-height":"300"},{default:a(()=>[t(i,{type:"index",label:"序号",width:"60",align:"center"}),t(i,{prop:"exercise_type_name",label:"题型",width:"100"}),t(i,{prop:"stem",label:"题干","show-overflow-tooltip":""},{default:a(({row:l})=>[o("div",{innerHTML:re(l.stem)},null,8,ra)]),_:1}),t(i,{label:"分值",width:"120",align:"center"},{default:a(({row:l,$index:w})=>[t(te,{modelValue:l.score,"onUpdate:modelValue":C=>l.score=C,min:0,max:100,precision:1,size:"small",style:{width:"90px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(i,{label:"操作",width:"80",align:"center",fixed:"right"},{default:a(({$index:l})=>[t(n,{size:"small",type:"danger",link:"",onClick:w=>ht(l)},{default:a(()=>[...e[41]||(e[41]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),o("div",da," 总分："+p(xt())+" 分 ",1)])):T("",!0)]),_:1})]),_:1})]),_:1})):T("",!0),t(q,{gutter:20},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(M,{label:"开始时间",prop:"startTime"},{default:a(()=>[t(Je,{modelValue:c.startTime,"onUpdate:modelValue":e[9]||(e[9]=l=>c.startTime=l),type:"datetime",placeholder:"选择开始时间",style:{width:"100%"},"value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(M,{label:"结束时间",prop:"endTime"},{default:a(()=>[t(Je,{modelValue:c.endTime,"onUpdate:modelValue":e[10]||(e[10]=l=>c.endTime=l),type:"datetime",placeholder:"选择结束时间",style:{width:"100%"},"value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(q,{gutter:20},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(M,{label:"考试时长",prop:"duration"},{default:a(()=>[t(te,{modelValue:c.duration,"onUpdate:modelValue":e[11]||(e[11]=l=>c.duration=l),min:1,max:300,style:{width:"100%"}},{append:a(()=>[...e[42]||(e[42]=[u("分钟",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(M,{label:"及格分数",prop:"passScore"},{default:a(()=>[t(te,{modelValue:c.passScore,"onUpdate:modelValue":e[12]||(e[12]=l=>c.passScore=l),min:0,max:c.totalScore||100,precision:1,style:{width:"100%"}},{append:a(()=>[...e[43]||(e[43]=[u("分",-1)])]),_:1},8,["modelValue","max"])]),_:1})]),_:1})]),_:1}),t(q,{gutter:20},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(M,{label:"总分",prop:"totalScore"},{default:a(()=>[t(te,{modelValue:c.totalScore,"onUpdate:modelValue":e[13]||(e[13]=l=>c.totalScore=l),min:1,max:1e3,precision:1,style:{width:"100%"}},{append:a(()=>[...e[44]||(e[44]=[u("分",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(M,{label:"是否限时"},{default:a(()=>[t($e,{modelValue:c.isLimitedTime,"onUpdate:modelValue":e[14]||(e[14]=l=>c.isLimitedTime=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(q,{gutter:20},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(M,{label:"立即显示结果"},{default:a(()=>[t($e,{modelValue:c.showResultImmediately,"onUpdate:modelValue":e[15]||(e[15]=l=>c.showResultImmediately=l),"active-value":1,"inactive-value":0},null,8,["modelValue"]),e[45]||(e[45]=o("div",{class:"form-tip"},"交卷后立即显示成绩",-1))]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(M,{label:"允许查看解析"},{default:a(()=>[t($e,{modelValue:c.allowReview,"onUpdate:modelValue":e[16]||(e[16]=l=>c.allowReview=l),"active-value":1,"inactive-value":0},null,8,["modelValue"]),e[46]||(e[46]=o("div",{class:"form-tip"},"考试结束后允许查看答案解析",-1))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(pe,{modelValue:le.value,"onUpdate:modelValue":e[24]||(e[24]=l=>le.value=l),title:"选择题目",width:"900px","destroy-on-close":""},{default:a(()=>[o("div",ua,[o("div",pa,[t(q,{gutter:10},{default:a(()=>[t(y,{span:8},{default:a(()=>[t(Y,{modelValue:S.keyword,"onUpdate:modelValue":e[19]||(e[19]=l=>S.keyword=l),placeholder:"搜索题目内容...",clearable:"",onKeyup:at(J,["enter"])},{append:a(()=>[t(n,{onClick:J},{default:a(()=>[t(j,null,{default:a(()=>[t(W(lt))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(y,{span:6},{default:a(()=>[t(ue,{modelValue:S.type,"onUpdate:modelValue":e[20]||(e[20]=l=>S.type=l),placeholder:"题型",clearable:"",onChange:J,style:{width:"100%"}},{default:a(()=>[t(E,{label:"单选题",value:"单选题"}),t(E,{label:"多选题",value:"多选题"}),t(E,{label:"填空题",value:"填空题"}),t(E,{label:"解答题",value:"解答题"}),t(E,{label:"判断题",value:"判断题"})]),_:1},8,["modelValue"])]),_:1}),t(y,{span:6},{default:a(()=>[t(ue,{modelValue:S.chapterId,"onUpdate:modelValue":e[21]||(e[21]=l=>S.chapterId=l),placeholder:"章节",clearable:"",onChange:J,style:{width:"100%"}},{default:a(()=>[(r(!0),_(O,null,D(it.value,l=>(r(),V(E,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(y,{span:4},{default:a(()=>[t(n,{type:"primary",onClick:bt},{default:a(()=>[...e[49]||(e[49]=[u("确认选择",-1)])]),_:1})]),_:1})]),_:1})]),qe((r(),V(x,{data:Ue.value,border:"",stripe:"",onSelectionChange:yt,height:"400"},{default:a(()=>[t(i,{type:"selection",width:"55",align:"center"}),t(i,{prop:"question_id",label:"ID",width:"150"}),t(i,{prop:"exercise_type_name",label:"题型",width:"100",align:"center"}),t(i,{prop:"stem",label:"题干","min-width":"300","show-overflow-tooltip":""},{default:a(({row:l})=>[o("div",{innerHTML:re(l.stem)},null,8,ca)]),_:1}),t(i,{prop:"chapter_name",label:"章节",width:"150"})]),_:1},8,["data"])),[[He,be.value]]),o("div",_a,[t(F,{"current-page":S.page,"onUpdate:currentPage":e[22]||(e[22]=l=>S.page=l),"page-size":S.pageSize,"onUpdate:pageSize":e[23]||(e[23]=l=>S.pageSize=l),total:Fe.value,layout:"total, prev, pager, next",onCurrentChange:J},null,8,["current-page","page-size","total"])])])]),_:1},8,["modelValue"]),t(pe,{modelValue:xe.value,"onUpdate:modelValue":e[29]||(e[29]=l=>xe.value=l),title:"考试详情/统计",width:"1200px","destroy-on-close":"",class:"statistics-dialog"},{default:a(()=>[L.value?(r(),V(de,{key:0,modelValue:we.value,"onUpdate:modelValue":e[28]||(e[28]=l=>we.value=l),onTabChange:Mt},{default:a(()=>[t(Z,{label:"统计分析",name:"statistics"},{default:a(()=>[L.value?(r(),_("div",ma,[t(ce,{column:2,border:""},{default:a(()=>[t(k,{label:"考试名称"},{default:a(()=>[u(p(L.value.title),1)]),_:1}),t(k,{label:"试卷类型"},{default:a(()=>[t(f,{type:Ge(L.value.paper_type)},{default:a(()=>[u(p(L.value.paper_type_name),1)]),_:1},8,["type"])]),_:1}),t(k,{label:"开始时间"},{default:a(()=>[u(p(X(L.value.start_time)),1)]),_:1}),t(k,{label:"结束时间"},{default:a(()=>[u(p(X(L.value.end_time)),1)]),_:1}),t(k,{label:"考试时长"},{default:a(()=>[u(p(L.value.duration)+" 分钟",1)]),_:1}),t(k,{label:"总分"},{default:a(()=>[u(p(L.value.total_score)+" 分",1)]),_:1}),t(k,{label:"及格分数"},{default:a(()=>[u(p(L.value.pass_score)+" 分",1)]),_:1}),t(k,{label:"参与人数"},{default:a(()=>[u(p(L.value.participant_count||0)+" 人",1)]),_:1})]),_:1})])):T("",!0),h.value?(r(),_("div",fa,[t(q,{gutter:20,class:"statistics-overview"},{default:a(()=>[t(y,{span:4},{default:a(()=>[o("div",ga,[o("div",va,[t(j,null,{default:a(()=>[t(W(Ft))]),_:1})]),o("div",ya,[o("div",ba,p(h.value.total_participants||0),1),e[50]||(e[50]=o("div",{class:"stat-label"},"参与人数",-1))])])]),_:1}),t(y,{span:4},{default:a(()=>[o("div",ha,[o("div",xa,[t(j,null,{default:a(()=>[t(W(Ot))]),_:1})]),o("div",wa,[o("div",ka,p(h.value.graded_count||0),1),e[51]||(e[51]=o("div",{class:"stat-label"},"已阅卷",-1))])])]),_:1}),t(y,{span:4},{default:a(()=>[o("div",Ta,[o("div",Va,[t(j,null,{default:a(()=>[t(W(Dt))]),_:1})]),o("div",Sa,[o("div",Ca,p(h.value.average_score?Number(h.value.average_score).toFixed(1):0),1),e[52]||(e[52]=o("div",{class:"stat-label"},"平均分",-1))])])]),_:1}),t(y,{span:4},{default:a(()=>[o("div",za,[o("div",Ma,[t(j,null,{default:a(()=>[t(W(jt))]),_:1})]),o("div",Ia,[o("div",La,p(h.value.highest_score||0),1),e[53]||(e[53]=o("div",{class:"stat-label"},"最高分",-1))])])]),_:1}),t(y,{span:4},{default:a(()=>[o("div",$a,[o("div",Ha,[t(j,null,{default:a(()=>[t(W(Nt))]),_:1})]),o("div",qa,[o("div",Pa,p(h.value.lowest_score||0),1),e[54]||(e[54]=o("div",{class:"stat-label"},"最低分",-1))])])]),_:1}),t(y,{span:4},{default:a(()=>[o("div",{class:Qt(["stat-card",h.value.pass_rate>=60?"success":"danger"])},[o("div",Ra,[t(j,null,{default:a(()=>[t(Ht)]),_:1})]),o("div",Ea,[o("div",Ua,p(h.value.pass_rate?Number(h.value.pass_rate).toFixed(1):0)+"%",1),e[55]||(e[55]=o("div",{class:"stat-label"},"及格率",-1))])],2)]),_:1})]),_:1}),t(q,{gutter:20,class:"mt-20"},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(N,{shadow:"never"},{header:a(()=>[o("div",Fa,[e[56]||(e[56]=o("span",null,"分数段分布",-1)),t(f,{size:"small",type:"info"},{default:a(()=>[u("共 "+p(h.value.total_participants||0)+" 人",1)]),_:1})])]),default:a(()=>[o("div",{ref_key:"scoreChartRef",ref:Se,style:{height:"300px"}},null,512)]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(N,{shadow:"never"},{header:a(()=>[...e[57]||(e[57]=[o("div",{class:"card-header"},[o("span",null,"题型分布")],-1)])]),default:a(()=>[o("div",{ref_key:"questionTypeChartRef",ref:Ce,style:{height:"300px"}},null,512)]),_:1})]),_:1})]),_:1}),t(q,{gutter:20,class:"mt-20"},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(N,{shadow:"never"},{header:a(()=>[...e[58]||(e[58]=[o("div",{class:"card-header"},[o("span",null,"及格情况分布")],-1)])]),default:a(()=>[o("div",{ref_key:"passChartRef",ref:ze,style:{height:"300px"}},null,512)]),_:1})]),_:1}),h.value.score_trend&&h.value.score_trend.length>0?(r(),V(y,{key:0,span:12},{default:a(()=>[t(N,{shadow:"never"},{header:a(()=>[...e[59]||(e[59]=[o("div",{class:"card-header"},[o("span",null,"分数趋势")],-1)])]),default:a(()=>[o("div",{ref_key:"trendChartRef",ref:Me,style:{height:"300px"}},null,512)]),_:1})]),_:1})):T("",!0)]),_:1}),t(N,{class:"mt-20",shadow:"never"},{header:a(()=>[...e[60]||(e[60]=[o("div",{class:"card-header"},[o("span",null,"题型得分统计")],-1)])]),default:a(()=>[t(x,{data:h.value.question_type_stats||[],border:"",stripe:""},{default:a(()=>[t(i,{prop:"type_name",label:"题型",width:"120"}),t(i,{prop:"question_count",label:"题目数量",width:"100",align:"center"}),t(i,{prop:"total_score",label:"总分值",width:"100",align:"center"}),t(i,{prop:"average_score",label:"平均得分",width:"100",align:"center"},{default:a(({row:l})=>[u(p(l.average_score?Number(l.average_score).toFixed(2):0),1)]),_:1}),t(i,{prop:"correct_rate",label:"平均正确率",width:"100",align:"center"},{default:a(({row:l})=>[t(f,{type:l.correct_rate>=60?"success":l.correct_rate>=40?"warning":"danger",size:"small"},{default:a(()=>[u(p(l.correct_rate?Number(l.correct_rate).toFixed(1):0)+"% ",1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])]),_:1}),t(N,{class:"mt-20",shadow:"never"},{header:a(()=>[o("div",Oa,[o("div",null,[e[62]||(e[62]=o("span",null,"各题型错误率最高题目",-1)),t(f,{size:"small",type:"danger",class:"ml-10"},{default:a(()=>[...e[61]||(e[61]=[u("需重点关注",-1)])]),_:1})]),o("div",Da,[e[63]||(e[63]=o("span",{style:{"font-size":"12px",color:"#666"}},"每题型显示数量:",-1)),t(te,{modelValue:ke.value,"onUpdate:modelValue":e[25]||(e[25]=l=>ke.value=l),min:1,max:20,size:"small",style:{width:"100px"}},null,8,["modelValue"])])])]),default:a(()=>[t(x,{data:It.value,border:"",stripe:"","max-height":"400"},{default:a(()=>[t(i,{label:"题号",width:"80",align:"center"},{default:a(({row:l})=>[t(f,{type:"info",size:"small"},{default:a(()=>[u(p(l.sort_order||"-"),1)]),_:2},1024)]),_:1}),t(i,{label:"题型",width:"100"},{default:a(({row:l})=>[parseInt(l.exercise_type)===1?(r(),_("span",ja,"单选题")):parseInt(l.exercise_type)===2?(r(),_("span",Na,"多选题")):parseInt(l.exercise_type)===3?(r(),_("span",Qa,"判断题")):parseInt(l.exercise_type)===4?(r(),_("span",Aa,"解答题")):(r(),_("span",Ba,p(l.exercise_type_name||l.question_type||"-"),1))]),_:1}),t(i,{prop:"stem",label:"题干","min-width":"250","show-overflow-tooltip":""},{default:a(({row:l})=>[o("div",{innerHTML:re(l.stem)},null,8,Ya)]),_:1}),t(i,{label:"考点/知识点","min-width":"180","show-overflow-tooltip":""},{default:a(({row:l})=>[Array.isArray(l.knowledge_points)&&R(l.knowledge_points).length>0?(r(),_("div",Wa,[(r(!0),_(O,null,D(R(l.knowledge_points).slice(0,3),(w,C)=>(r(),V(f,{key:C,size:"small",class:"mr-5",type:"info"},{default:a(()=>[u(p(w),1)]),_:2},1024))),128)),R(l.knowledge_points).length>3?(r(),V(f,{key:0,size:"small",type:"info"},{default:a(()=>[u("+"+p(R(l.knowledge_points).length-3),1)]),_:2},1024)):T("",!0)])):(r(),_("span",Ka,"-"))]),_:1}),t(i,{prop:"question_score",label:"分值",width:"80",align:"center"}),t(i,{prop:"total_attempts",label:"答题次数",width:"100",align:"center"}),t(i,{label:"错误率",width:"100",align:"center"},{default:a(({row:l})=>[t(f,{type:"danger",size:"small"},{default:a(()=>[u(p((100-parseFloat(l.correct_rate||0)).toFixed(1))+"% ",1)]),_:2},1024)]),_:1}),t(i,{prop:"wrong_count",label:"错误人数",width:"100",align:"center"})]),_:1},8,["data"])]),_:1}),t(N,{class:"mt-20",shadow:"never"},{header:a(()=>[...e[64]||(e[64]=[o("div",{class:"card-header"},[o("span",null,"每题作答分析")],-1)])]),default:a(()=>[t(x,{data:I.value,border:"",stripe:"","max-height":"500"},{default:a(()=>[t(i,{label:"题号",width:"60",align:"center"},{default:a(({row:l})=>[t(f,{type:"info",size:"small"},{default:a(()=>[u(p(l.sort_order||"-"),1)]),_:2},1024)]),_:1}),t(i,{label:"题型",width:"100"},{default:a(({row:l})=>[l.exercise_type==1?(r(),_("span",Ga,"单选题")):l.exercise_type==2?(r(),_("span",Ja,"多选题")):l.exercise_type==3?(r(),_("span",Xa,"判断题")):l.exercise_type==4?(r(),_("span",Za,"解答题")):(r(),_("span",el,p(l.exercise_type_name||"-"),1))]),_:1}),t(i,{prop:"stem",label:"题干","min-width":"250","show-overflow-tooltip":""},{default:a(({row:l})=>[o("div",{innerHTML:re(l.stem)},null,8,tl)]),_:1}),t(i,{label:"考点/知识点","min-width":"150","show-overflow-tooltip":""},{default:a(({row:l})=>[Array.isArray(l.knowledge_points)&&R(l.knowledge_points).length>0?(r(),_("div",al,[(r(!0),_(O,null,D(R(l.knowledge_points).slice(0,2),(w,C)=>(r(),V(f,{key:C,size:"small",class:"mr-5",type:"info"},{default:a(()=>[u(p(w),1)]),_:2},1024))),128)),R(l.knowledge_points).length>2?(r(),V(f,{key:0,size:"small",type:"info"},{default:a(()=>[u("+"+p(R(l.knowledge_points).length-2),1)]),_:2},1024)):T("",!0)])):(r(),_("span",ll,"-"))]),_:1}),t(i,{prop:"question_score",label:"满分",width:"80",align:"center"}),t(i,{prop:"total_attempts",label:"答题次数",width:"100",align:"center"}),t(i,{prop:"correct_count",label:"正确人数",width:"100",align:"center"}),t(i,{label:"正确率",width:"120",align:"center"},{default:a(({row:l})=>[t(Ze,{percentage:parseFloat(l.correct_rate||0),status:parseFloat(l.correct_rate)<50?"exception":"success"},null,8,["percentage","status"])]),_:1}),t(i,{prop:"average_score",label:"平均得分",width:"100",align:"center"},{default:a(({row:l})=>[u(p(l.average_score?parseFloat(l.average_score).toFixed(1):0),1)]),_:1}),t(i,{label:"操作",width:"100",align:"center",fixed:"right"},{default:a(({row:l})=>[t(n,{size:"small",type:"primary",onClick:w=>St(l)},{default:a(()=>[...e[65]||(e[65]=[u("详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])):T("",!0)]),_:1}),t(Z,{label:"考试记录",name:"records"},{default:a(()=>[Te.value.length>0?(r(),_("div",sl,[qe((r(),V(x,{data:Te.value,border:"",stripe:""},{default:a(()=>[t(i,{type:"index",label:"序号",width:"60",align:"center"}),t(i,{prop:"username",label:"用户名",width:"120"}),t(i,{prop:"nickname",label:"昵称",width:"120"}),t(i,{prop:"start_time",label:"开始时间",width:"160"},{default:a(({row:l})=>[u(p(X(l.start_time)),1)]),_:1}),t(i,{prop:"submit_time",label:"提交时间",width:"160"},{default:a(({row:l})=>[u(p(l.submit_time?X(l.submit_time):"-"),1)]),_:1}),t(i,{prop:"duration",label:"用时",width:"100",align:"center"},{default:a(({row:l})=>[u(p(l.duration?Math.floor(l.duration/60)+"分"+l.duration%60+"秒":"-"),1)]),_:1}),t(i,{prop:"objective_score",label:"客观题",width:"90",align:"center"}),t(i,{prop:"subjective_score",label:"主观题",width:"90",align:"center"},{default:a(({row:l})=>[u(p(l.subjective_score!==null?l.subjective_score:"待评"),1)]),_:1}),t(i,{prop:"total_score",label:"总分",width:"90",align:"center"},{default:a(({row:l})=>{var w;return[t(f,{type:l.total_score>=(l.pass_score||((w=L.value)==null?void 0:w.pass_score))?"success":"danger",size:"small"},{default:a(()=>[u(p(l.total_score),1)]),_:2},1032,["type"])]}),_:1}),t(i,{prop:"is_graded",label:"阅卷状态",width:"100",align:"center"},{default:a(({row:l})=>[t(f,{type:l.is_graded?"success":"warning",size:"small"},{default:a(()=>[u(p(l.is_graded?"已阅卷":"待阅卷"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])),[[He,Ve.value]]),o("div",ol,[t(F,{"current-page":G.value.page,"onUpdate:currentPage":e[26]||(e[26]=l=>G.value.page=l),"page-size":G.value.pageSize,"onUpdate:pageSize":e[27]||(e[27]=l=>G.value.pageSize=l),total:je.value,layout:"total, prev, pager, next",onCurrentChange:Ae},null,8,["current-page","page-size","total"])])])):(r(),V(et,{key:1,description:"暂无考试记录"}))]),_:1}),t(Z,{label:"解答题批改",name:"grading"},{default:a(()=>[$.value.length>0?(r(),_("div",nl,[t(qt,{title:`还有 ${$.value.length} 道解答题待批改`,type:"warning",closable:!1,class:"mb-20"},null,8,["title"]),(r(!0),_(O,null,D($.value,(l,w)=>(r(),V(N,{key:l.answer_id,class:"grading-item mb-20"},{header:a(()=>[o("div",il,[o("span",null,"第 "+p(w+1)+" 题 / 共 "+p($.value.length)+" 题",1),o("span",null,"考生："+p(l.nickname||l.username),1),t(f,{type:"info"},{default:a(()=>[u("满分："+p(l.question_score)+" 分",1)]),_:2},1024)])]),default:a(()=>[o("div",rl,[e[68]||(e[68]=o("h4",null,"题目：",-1)),o("div",{class:"question-stem",innerHTML:l.stem},null,8,dl),l.subs&&l.subs.length>0?(r(),_("div",ul,[e[67]||(e[67]=o("h5",null,"小题列表：",-1)),(r(!0),_(O,null,D(l.subs,(C,tt)=>(r(),_("div",{key:C.sub_id||C.id||tt,class:"sub-item"},[o("div",pl,[o("span",cl,"("+p(tt+1)+")",1),C.score?(r(),_("span",_l,"["+p(C.score)+"分]",1)):T("",!0)]),o("div",{class:"sub-stem",innerHTML:C.stem},null,8,ml),C.answer?(r(),_("div",fl,[e[66]||(e[66]=o("span",{class:"sub-answer-label"},"参考答案：",-1)),o("span",{innerHTML:C.answer},null,8,gl)])):T("",!0)]))),128))])):T("",!0)]),o("div",vl,[e[69]||(e[69]=o("h4",null,"考生答案：",-1)),o("div",{class:"user-answer",innerHTML:l.user_answer||"未作答"},null,8,yl)]),l.correct_answer?(r(),_("div",bl,[e[70]||(e[70]=o("h4",null,"参考答案：",-1)),o("div",{class:"reference-answer",innerHTML:l.correct_answer},null,8,hl)])):T("",!0),o("div",xl,[t(Xe,{model:Q[l.answer_id],"label-width":"80px"},{default:a(()=>[t(M,{label:"得分"},{default:a(()=>[t(Pt,{modelValue:Q[l.answer_id].score,"onUpdate:modelValue":C=>Q[l.answer_id].score=C,max:parseFloat(l.question_score),step:.5,"show-stops":"","show-input":""},null,8,["modelValue","onUpdate:modelValue","max"])]),_:2},1024),t(M,{label:"评语"},{default:a(()=>[t(Y,{modelValue:Q[l.answer_id].comment,"onUpdate:modelValue":C=>Q[l.answer_id].comment=C,type:"textarea",rows:2,placeholder:"请输入评语（可选）"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,null,{default:a(()=>[t(n,{type:"primary",onClick:C=>Tt(l)},{default:a(()=>[...e[71]||(e[71]=[u("提交评分",-1)])]),_:1},8,["onClick"]),t(n,{onClick:C=>Vt(l)},{default:a(()=>[...e[72]||(e[72]=[u("跳过",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1032,["model"])])]),_:2},1024))),128))])):(r(),V(et,{key:1,description:"暂无待批改的解答题"}))]),_:1})]),_:1},8,["modelValue"])):T("",!0)]),_:1},8,["modelValue"]),t(pe,{modelValue:Ie.value,"onUpdate:modelValue":e[30]||(e[30]=l=>Ie.value=l),title:"题目详情",width:"900px","destroy-on-close":""},{default:a(()=>[m.value?(r(),_("div",wl,[o("div",kl,[t(ce,{column:4,size:"small",border:""},{default:a(()=>[t(k,{label:"题号"},{default:a(()=>[u(p(m.value.sort_order),1)]),_:1}),t(k,{label:"题型"},{default:a(()=>[parseInt(m.value.exercise_type)===1?(r(),_("span",Tl,"单选题")):parseInt(m.value.exercise_type)===2?(r(),_("span",Vl,"多选题")):parseInt(m.value.exercise_type)===3?(r(),_("span",Sl,"判断题")):parseInt(m.value.exercise_type)===4?(r(),_("span",Cl,"解答题")):(r(),_("span",zl,p(m.value.exercise_type_name||"-"),1))]),_:1}),t(k,{label:"分值"},{default:a(()=>[u(p(m.value.question_score)+"分",1)]),_:1}),t(k,{label:"难度"},{default:a(()=>[m.value.difficulty===1?(r(),V(f,{key:0,type:"success",size:"small"},{default:a(()=>[...e[73]||(e[73]=[u("简单",-1)])]),_:1})):m.value.difficulty===2?(r(),V(f,{key:1,type:"warning",size:"small"},{default:a(()=>[...e[74]||(e[74]=[u("中等",-1)])]),_:1})):m.value.difficulty===3?(r(),V(f,{key:2,type:"danger",size:"small"},{default:a(()=>[...e[75]||(e[75]=[u("困难",-1)])]),_:1})):(r(),_("span",Ml,"-"))]),_:1})]),_:1})]),o("div",Il,[e[76]||(e[76]=o("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"4px",color:"#303133"}},"题目内容",-1)),o("div",{class:"question-stem",style:{padding:"8px",background:"#f5f7fa","border-radius":"4px","line-height":"1.5"},innerHTML:B(m.value.stem)},null,8,Ll),m.value.options&&m.value.options!=="{}"?(r(),_("div",$l,[(r(!0),_(O,null,D(JSON.parse(m.value.options),(l,w)=>(r(),_("div",{key:w,class:"option-item",style:{padding:"4px 0","line-height":"1.5"}},[o("span",Hl,p(w)+".",1),o("span",{class:"option-content",innerHTML:B(l)},null,8,ql)]))),128))])):T("",!0)]),o("div",Pl,[t(ce,{column:2,size:"small",border:""},{default:a(()=>[t(k,{label:"考点/知识点"},{default:a(()=>[m.value.knowledge_points&&R(m.value.knowledge_points).length>0?(r(),_("div",Rl,[(r(!0),_(O,null,D(R(m.value.knowledge_points),(l,w)=>(r(),V(f,{key:w,size:"small",class:"mr-5",type:"info",effect:"plain"},{default:a(()=>[u(p(l),1)]),_:2},1024))),128))])):(r(),_("span",El,"-"))]),_:1}),t(k,{label:"正确率"},{default:a(()=>[t(f,{type:parseFloat(m.value.correct_rate)>=60?"success":"danger",size:"small"},{default:a(()=>[u(p(m.value.correct_rate)+"% ",1)]),_:1},8,["type"]),o("span",Ul," ("+p(m.value.correct_count)+"/"+p(m.value.total_attempts)+") ",1)]),_:1})]),_:1})]),o("div",Fl,[t(ce,{column:4,size:"small",border:""},{default:a(()=>[t(k,{label:"答题次数"},{default:a(()=>[u(p(m.value.total_attempts),1)]),_:1}),t(k,{label:"正确人数"},{default:a(()=>[u(p(m.value.correct_count),1)]),_:1}),t(k,{label:"错误人数"},{default:a(()=>[u(p(m.value.wrong_count),1)]),_:1}),t(k,{label:"未答人数"},{default:a(()=>[u(p(m.value.unanswered_count),1)]),_:1}),t(k,{label:"平均得分"},{default:a(()=>[u(p(m.value.average_score),1)]),_:1}),t(k,{label:"最高得分"},{default:a(()=>[u(p(m.value.max_score),1)]),_:1}),t(k,{label:"最低得分"},{default:a(()=>[u(p(m.value.min_score),1)]),_:1}),t(k,{label:"方差"},{default:a(()=>[u(p(m.value.variance||"-"),1)]),_:1})]),_:1})]),m.value.option_distribution&&Object.keys(m.value.option_distribution).length>0?(r(),_("div",Ol,[e[77]||(e[77]=o("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"6px",color:"#303133","font-size":"13px"}},"选项分布",-1)),t(x,{data:Ct(m.value.option_distribution),border:"",stripe:"",size:"small"},{default:a(()=>[t(i,{prop:"option",label:"选项",width:"60",align:"center"}),t(i,{prop:"count",label:"选择人数",width:"90",align:"center"}),t(i,{label:"占比","min-width":"120"},{default:a(({row:l})=>[t(Ze,{percentage:l.percentage,status:l.percentage<30?"exception":"success"},null,8,["percentage","status"])]),_:1})]),_:1},8,["data"])])):T("",!0),m.value.common_wrong_answers&&Object.keys(m.value.common_wrong_answers).length>0?(r(),_("div",Dl,[e[78]||(e[78]=o("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"6px",color:"#303133","font-size":"13px"}},"常见错误答案",-1)),t(x,{data:zt(m.value.common_wrong_answers),border:"",stripe:"",size:"small"},{default:a(()=>[t(i,{prop:"answer",label:"错误答案",width:"100"}),t(i,{prop:"count",label:"错误次数",width:"90",align:"center"})]),_:1},8,["data"])])):T("",!0),m.value.correct_answer&&(!m.value.subs||m.value.subs.length===0)?(r(),_("div",jl,[e[79]||(e[79]=o("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"6px",color:"#303133","font-size":"13px"}},"正确答案",-1)),o("div",{class:"math-content",style:{padding:"10px",background:"#f0f9ff",border:"1px solid #b3d8ff","border-radius":"4px",color:"#409eff","font-weight":"bold",display:"inline-block","min-width":"100px"},innerHTML:B(m.value.correct_answer)},null,8,Nl)])):T("",!0),m.value.subs&&m.value.subs.length>0?(r(),_("div",Ql,[e[82]||(e[82]=o("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"6px",color:"#303133","font-size":"13px"}},"小题列表",-1)),(r(!0),_(O,null,D(m.value.subs,(l,w)=>(r(),_("div",{key:w,class:"sub-question-item",style:{"margin-bottom":"8px",padding:"10px",background:"#f5f7fa","border-radius":"4px"}},[o("div",Al,"小题 "+p(l.question_order||w+1),1),o("div",{class:"math-content",style:{"line-height":"1.5"},innerHTML:B(l.stem)},null,8,Bl),l.answer?(r(),_("div",Yl,[e[80]||(e[80]=o("span",{style:{"font-weight":"bold"}},"答案：",-1)),o("span",{innerHTML:B(l.answer)},null,8,Wl)])):T("",!0),l.analysis?(r(),_("div",Kl,[e[81]||(e[81]=o("span",{style:{"font-weight":"bold"}},"解析：",-1)),o("span",{innerHTML:B(l.analysis)},null,8,Gl)])):T("",!0)]))),128))])):T("",!0),m.value.analysis?(r(),_("div",Jl,[e[83]||(e[83]=o("div",{class:"section-title",style:{"font-weight":"bold","margin-bottom":"4px",color:"#303133","font-size":"13px"}},"解析",-1)),o("div",{class:"math-content",style:{padding:"8px",background:"#f5f7fa","border-radius":"4px","line-height":"1.6","font-size":"14px"},innerHTML:B(m.value.analysis)},null,8,Xl)])):T("",!0)])):T("",!0)]),_:1},8,["modelValue"])])}}},ss=Rt(Zl,[["__scopeId","data-v-00e4124a"]]);export{ss as default};
