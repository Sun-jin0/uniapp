# 刷题与在线考试平台 - 软件需求规格说明书 (SRS)

**项目名称**：QuizMaster刷题
**文档版本**：v1.0

**项目名称**：QuizMaster刷题
**文档版本**：v1.0
http://localhost:5173/#/pages/admin/database-manager/database-manager
---
## 1. 引言
### 1.1 编写目的
本文档旨在明确“刷题与在线考试平台”的软件需求，详细描述系统的功能特性、数据要求、接口规范及非功能属性。本文档作为产品经理、UI/UX 设计师、前端开发人员、后端开发人员及测试人员进行开发与验收的基准依据。
### 1.2 项目背景
本项目旨在构建一个功能高度集成的在线学习与考核平台。参考了当前主流开源项目（如 `ixiaofeiyang/onlineQuestion`、`kesixin/QuestionWechatApp`、`wulivictor/ExamOnline` 等）的优秀实践，结合商业化运营需求与人工智能技术，打造一个支持多端访问、具备完善营销体系和智能化教学辅助的综合系统。
### 1.3 适用范围
本系统适用于：
*   个人用户：进行日常刷题练习、模拟考试、英语作文自我诊断。
*   机构/企业：组织内部考核、员工培训、党建知识竞赛。
*   运营人员：通过营销工具进行用户增长、变现及内容维护。
---
## 2. 总体设计
### 2.1 技术架构原则
为保证系统的易维护性与高效率，采用“精简且强大”的技术策略：
*   **前端架构**：采用 UniApp 框架，基于 Vue 3 生态。实现一套代码同时发布微信小程序与 H5（Web 端）。
*   **后端架构**：采用 Node.js (TypeScript) 作为核心服务端。提供高性能的 API 接口。
*   **数据存储**：严格限制数据库种类，仅使用 **MySQL 8.0** 作为关系型数据存储，**Redis 6.0** 作为缓存与中间件存储，避免技术栈过度复杂化。
### 2.2 系统角色定义
1.  **普通用户 (C端)**：使用微信小程序或 H5 进行学习、考试、消费的用户。
2.  **管理员 (超级管理员)**：拥有系统所有权限，负责配置基础参数、查看全局数据。
3.  **运营人员**：负责题库管理、活动发布、营销配置、文章资讯发布。
4.  **审核人员**：负责用户注册审核（特定场景）、用户反馈处理、内容合规性审核。
---
## 3. 功能需求详述
### 3.1 用户与账户体系
#### 3.1.1 微信授权与登录
*   **功能描述**：支持微信小程序一键授权登录及 H5 扫码/账号登录。
*   **逻辑要求**：
    *   小程序端通过 `code` 换取 `openid` 及 `session_key`，自动绑定或生成用户账号。
    *   支持手机号绑定功能，便于跨端数据同步或找回账号。
    *   登录态维持使用 Redis 存储 Token，支持多端同时在线控制。
#### 3.1.2 个人资料与设置
*   **功能描述**：用户可查看及修改个人基础信息。
*   **包含项**：头像（支持微信头像同步）、昵称、性别、地区、默认学习偏好。
*   **特殊功能**：
    *   **夜间/日间模式切换**：
        *   提供“跟随系统”、“日间模式”、“夜间模式”三个选项。
        *   系统需实时响应系统主题变化（监听系统级主题变更事件）。
        *   主题设置需同步至云端，跨设备保持一致。
#### 3.1.3 用户审核
*   **功能描述**：针对企业或党建场景，支持“注册即审核”机制。
*   **流程**：用户填写信息（如姓名、工号/部门）-> 状态置为“待审核” -> 管理员审核通过后 -> 解锁全部功能。
### 3.2 题库管理系统
#### 3.2.1 科目与章节管理
*   **功能描述**：支持无限层级的树状结构管理。
*   **维度**：支持按学科（如英语、政治）、按考试类型（如考研、软考）、按机构自定义分类。
*   **权限控制**：可针对不同用户组（如 VIP、普通用户）设置题库的可见性。
#### 3.2.2 题目管理
*   **题型支持**：单选题、多选题、判断题、填空题、简答题、组合题（阅读理解）。
*   **内容支持**：
    *   **富文本**：题目干、选项、解析均支持图文混排、数学公式渲染。
    *   **多媒体**：支持插入音频（听力题）、视频（讲解题）。
*   **属性配置**：难度（1-5星）、分值、标签（如“易错题”、“高频考点”）。
*   **批量操作**：
    *   支持标准 Excel/Word 模板批量导入题目。
    *   支持题目批量修改（如批量调整分值、批量更改分类）。
    *   支持题目查重与去重。
### 3.3 刷题练习模块 (C端)
#### 3.3.1 练习模式
*   **顺序练习**：按章节或知识点 ID 顺序出题，适合系统学习。
*   **随机练习**：从指定题库中随机抽取 N 题进行练习。
*   **专项练习**：按题型（如“只练多选”）、按难度、按标签筛选题目。
*   **高频错题练习**：基于错题数据统计，优先推送错误率最高的题目。
#### 3.3.2 答题交互模式
*   **单题模式 (卡片式)**：一屏一题，适合深度学习，支持左右滑动切换。
*   **列表模式 (概览式)**：一屏展示多题（如 10 题），适合快速刷题和回顾。
*   **背题模式**：直接在题目下方显示标准答案与解析，不做判分统计。
#### 3.3.3 练习反馈机制
*   **即时反馈**：提交答案后立即提示对错，并展示解析。
*   **暂存与续答**：支持保存当前练习进度，下次进入时自动跳转至上次位置。
### 3.4 考试与竞赛模块
#### 3.4.1 试卷管理
*   **固定试卷**：人工指定具体题目及排序。
*   **随机试卷**：配置抽题规则（如：单选 20 题+多选 10 题，难度中等以上），每次开考即时生成千人千卷。
*   **试卷设置**：考试时长、及格分数线、参考次数限制、答题时间窗口。
#### 3.4.2 考试过程控制
*   **防作弊机制**：
    *   试题乱序、选项乱序。
    *   切屏限制（检测应用切换次数，超过阈值强制交卷）。
*   **倒计时与自动交卷**：前端实时倒计时，时间到自动触发提交逻辑。
*   **答题卡**：悬浮答题卡，显示答题进度，支持快速跳转。
#### 3.4.3 成绩与判分
*   **客观题自动判分**：单选、判断、填空（模糊匹配）自动计算得分。
*   **主观题判分**：简答题标记为“待阅卷”，支持管理员后台人工打分。
*   **成绩单展示**：总分、排名、各题型得分分析、用时统计、错题回顾。
#### 3.4.4 活动皮肤
*   **功能描述**：支持为特定竞赛配置专属主题皮肤（如“党建知识竞赛”红金风格，“国潮文化”风格），替换首页背景、Logo、按钮样式。
### 3.5 AI 英语作文批改模块
#### 3.5.1 作文任务发布
*   **任务配置**：管理员发布作文题目、字数要求、参考范文。
*   **等级适配**：支持选择不同评分标准（如：CET-4、CET-6、考研英语、雅思、托福）。
#### 3.5.2 作文提交与批改
*   **提交方式**：用户提供纯文本输入（支持字数实时统计）。
*   **AI 交互**：
    *   后端系统将用户文本及相关参数提交至第三方 AI 批改服务（如网易有道、腾讯云）。
    *   系统需处理 API 调用的异常重试及 QPS 限制。
*   **结果存储**：将 AI 返回的原始 JSON 数据结构化存储至数据库。
#### 3.5.3 批改结果展示
*   **总分展示**：大字号展示作文得分。
*   **分维度评分**：展示词汇、语法、篇章结构、内容相关度四个维度的得分雷达图或进度条。
*   **纠错高亮**：在原文中高亮显示拼写错误、语法错误、词性误用。
*   **修改建议**：点击错误处，显示标准修改意见、错误原因解析。
*   **高级词汇推荐**：展示可替换的高级词汇或同义词，提升文章档次。
#### 3.5.4 人工复核
*   管理员可对 AI 批改结果进行人工调整，覆盖 AI 分数，并添加人工评语。
### 3.6 学习辅助工具
#### 3.6.1 错题本
*   **自动记录**：练习或考试中答错的题目自动加入错题本。
*   **移除策略**：
    *   手动移除。
    *   智能移除：设置“连续答对 N 次”后自动移出。
*   **错题重练**：支持针对错题本进行模拟测试或重新练习。
#### 3.6.2 收藏夹
*   用户可手动收藏题目，支持自定义分组（如“重点题”、“难题”）。
#### 3.6.3 笔记与评论
*   **笔记**：用户可在题目下添加私有笔记，支持 Markdown 格式。
*   **评论**：支持用户对题目发表公开评论，需支持敏感词过滤及人工审核。
### 3.7 成长体系与社交
#### 3.7.1 签到与积分
*   **每日签到**：用户每日签到获得基础积分。
*   **连续签到**：连续签到 7 天、30 天等节点有额外奖励。
*   **积分获取**：答题正确、完成作文批改、参与活动均可获得积分。
#### 3.7.2 排行榜
*   **维度**：积分榜、刷题数量榜、坚持天数榜、单卷成绩榜。
*   **时效性**：支持实时更新（基于 Redis ZSet）、日榜、周榜、总榜切换。
*   **隐私保护**：支持用户设置“不参与排行榜”。
#### 3.7.3 荣誉体系
*   **用户等级**：根据积分或做题数自动升级（如：小白、学霸、大神）。
*   **勋章墙**：完成特定任务解锁勋章（如“全对达人”、“坚持签到 100 天”）。
### 3.8 商业化与变现
#### 3.8.1 会员体系
*   **会员等级**：定义月卡、季卡、年卡等不同时长。
*   **会员权益**：题库免费解锁、答题次数无限制、专属题库、下载解析、会员折扣。
#### 3.8.2 题库/课程售卖
*   **商品管理**：将特定科目或试卷打包为 SKU 商品，设置价格。
*   **购买验证**：用户做题时校验是否拥有该题库的有效权限。
#### 3.8.3 订单与支付
*   **下单流程**：创建订单 -> 应用优惠券 -> 计算实付金额 -> 调起微信支付。
*   **订单状态**：待支付、已支付、已取消、已退款、已关闭。
*   **售后处理**：支持管理员手动退款、延长有效期。
#### 3.8.4 激活码体系
*   **功能描述**：生成一串唯一码，用于兑换会员或解锁题库。
*   **场景**：线下培训赠送、企业福利发放、营销活动奖品。
*   **逻辑**：激活码绑定后与用户账户挂钩，支持设置有效期和使用次数限制。
### 3.9 营销运营中心
#### 3.9.1 优惠券系统
*   **类型**：满减券（满 100 减 20）、折扣券（8.8 折）。
*   **发放方式**：新手注册自动发放、签到达到天数发放、运营手动发放、活动任务领取。
*   **限制**：设置适用范围（全站/指定商品）、有效期、每人限领数量。
#### 3.9.2 邀请裂变
*   **机制**：每个用户拥有专属邀请码/邀请海报。
*   **奖励规则**：被邀请人注册并完成首单/首刷，邀请人获得奖励（积分或优惠券）。
*   **溯源**：建立用户邀请关系树，记录每一层级的邀请关系。
#### 3.9.3 活动管理
*   **知识竞赛**：创建限时竞赛活动，配置专属试卷，设置排行榜奖励，生成活动专属皮肤页面。
*   **限时秒杀**：设置特定题库/会员在特定时间段内打折。
#### 3.9.4 海报生成器
*   **模板管理**：后台上传海报背景图，配置文案占位符。
*   **动态生成**：
    *   **成绩海报**：包含用户头像、昵称、考试分数、排名、鼓励语、小程序码。
    *   **邀请海报**：包含邀请人头像、邀请语、专属邀请码/小程序码。
*   **技术实现**：前端 Canvas 绘制或后端图片合成服务，输出图片 URL。
### 3.10 内容管理 (CMS)
#### 3.10.1 文章资讯
*   **分类**：考试资讯、备考技巧、政策解读、机构新闻。
*   **功能**：富文本编辑、封面图上传、浏览量统计、点赞、分享。
#### 3.10.2 轮播图管理
*   **配置**：上传图片、设置跳转类型（外链、题库、活动、文章）、设置有效期、排序。
#### 3.10.3 用户反馈
*   **渠道**：小程序内意见反馈入口（文本+图片）。
*   **处理**：管理员后台查看，支持回复，处理结果通过小程序订阅消息通知用户。
---
## 4. 数据需求规范
### 4.1 核心数据实体 (MySQL)
系统需包含但不限于以下核心数据表：
1.  **用户类**：`sys_user` (基础信息、VIP信息、主题配置), `sys_sign_record` (签到流水), `score_log` (积分流水)。
2.  **题库类**：`tb_subject` (科目), `tb_chapter` (章节), `tb_question` (题目及配置), `tb_exam` (试卷), `tb_exam_question` (试卷关联)。
3.  **学习类**：`tb_practice_record` (练习/考试记录), `tb_wrong_book` (错题本), `tb_user_favorite` (收藏), `tb_question_note` (笔记)。
4.  **AI 类**：`tb_essay_task` (作文任务), `tb_essay_submission` (提交记录与AI结果)。
5.  **商业类**：`tb_vip_package` (会员套餐), `tb_product_sku` (题库商品), `tb_order` (订单), `tb_activation_code` (激活码), `tb_user_sku` (用户权限)。
6.  **营销类**：`tb_activity` (活动), `tb_coupon` (优惠券), `tb_user_coupon` (领券记录), `tb_invite_record` (邀请关系)。
7.  **内容类**：`tb_article` (文章), `tb_banner` (轮播图), `tb_feedback` (反馈)。
### 4.2 缓存策略
1.  **Session 存储**：使用 Redis String 存储用户 Token，设置过期时间。
2.  **排行榜**：使用 Redis ZSet (有序集合) 实现实时积分榜、刷题榜。
3.  **热点缓存**：使用 Redis String 缓存高频访问的题目详情、科目树结构，设置主动过期策略。
4.  **并发锁**：使用 Redis SetNX 实现下单、秒杀等场景的分布式锁。
---
## 5. 接口与集成需求
### 5.1 外部服务集成
1.  **微信小程序 API**：
    *   登录接口。
    *   用户信息接口。
    *   微信支付接口。
    *   订阅消息接口（用于发送答题结果、活动通知）。
2.  **AI 批改服务**：
    *   需对接具备文本纠错、作文评分能力的第三方 AI 服务（如网易有道智云、腾讯云教育）。
    *   需处理不同等级（四六级/考研）的参数传递。
### 5.2 内部接口规范
*   遵循 RESTful 设计风格。
*   统一返回格式：`{ code: number, msg: string, data: any, timestamp: number }`。
*   统一错误码定义（如：200 成功，401 未登录，403 无权限，500 服务器错误）。
---
## 6. 非功能需求
### 6.1 性能要求
*   **响应速度**：常规 API 接口响应时间 < 500ms；AI 批改接口响应时间视第三方服务而定，需在前端提供 Loading 态防止重复提交。
*   **并发能力**：支持千级并发用户同时在线刷题或参加考试。
### 6.2 安全性
*   **数据传输**：全站强制使用 HTTPS 协议。
*   **隐私保护**：敏感用户数据（手机号、OpenID）在数据库中需脱敏存储或加密。
*   **防刷机制**：关键接口（如签到、领券、提交答案）需增加签名校验或图形验证码，防止接口被恶意调用。
### 6.3 可用性
*   **系统可用性**：目标 99.9%。
*   **数据备份**：MySQL 数据库每日全量备份，Binlog 实时备份；Redis 数据开启 AOF 持久化。
---
## 7. 运维与部署
### 7.1 部署环境
*   **操作系统**：Linux (CentOS 7+ 或 Ubuntu 20.04+)。
*   **Web 服务器**：Nginx (用于反向代理、静态资源服务、SSL 终止)。
*   **应用服务器**：Node.js 运行环境 (使用 PM2 进行进程守护)。
### 7.2 发布流程
*   **小程序发布**：通过微信开发者工具上传代码，提交审核，发布线上版本。
*   **服务端发布**：采用灰度发布策略，先更新部分服务器，观察日志无误后全量更新。
---
## 8. 附录
### 8.1 参考资料列表
*   ixiaofeiyang/onlineQuestion (GitHub)
*   kesixin/QuestionWechatApp (GitHub)
*   P1kaj1uu/wx-ExamOnline (GitHub)
*   wulivictor/ExamOnline (GitHub)
*   bljessica/miniprogram-backend (GitHub)
*   alioo/ruankao (Gitee)
### 8.2 术语表
*   **UniApp**：DCloud 推出的跨端前端框架。
*   **Redis ZSet**：Redis 数据结构之一，用于实现排行榜。
*   **SKU**：Stock Keeping Unit，库存量单位，此处指代售卖的商品（题库/会员）。
*   **AI 批改**：基于自然语言处理技术的英语作文自动评分与纠错服务。
